\mainmatter
%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\chapter{Conceptual Overview} \label{ch: Conceptual Overview}

To make sense of special relativity, we will first look at the classical understanding of the world.
Then, we will see how we must change these classical laws of physics to account for light's constant speed relative to all observers.
Which in turn will lead to many interesting consequences.
The chapter begins with an overview of the core concepts to help us understand why we need special relativity and what it means, leaving the mathematical details and deeper insights for the following chapters.

This chapter's concepts will establish the mathematical framework for later chapters, using physical objects, such as moving trucks on roads, to represent the different perspectives of various observers.
Whereas, in the mathematical chapters, we will use coordinate axes to represent the different perspectives (frames of reference).

Later, you will see the parallels between this conceptual overview and the mathematical chapters.
This chapter will provide an overview of all the required concepts for special relativity, building up the needed knowledge bit by bit, starting with our classical understanding of how perspectives (frames of reference) work and showing how our understanding must change if we are to allow all observers to view light as moving at the same constant speed.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Classical Addition of Velocities} \label{sect: Classical Addition of Velocities}

Imagine a truck, carrying a cannon, is moving at 20 meters per second, and the cannon fires a ball at 100 meters per second relative to the truck.
Classically, we add the truck and the ball's speed, to find the ball moves at 120 meters per second relative to the road.
So, in classical physics, velocities are directly added.
The ball relative to the road would move at the speed of the ball relative to the truck plus the truck's speed relative to the road, as shown in Figure (\ref{fig: truck cannonball}).

However, this classical understanding is just a very good approximation for objects in our everyday life that we are used to seeing, which are moving much slower than the speed of light (roughly 300 000 000 meters per second), but we will get to this later.
For now, in the following sections, we will explain what an inertial reference frame is and how this works in the classical context so that you can see more clearly the differences between classical and special relativity.

% EDIT: change the ball's movement in the diagram
%█████████████
\begin{figure}[H]
	\centering
	\includegraphics[width = 8cm]{images/pdf/lorry_cannonball.pdf}
	\caption{\textbf{Addition of cannonball and truck's velocities.} A diagram, showing the speed of a cannonball from two different perspectives, (top) is from the truck's perspective with the cannon at rest and the road moving backwards, the cannonball is shot and moves forward. The Figure (bottom) is from the road's perspective, with the truck moving relative to it. When the cannonball is shot, it looks like it is moving forward faster, with the previous cannonball's speed combined with the speed of the cannon that it was shot from. *** add labels of ball, truck and road speed or There could be a background object like a stop sign/person that is blurred in the top and not blurred in the bottom.}
	\label{fig: truck cannonball}
\end{figure}
%███████████

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Inertial Reference Frame} \label{sect: Inertial Reference Frame}

A reference frame is a grid of coordinates that we can overlay space with, so that we can state with respect to it where and when an event occurs.
If this grid is stationary or moving at a constant velocity, it is called an inertial reference frame.
In the previous truck example, we could associate a reference frame with the truck, by introducing a grid of coordinates that is stationary relative to the truck and, hence, moving along with it.
This perspective, fixed to the truck, is the truck's frame of reference.
A second grid of coordinates, stationary relative to the road, can also be introduced, representing the road's reference frame.
These grids of coordinates are shown from the road's reference frame in Figure (\ref{fig: Reference Frames}).
%An unnecessary and more complex way of saying this is, that a \hyperlink{def-Reference-frame}{reference frame} can be thought of as an abstract coordinate system associated with an observer or object. The origin of its axis, orientation, and scale are specified by a set of points in space and their times. The purpose of it is to provide a standardized means of measuring and describing the times and positions of objects within that frame.

%Edit: make the diagram a Tikz diagram, and v in diagonal y and x direction, could also make a diagram of a grid of coordinates attached to a truck moving relative to a grid of coordinates attached to the road
%█████████████
\begin{figure}[H]
	\centering
	\includegraphics[width = 8cm]{images/pdf/Reference_Frames_of_truck_and_road.pdf}
	\caption{\textbf{Reference frames of a truck and road.} A diagram, showing the \protect\hyperlink{def-Reference-frame}{reference frame} of a truck as a grid of coordinates that is moving with the truck relative to the road's reference frame shown as a stationary dashed gray grid of coordinates.}
	\label{fig: Reference Frames}
\end{figure}
%███████████

An inertial frame of reference is a reference frame that is not being accelerated.
You can tell if you are being accelerated as you will feel a force.
For example, in an accelerating car, you will feel the seat being accelerated into you, with your body slightly lagging behind in the acceleration.
This principle is used in accelerometers to measure acceleration, as shown in Figure (\ref{fig: spring boxes}).

%█████████████
\begin{figure}[H]
	\centering
	\includegraphics[width = 0.9\textwidth]{images/pdf/Spring_boxes.pdf}
	\caption{\textbf{Inertial vs non-inertial frames.} A diagram, showing a ball attached to the walls of a box by springs, with the ball centered in the box in the inertial frame, with no acceleration (left), and in a non-inertial frame (right) where the box is now accelerating to the right, The ball lags behind as the box accelerates.}
	\label{fig: spring boxes}
\end{figure}
%███████████

We will now look at how movement changes in classical relativity when we change between these inertial frames.

% ((a note on free fall being inertial frame)) You may have the question of what about when the box is freefalling in gravity, and the ball would feel weightless and therefore stay in the center of the box, yet the box is accelerating, that is the beginning of general relativity which is for another handbook

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Classical Inertial Reference Frames} \label{sect: Classical Inertial Reference Frames}

To see how to swap between \hyperlink{def-Reference-frame}{reference frame}s in special relativity, we will first have to introduce the classical approach.

To illustrate this, we will look at a setup of two rats on a treadmill with a platform as shown in Figure (\ref{fig: 3d conveyor belt}), with three rocks hanging above the platform, which are at rest relative to the room.
The two frames of reference will be the treadmill's platform and the room in which the treadmill is in.
Both rats start under the same rock.
One rat runs to a rock positioned in the forward direction of the treadmill.
The other rat runs to an equally distanced rock to the side.
After this, they return to the starting rock.

Here, the platform can be seen as the medium in which the rats move.
Both rats travel at the same constant speed relative to the platform, with the platform either at rest or at a slower speed than the rat's motion to allow them to get to the rocks.

%█████████████
\begin{figure}[H]
	\centering
	\includegraphics[width = 0.9\textwidth]{images/pdf/Conveyor_belt_3d.pdf}
	\caption{\textbf{Rats on a treadmill.} A diagram, showing a 3d view of a treadmill platform, with two rats and three hanging rocks, with arrows representing the rats moving from a starting rock to the other two equally distanced rocks, with the paths perpendicular to each other.}
	\label{fig: 3d conveyor belt}
\end{figure}
%███████████

If the platform is at rest, they will return to the starting rock simultaneously.
But if the treadmill is turned on and the platform is moving, the rats will also have to work against the movement of the platform to get to the rocks.
This will lead to different distances the rats have to travel relative to the platform, and as a result, the rats get back to the starting rock at different times.
Figure (\ref{fig: treadmill}) shows what the direction of movement of the rats and rocks look like in each of the \hyperlink{def-Reference-frame}{reference frame}s when the platform is moving.

%█████████████
\begin{figure}[H]
	\centering
	\begin{subfigure}{0.9\textwidth}
		\centering
		\includegraphics[width = \textwidth]{images/pdf/rats_moving.pdf}
		\caption{Room's \protect\hyperlink{def-Reference-frame}{reference frame}.}
		\label{fig: rat with moving platform}
	\end{subfigure}
	\begin{subfigure}{0.9\textwidth}
		\vspace{0.2cm}
		\centering
		\includegraphics[width = \textwidth]{images/pdf/rats_platform_frame.pdf}
		\caption{Platform's \protect\hyperlink{def-Reference-frame}{reference frame}.}
		\label{fig: rat platform reference frame}
	\end{subfigure}
	\caption{\textbf{Different reference frames of rats on treadmill.} Rats running on a moving platform of a treadmill from two different \protect\hyperlink{def-Reference-frame}{reference frame}s, with the paths of the rats represented as arrows.}
	\label{fig: treadmill}
\end{figure}
%███████████

%\iffalse javascript{rats_on_treadmill}
%\fi

From the room's perspective, the platform is moving backwards.
The rat that is moving along the direction of the treadmill's motion will have impedance to its movement from the backwards pull of the platform.
But after it turns around, it will have a boost from the platform to return to the starting rock.
Meanwhile, the sideways-moving rat will have to move sideways and balance out the platform's backwards pull to keep its movement in the direction of the hanging rocks.
This gives different lengths of paths depending on the \hyperlink{def-Reference-frame}{reference frame}, as shown in Figure (\ref{fig: treadmill}).
The rats in the platform's reference frame, move with the same speed for all the paths, represented by the arrows.
Whereas, in the room's reference frame, we have a slower constant speed of the sideways-moving rat and two different speeds for the forward and backward paths of the other rat.
This leads to different times for the rats to return to the starting rock.

The rats here use the medium of the treadmill's platform to move, and similarly, it was thought that light needed a medium, called the aether, to travel through space.
If there was this medium, we could test how fast it moved relative to Earth by finding the difference between the return times of light emitted in two perpendicular directions, just as in the treadmill example.
So, next, we will look at the notion of a universal medium referred to as the \hyperlink{def-aether}{aether} and whether we can have the same frame swapping when it comes to light traveling in two different frames of reference, as we did in this section.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{The Aether} \label{sect: The Aether}
%, a Medium for Light} % and a Universal Rest Frame}

In the theory electromagnetism from the late 1800s, it was believed that light was a wave and, therefore, would need a medium that filled the \hyperlink{def-vacuum}{vacuum} of space for it to travel through, called "the luminiferous \hyperlink{def-aether}{aether}", and that light traveled at a constant speed relative to this \hyperlink{def-aether}{aether}, like how the rats in the previous section moved at a constant speed relative to the medium of the treadmill's platform.
It was from the theory of electromagnetism and the experiments performed from it, that showed that light should have a constant speed, atleast relative to this aether, but it was yet to be known that light would actually have a constant speed relative to all things.

If the aether existed, the Earth would be moving through it, illustrated in Figure (\ref{fig: Aether}).

%█████████████
\begin{figure}[ht]
	\centering
	\includegraphics[width = 0.9\textwidth]{images/pdf/earth_and_aether.pdf}
	\caption{\textbf{The earth and the aether.} A diagram showing the proposed \protect\hyperlink{def-aether}{aether}'s and Earth's movement relative to each other.}
	\label{fig: Aether}
\end{figure}
%███████████

So, an experimental setup by Michelson and Morley, shown in Figure (\ref{fig: Michelson_morley}), called an interferometer, was devised to measure Earth's movement through the \hyperlink{def-aether}{aether} \cite{EtherExperiment}, by measuring how it affected the return times of light emitted in different directions, as observed in Earth's \hyperlink{def-Reference-frame}{reference frame}.
It did this by splitting a single light beam into two perpendicular paths that are then reflected back to be recombined and sent toward a light detector.
By rotating a platform that the setup is on, the two light paths could be aligned, one parallel and the other perpendicular to the Earth's motion through the presumed \hyperlink{def-aether}{aether}.
They reasoned that if the speed of light was constant with respect to the proposed \hyperlink{def-aether}{aether}, just like in the rat experiment from the previous section, the split light beams would recombine at different times.

From the previous section's system of rats on a treadmill, we can see that the treadmill's platform is analogous to the \hyperlink{def-aether}{aether}, and the rats are analogous to the light.
Both have the room where these experiments are done as the other inertial reference frame.

%█████████████
\begin{figure}[H]
	\centering
	\includegraphics[width = 8cm]{images/pdf/Michelson_morley.pdf}
	\caption{\textbf{Experiment to detect the aether.} A diagram showing the Michelson-Morley experiment, we can take the part of the paths between the beam splitter and two mirrors to be analogous to the case of the paths in the previous section of the rat and treadmill system.}
	\label{fig: Michelson_morley}
\end{figure}
%███████████

However, when Michelson and Morley performed the experiment, they found no difference in travel time to the detector for both paths, indicating that there was no difference in the speed of light in any direction in Earth's \hyperlink{def-Reference-frame}{reference frame}.
Hence, light's speed is not dependent on the supposed \hyperlink{def-aether}{aether}.
This null result seriously discredited the \hyperlink{def-aether}{aether} theories.
It ultimately led to the proposal by Einstein in 1905 that the speed of light (in a \hyperlink{def-vacuum}{vacuum}) is a universal constant and is independent of the motion of the \hyperlink{def-observer}{observer} or source.

To allow for us to have this universal speed of light (in a \hyperlink{def-vacuum}{vacuum}), it will require us to change our ideas of how time and positions are perceived by different \hyperlink{def-observer}{observer}s.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Speed of Light} \label{sect: Speed of Light}

The experiments within a vaccum, showed light does not just travel at a constant velocity relative to the proposed medium (the aether), and instead travels at a constant velocity regardless of the motion of the \hyperlink{def-Reference-frame}{reference frame}.
The observed speed of light is independent of how fast the source and receiver of that light are moving in the frame, as shown with a moving truck's headlights in Figure (\ref{fig: truck torch}).
Light does move slower in objects such as glass, but this is due to the interactions between the light and the material, impeding the movement of light.

Light itself moves extremely fast compared to any other everyday speeds we are used to (roughly 300 000 000 meters per second; it can travel the world's diameter in the blink of an eye).
This is why we do not notice any delay in the light arrriving from the things we see in everyday life, and we assume everything to be located where we are currently seeing it, though we should remember that there is this delay.
For example, the light we currently see from the sun was emitted eight minutes ago for it to reach us now, and the further an object is located from us, the further back in time we are currently seeing it because of this delay.

When we look at the same truck setup as in Figure (\ref{fig: truck cannonball}), but now have it in a \hyperlink{def-vacuum}{vacuum}, where the cannon firing a cannonball is swapped for headlights emitting light, we will find the same speed of light when measured relative to the truck or the road, but how can this be true?

%█████████████
\begin{figure}[H]
	\centering
	\includegraphics[width = 8cm]{images/pdf/lorry_torch.pdf}
	\caption{\textbf{Emitted light in different frames.} A diagram, showing light emitted from a truck in two different \protect\hyperlink{def-Reference-frame}{reference frame}s, with the emitted light having the same speed in each frame, though with different frequencies and energies due to the \protect\hyperlink{def-doppler-effect}{Doppler effect}, which will be explained later.}
	\label{fig: truck torch}
\end{figure}
%███████████

For this to be true, we need a new way of thinking about velocity addition.
This is because the velocities of objects must be added in a way that is consistent with the requirement that the speed of light is constant but also gives the approximate classical addition at speeds of objects at much less than the speed of light, like how we observed in the situation with the cannon and truck, shown in Figure (\ref{fig: truck cannonball}).
Since the speed of the light depends only on the units of time and positions, the only way to correct for this is to have the measured positions and times of objects \hyperlink{def-transform}{transform} differently when swapping between \hyperlink{def-Reference-frame}{reference frame}s than the classical way.
This is what we will talk about next.
For the curious, it was the experiment by Ole Rømer (\href{https://scienceready.com.au/pages/determination-of-speed-of-light}{link}) that showed that light traveled at a finite speed rather than being instantaneously emitted and received.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Position and Time} \label{sect: Position and Time}

%███████████████████████████████████████████████████████████████████
\subsection{Time Dilation} \label{Subsect: Time Dilation}

Consider a simple clock, as shown in Figure (\ref{fig: truck clock}), made of a light pulse moving back and forth vertically between two mirrors on a moving truck, one on the truck's floor and the other on the roof directly above it.
Each tick of the clock is defined as the time it takes for the light to travel from one mirror to the other and back.
For an \hyperlink{def-observer}{observer} in the truck, they will see the light go straight up and down between the mirrors, but an \hyperlink{def-observer}{observer} stationary relative to the road will see not just the light traveling up and down but also with the direction of the truck to allow it to travel back and forth between the mirrors.

%█████████████
\begin{figure}[H]
	\centering
	\includegraphics[width = 8cm]{images/pdf/lorry_clock.pdf}
	\caption{\textbf{Light clock on a truck.} A diagram, showing a clock consisting of light being reflected between the floor and roof of a truck to keep time, in the truck's frame (top), and in the road's frame with the truck moving (bottom).}
	\label{fig: truck clock}
\end{figure}
%███████████

%█████████████████████████████████
\iffalse javascript{createTruckDiagram: 2, Math.PI / 2 } %█
\fi%██████████████████████████████

Given that the distance traveled by the light in the frame with the truck moving is longer, and from the previous sections we know that the speed of light is the same for both reference frames, to keep the speed of light invariant: the clock itself must tick slower in moving objects.

How much slower the time is passing in the moving truck relative to the road observer can be solved using the ratio of the lengths of the paths in each frame as shown in Figure (\ref{fig: truck clock}), as this is the same ratio as the time between the ticks.

Importantly, this time dilation phenomenon isn't limited to light clocks; it applies universally to all types of clocks.
If you were to play a movie on the truck, it would take a longer time for it to play through from start to finish for an observer watching it from the road's \hyperlink{def-Reference-frame}{reference frame}.
An observer on the road and in the truck experience time at different rates.
This is not just an illusion, it is physical reality.

The closer the truck goes to the speed of light, the more significant the difference in how fast the road frame's time flows relative to the truck frame's time.
This can be seen as an increasingly longer horizontal stretch in the path taken for the light from the perspective of someone standing still on the road, with the time between each tick approaching infinity as the speed of the truck approaches the speed of light.

You may ask about the possibility that the distance between the floor and roof of the truck becoming smaller the faster the truck is moving relative to the road, to allow for the light clock to tick at the same speed, and to get rid of the need for the time dilation, but that would actually lead to contradictions which will be shown later in figure (\ref{fig: width contraction}).

Now, if we instead had two trucks moving at the same speed relative to the road but in opposite directions.
Each truck would see its light moving vertically up and down with the other truck's light moving a longer diagonal path.
Hence, each truck perceives the other truck's clock ticking slower.
An observer in the road's reference frame would see both trucks move at the same speed and, hence, their diagonal paths having the same length, giving the same passage of time between ticks for both trucks.
That is, The slowing of time of moving objects is the same regardless of its relative direction of motion, only the relative speed changes the travelled distance of the ticking light.
This concept is confusing and difficult to visualize, but it will get easier with practice.

For now, though, we will continue building up the concepts of special relativity.

%*** Discuss the experimental evidence for time dilation using atomic clocks or the muon experiment.

%███████████████████████████████████████████████████████████████████
\subsection{Simultaneity} \label{subsect: Simultaneity}

Imagine a truck in its \hyperlink{def-proper-frame}{rest frame}, with a light bulb in the middle and mirrors on the front and back walls.
If the light bulb gives off a pulse of light, the light will travel from the center of the truck to reach the mirrors \hyperlink{def-simultaneity}{simultaneously} and back to reach the light bulb also \hyperlink{def-simultaneity}{simultaneously}.
An \hyperlink{def-observer}{observer} on the road watching the truck drive past will see the light bulb \hyperlink{def-simultaneity}{simultaneously} emit light in both directions and \hyperlink{def-simultaneity}{simultaneously} return to the bulb again.
However, the light reflects off each wall's mirrors at different times in the road's frame to do this, as shown in Figure (\ref{fig: truck simultaneity}).
This is because the speed of light is the same for both directions, but the truck is moving, meaning the back of the truck is moving towards where the bulb was when the light pulse was emitted, making the distance traveled shorter.
The light travels a longer distance to the front wall due to the wall moving away from where it was emitted.
Because of this, the \hyperlink{def-observer}{observer} on the road will see the light hit the mirrors at different times.

%█████████████
\begin{figure}[htbp]
	\centering
	\includegraphics[width = 8cm]{images/pdf/lorry_simul.pdf}
	\caption{\textbf{Simultaneity of events in different frames.} A diagram showing how two \protect\hyperlink{def-event}{event}s of light reaching the two walls of the truck are \protect\hyperlink{def-simultaneity}{simultaneous} in one frame but happening at different times in another, due to truck's movement in the second frame and the speed of light remaining the same.}
	\label{fig: truck simultaneity}
\end{figure}
%███████████

%█████████████████████████████████
\iffalse javascript{createTruckDiagram: 2 } %█
\fi%██████████████████████████████

Consequently, times of \hyperlink{def-event}{event}s, such as when the light reaches either mirror, are different for \hyperlink{def-observer}{observer}s in different \hyperlink{def-Reference-frame}{reference frame}s.
There is no one true order of \hyperlink{def-event}{event}s.
For example, an \hyperlink{def-observer}{observer} in a faster-moving vehicle moving in the opposite direction would see the light reach the front wall first.
However, for all \hyperlink{def-observer}{observer}s, the light will return to the central light bulb \hyperlink{def-simultaneity}{simultaneously}.
If two \hyperlink{def-event}{event}s happen in the same position \hyperlink{def-simultaneity}{simultaneously}, then this happens \hyperlink{def-simultaneity}{simultaneously} in all frames of reference.
This means the light returns to the center of the light bulb \hyperlink{def-simultaneity}{simultaneously} in each frame.

A note here is that we are talking about when the events \textbf{actually} happen in each frame and not when the light from these events reaches the observer, which is later due to the time it takes the light from an event to travel to the observer for them to see it.
Also, I have left out any mention of \hyperlink{def-length-contraction}{length contraction} of the truck, which will be introduced in the next section, and why it needs to be equal in both directions from the lightbulb for the light to \hyperlink{def-simultaneity}{simultaneously} return to the light bulb.

% when two point particles/events overlap at certain time, this corresponds to the time they overlap in a different frame

%███████████████████████████████████████████████████████████████████
\subsection{Length Contraction} \label{subsect: Length Contraction}

Consider a truck, in its \hyperlink{def-proper-frame}{rest frame} carrying a square container.
If a light bulb at the square container's center emits light in the two horizontal directions and the two vertical directions it will bounce off the mirrored sides of the truck and return to the center \hyperlink{def-simultaneity}{simultaneously}.
We require that in the moving frame, they also all return to the center \hyperlink{def-simultaneity}{simultaneously}, as multiple \hyperlink{def-event}{event}s that happen at a single point \hyperlink{def-simultaneity}{simultaneously} in one frame, must happen \hyperlink{def-simultaneity}{simultaneously} in all other frames.
The light reflects off the walls at different locations, so the order of reflections in time will depend upon the relative observer, as described in the previous section.
The time between the light being emitted and absorbed from the light bulb is the \hyperlink{def-time-dilation}{dilated time}, that was described in section (\ref{Subsect: Time Dilation}).

To achieve this \hyperlink{def-simultaneity}{simultaneity} in the return of the light to the bulb, the total length of the path of light in each of the four directions must be the same, as lights speed is the same in all directions.
We can work out the length of the up and downward path from the \hyperlink{def-time-dilation}{time dilation} section (\ref{Subsect: Time Dilation}), and this is the length the path needs to be in the horizontal directions as well.
The paths can only have this length if the truck is contracted in the direction of its motion, to allow for the light to be relected from the walls at the required positions for these path lengths.
The amount of contraction is same in both directions.
The exact amount of the contraction can be worked geometrically, and it turns out that the ratio of the increase in the amount of time that passes before the light is reabsorbed is inversely proportional to the amount the truck is contracted in the direction of its movement.
That is, if in a moving frame the time is dilated so that the light clock takes twice as long between ticks, then the length of the moving lorry becomes half of its length when at rest.
This is shown in the following figure.

%█████████████
\begin{figure}[H]
	\centering
	\includegraphics[width = 8cm]{images/pdf/Full_Lorry_Transform.pdf}
	\caption{\textbf{Length contraction of moving truck.} A diagram, showing a truck with a square container in its \protect\hyperlink{def-proper-frame}{rest frame} (top), emitting light from a central bulb in the four directions, with all light being reflected by the mirrored sides back to the center, as shown in red. In the second frame with the truck now moving (bottom), we see the truck's length contracted to allow all paths to be the same length.}
	\label{fig: full truck transform}
\end{figure}
%███████████

%█████████████████████████████████
\iffalse javascript{createTruckDiagram: 4 } %█
\fi%██████████████████████████████

We now know that moving objects must shrink in the direction they move to allow for a consistent speed of light in each frame.
But this srinking is not noticeable when objects move much slower than light speed.
If you are unsatisfied with this, the next section will reason the need for length contraction in another way using three accelerating cars.
But first we will look at the reason we did not consider any change in sizes of moving objects in the directions perpendicular to an object's movement.

If we look at the possibility that a moving object contracts in the direction perpendicular to the direction of its movement, we find out that this leads to contradictions, as shown in figure (\ref{fig: width contraction}).
As it allows for the possibility that a moving objects size in the perpendicular direction is smaller than a container when being observed in a containers rest frame but is bigger than its container in the object's frame.
Which is impossible as this would break the container just becuase you decided to viewed the object from a different reference frame.

%█████████████
\begin{figure}[H]
	\centering
	\includegraphics[width = 8cm]{images/pdf/Cannon_Balls.pdf}
	\caption{\textbf{Paradox of height and width contraction.} A diagram showing why there must not be a contraction in the perpendicular direction to the frame's relative motion. The top Figure shows a ball and cannon at rest. The bottom figures show the cannon ball being fired in the frame of the cannon (left), where the moving ball has a contracted width, and (right) in the frame of the ball, where the canon is now moving and has a contract width, with the ball at rest being the same size. Both frames would contradict each other if there was a change in the width of moving objects, as the walls of the cannon and the surface of the ball would overlap in one frame and have a gap between them in the other. So, we require no size change perpendicular to the object's movement.}
	\label{fig: width contraction}
\end{figure}
%███████████

In the previous section we had in the frame with the truck moving, that the emitted light reaches the top and bottom of the square container at the same time.
But the times it reachs the left and right walls are non-simulataneous, and it is this difference in timings that allows the truck to contract in the direction of movement without the contradictions that are present when we look at the possibility of contraction in the perpendicular direction to the movement.

%Suppose we have a ball at rest in a pipe such that the ball touches the inner circumference of the pipe; if we were to make now the ball move, we would have it Lorentz contracted along the direction of the movement, but if we also had it contract perpendicular to the direction of movement then in the rest frame of the pipe we would have the ball smaller such that it no longer was touching the inner pipe, but if we changed to the frame of the ball it would be the pipe that was moving. We would expect the pipe to contract and be smaller than the ball (so that the ball would get stuck), so in the two different frames, we would have two contradictory outcomes. Still, we should be able to go from one frame to the other and not have these contradictions, so we require that there is no size change perpendicular to the object's movement.

% The faster you go, the closer things are in that frame, so it would take a shorter amount of time to get to places the closer you get to the speed of light (is this true)

%██████████████████████
\subsubsection{Another Illustration of Length Contraction}

%█████████████
\begin{figure}[H]
	\centering
	\includegraphics[width = 8cm]{images/pdf/cars.pdf}
	\caption{\textbf{Length contraction between three accelerating cars.} A diagram, illustrating an experiment with three cars initially at rest and equally spaced on a road. The middle car emits light that reaches the front and back cars \protect\hyperlink{def-simultaneity}{simultaneously}, triggering all cars to accelerate for a predetermined time. Now another light is emitted from the middle car after the acceleration has finished, the road \protect\hyperlink{def-observer}{observer} sees this second light pulse reach the back car first, as it is moving towards where the light had been emitted, this causes it to begin accelerating before the front car. This results in the cars being closer together after acceleration, demonstrating Lorentz \protect\hyperlink{def-length-contraction}{length contraction}. However, to the car \protect\hyperlink{def-observer}{observer}, the distance between the cars remains unchanged from the initial distances.}
	\label{fig: cars}
\end{figure}
%███████████

Suppose we have three equally distanced cars at rest on the road, as shown in Figure (\ref{fig: cars}).
If the middle car sends out a pulse of light, it will reach the front and back car at the same time for the road \hyperlink{def-observer}{observer} and the \hyperlink{def-observer}{observer}s in the car. When it reaches them both, all the cars accelerate for a predetermined fixed amount of time to the same speed.
Following this acceleration period, the cars have maintained equal spacing relative to both the car observers and the observer on the road.
As for all \hyperlink{def-observer}{observer}s, the light reached the front and back cars at the same time.

Now, suppose we do this a second time, with the middle car releasing another pulse.
In this case, we have in the frame of the \hyperlink{def-observer}{observer}s in the cars: again, with the front and back drivers receiving the pulses simultaneously, meaning that they will start accelerating simultaneously.
After the acceleration has finished, the distances between the cars will be the same for the car observers.
But for the road \hyperlink{def-observer}{observer}, they see the back car receive the signal first, as that car is moving towards the point where the light pulse was emitted, and the front car is moving away from it.
This would mean the back car would start accelerating first to get to the final constant velocity and get closer to the front car before the front car begins to accelerate to that same final speed that the back car had already reached.
This results in the cars being closer together after the acceleration.
The \hyperlink{def-observer}{observer}s in the car and the road \hyperlink{def-observer}{observer} disagree with what the distances between the cars are.
This contraction of length between cars, in the road's frame in which the cars are moving, is called Lorentz \hyperlink{def-length-contraction}{length contraction}, which means that objects that are moving faster become shorter, and the distances between the objects also become shorter.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Doppler Effect} \label{sect: Intro Doppler Effect}

If we have a light source at rest, emitting circular pulses of light with equal times between each pulse, we will have concentric circular pulses in this frame.
But, if we move to a frame where the source is now moving to the right, each circular pulse is emitted from a different position.
Due to the source moving, each pulse will be emitted closer to the right-hand side of the previous pulses, creating a bunching up of the pulses (increase in frequency) in the direction of movement and a spreading out (decrease in frequency) of the pulses in the opposite direction.
This also happens in the classical version of the \hyperlink{def-doppler-effect}{Doppler effect}.
For example, you will notice that an ambulance or police car sounds different when driving towards or away from you due to the bunching up and spreading out of the sound waves in the direction and opposite direction of the moving vehicle.
However, in special relativity, we also must take the \hyperlink{def-time-dilation}{time dilation} of the pulses into account, as there will be a longer time between each subsequential pulse.
This is due to objects moving relative to an observer and therefore having their perceived time moving more slowly.
This is called the second order Doppler effect most notably seen in optical clocks.
This has a decreasing effect on the frequency in all directions.
However, directly in the direction of movement of the source, this is outweighed by the frequency increase from the previous bunching-up effect.
Since the energy of the light is proportional to the frequency, it is also increased in the direction of motion of the source due to the \hyperlink{def-doppler-effect}{Doppler effect}s and decreased in the opposite direction.

%█████████████
\begin{figure}[H]
	\centering
	\includegraphics[width = 8cm]{images/pdf/Doppler.pdf}
	\caption{\textbf{Spherical waves from a moving source.} A diagram showing (left) a central source at rest emitting several circular pulses of light with equal time between each pulse, (right) the same source in a frame where it is now moving and emitting circular pulses of light, but each subsequential pulse is emitted from a different position as the source is moving, marked by a faded dot. *** could be done in latex instead}
	\label{fig: doppler effect intro}
\end{figure}
%███████████

One thing not mentioned yet in this picture so far is how the light is also affected by what is called the \hyperlink{def-aberration}{aberration}, which is the change in the angular distribution of the light at each part of the spherical pulses, which will be explained in the next section.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Aberration} \label{sect: Aberration}

Here, we will talk about what the \hyperlink{def-doppler-effect}{Doppler effect} in the previous section has yet to show, which is the effect on the angular distribution of the light in each part of the spherical pulses.
We will show that there is a higher concentration of light in the direction of the source's movement, as shown in Figure (\ref{fig: truck aberrated}).

With the help of the \hyperlink{def-length-contraction}{length contraction} section (\ref{subsect: Length Contraction}), Consider a truck with a spherical mirrored container, with a central bulb emitting light in all directions.
In the \hyperlink{def-proper-frame}{rest frame} all light reaches the spherical wall \hyperlink{def-simultaneity}{simultaneously} and returns to the center bulb \hyperlink{def-simultaneity}{simultaneously} as well.
Then in the moving frame, we have the spherical container \hyperlink{def-length-contraction}{length contracted} and the light moving at the same speed but reflecting off the same parts of the walls but at different times, and then returning to the center bulb simultaneously.
For this to be true, the directions of the light must be aberrated (have their direction of propagation changed) in the way shown in the diagram to allow for this \hyperlink{def-simultaneity}{simultaneous} return to the bulb.

%█████████████
\begin{figure}[htbp]
	\centering
	\begin{subfigure}{.49\textwidth}
		\centering
		\includegraphics[width = 5.9cm]{images/pdf/Aberrated_lorrys_1.pdf}
		\caption{Pulse emitted}
		\label{fig: truck aberrated 1}
	\end{subfigure}
	\begin{subfigure}{.49\textwidth}
		\centering
		\includegraphics[width = 5.9cm]{images/pdf/Aberrated_lorrys_2.pdf}
		\caption{Pulse absorbed}
		\label{fig: truck aberrated 2}
	\end{subfigure}
	\caption{\textbf{Aberration of light on a truck.} Two diagrams of a truck with a spherical container in two different frames, a light pulse is emitted from the center of the container (left) and reflected back by the mirrored wall to be absorbed in the center again (right), the truck in its \protect\hyperlink{def-proper-frame}{rest frame} (top of both figures) shows an evenly distributed outward light pulse, but in the frame, with the moving truck (bottom of both figures) the emitted light is now more concentrated in the direction of the truck's movement, which is required to allow the light to be reflected by the same part of the container and returned to the center of the truck \protect\hyperlink{def-simultaneity}{simultaneously}.... *** could add the 45 degree angle (rest frame) light rays evolving in this scene as shown in previous figure, as the current picture is difficult to following... Maybe stack a and b vertically... }
	\label{fig: truck aberrated}
\end{figure}
%███████████

%█████████████████████████████████
\iffalse javascript{createTruckDiagram: 33} %█
\fi%██████████████████████████████

From the diagrams, you can see how light's direction of propagation is changed when emitted or absorbed by a moving source relative to its \hyperlink{def-proper-frame}{rest frame}, this is called relativistic aberration. The faster the source is moving, the more the direction of each part of the light pulse is changed/aberrated.

% re-word next paragraph

If the speed of a source was to approach the speed of light, all emitted light's propagation direction would approach the direction of movement of the source.
If the source could theoretically reach the speed of light, all light would be emitted in the direction of the source but also move at the same speed.
That is, the source would move with the emitted light, and it would not leave the vicinity of the source.
The rate at which it emits the light would also tend to zero.
If a photon theoretically had mass and its influence of the gravitational force moved at the speed of light, then we would not be able to feel any gravitational effects from this theoretical photon with mass outside its vicinity.
This is due to all its gravitational field being propagated in the direction of its movement and at the same speed as the photon.

Another note is that in astrophysics, it must be taken into account that the Earth's view of the universe is distorted by \hyperlink{def-aberration}{aberration} when looking through telescopes, with the aberrational effect depending on where it is in its rotation around the sun.

We will look at the combination of the Doppler effect and aberration next.

% as shown in diagram ref{...}. *** diagram of Earth's view of the universe is distorted from the \hyperlink{def-aberration}{aberration} (example on wiki) ***

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Relativistic Beaming} \label{sect: Intro Relativistic Beaming}

When the Doppler effect and relativistic aberration are taken together, it is known as relativistic beaming.
If we have a source in its \hyperlink{def-proper-frame}{rest frame} emitting a spherical pulse of light with evenly distributed angles.
Then in a second frame with the source now moving, the Doppler effect has the spherical pulse's wavelength bunched up in the direction of movement (giving a change in the color of the light), with the aberrational effect also giving the angular spread of the light at a higher concentration in the direction of the movement of the source, as shown in figures (\ref{fig: Relativistic Beaming}).

%█████████████
\begin{figure}[H]
	\begin{subfigure}{.49\textwidth}
		\centering
		\includegraphics[width = 5cm]{images/pdf/Rest_velocities.pdf}
		\caption{\hyperlink{def-proper-frame}{rest frame}}
	\end{subfigure}
	\begin{subfigure}{.49\textwidth}
		\centering
		\includegraphics[width = 5cm]{images/pdf/Aberrated_velocities.pdf}
		\caption{Moving frame}
	\end{subfigure}
	\caption{\textbf{Relativistic beaming of emitted light.} Outward light pulse from source in a rest and moving frame.}
	\label{fig: Relativistic Beaming}
\end{figure}
%███████████

%█████████████
\begin{figure}[H]
	\begin{subfigure}{.49\textwidth}
		\centering
		\includegraphics[width = 5cm]{images/pdf/Rest_velocities_inwards.pdf}
		\caption{\hyperlink{def-proper-frame}{rest frame}}
	\end{subfigure}
	\begin{subfigure}{.49\textwidth}
		\centering
		\includegraphics[width = 5cm]{images/pdf/Aberrated_velocities_inwards.pdf}
		\caption{Moving frame}
	\end{subfigure}
	\caption{\textbf{Relativistic beaming received light.} Inward light pulse from source in its rest and moving frame.}
	\label{fig: Relativistic Beaming Recieved}
\end{figure}
%███████████

%█████████████████████████████████████
\iffalse javascript{createAberrationDiagram} \fi %█
%█████████████████████████████████████

For astrophysics, we need to consider this beaming when looking at distant stars that are moving relative to us so that we can accurately calculate their brightness and the spectrum of light that they are emitting, along with some other things.
We also need to consider that the position we are currently seeing the stars in is their past position due to the delay in light traveling to us on Earth, which is referred to as the retarded position.
We will talk about this next.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{A Source's Retarded Vector Field of Light} \label{sect: Retarded Field}

We can make a vector field plot, which is a plot of arrows that shows the position and direction of light in space.
So if we have a source in its rest frame that continually emits pulses of light with a constant time between each pulse, we get what is shown in Figure (\ref{fig: vector field of light source rest frame}).
If we wanted to know what this light vector field looked like in a frame with the source moving, we would need to take into account that the position the source emitted each pulse from is its past position (retarded position).
We also have the dilated time between pulses in this moving frame, so using these and the beaming effect from the previous section we get the light's vector field as shown in Figure (\ref{fig: vector field of light source primed frame}).
From this, we can work out the distribution and, hence, the concentration of the light for any moving source relative to when it is at rest.
If you look closely at the diagrams, you will see the aberrated rings of all the pulses, all with different points from which they were emitted, with them being more compact in the direction of the source's movement.

%█████████████
\begin{figure}[H]
	\begin{subfigure}{.325\textwidth}
		\centering
		\includegraphics[width = 3.95cm]{images/pdf/Field_Rest_Frame.pdf}
		\caption{Source's Rest Frame}
		\label{fig: vector field of light source rest frame}
	\end{subfigure}
	\begin{subfigure}{.325\textwidth}
		\centering
		\includegraphics[width = 3.95cm]{images/pdf/Field_Moving_Frame_Doppler.pdf}
		\caption{Primed frame}
		\label{fig: vector field of light source primed frame}
	\end{subfigure}
	\begin{subfigure}{.325\textwidth}
		\centering
		\includegraphics[width = 3.95cm]{images/pdf/Field_Moving_Frame_Doppler_circles.pdf}
		\caption{Primed frame}
		\label{fig: vector field of light source with rings}
	\end{subfigure}
	\caption{\textbf{Vector field of light pulses from a source.} A diagram, showing multiple spherically symmetrical pulses of light from a source at rest, fig (a), and in a corresponding inertial frame where the source is now moving, fig (b), the colors show the \protect\hyperlink{def-doppler-effect}{Doppler effect} on the light, and the grey dots show the past positions of source when it had emitted each pulse, there is also a diagram showing the circles of each pulse, fig (c), This shows the spherical waves being closer together in the direction of movement.} % add retarded sources positions as grey dots
	\label{fig: vector field of light source}
\end{figure}
%███████████

In particle physics, the photon is the particle that composes light.
It is the carrier of the electromagnetic force between charges.
So how the light's propagation transforms when swapping between frames is necessary to understand electromagnetism, and how the magnetic field comes about for non stationary sources.
The diagram of the moving source shows you where the source and light currently are.
But, if you were an observer at a particular position in the vector field, you would see the source at its retarded position and not where it currently is, as the light has to travel to you before you see it.
This will be used in the next section to show that you can perceive things moving faster than light, even if they are not.

%Currently, however, you will not be able to find a complete and direct derivation of the electromagnetic force from special relativity and the electric force if you do find one, though you will find quotes in many physics books (such as the Feynman lectures) that the magnetic field is just the relativistic effect applied to the electric field, so if you find a nice derivation I will add it to the math section.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Velocity} \label{sect: (intro) Velocity}

We looked at how velocities at the speed of light change between different frames of reference, that is, how their directions of propagation are rotated (aberrated).
However, for objects moving at velocities slower than that of light, its speed will change in addition to to the direction being transformed when swaping between frames.
This is due to us needing the relativistic transform to tend towards the classical \hyperlink{def-transform}{transform} as we look at smaller and smaller speeds of objects.
To understand the general velocity \hyperlink{def-transform}{transformation}, some mathematical detail is needed, so we will need to brush over this for now, and instead look at how the perceived speeds of objects can be more than that of light, even if they are moving slower.

%███████████████████████████████████████████████████████████████████
\subsection{Perceived vs Actual Speed} \label{subsect: Perceived vs Actual Speed}
% REF: relativity visualized book:

Imagine that a ball one light year away (the distance it takes light to travel in a year) is fired directly towards you, as shown in Figure (\ref{fig: perceived vs actual speed}).
It will take one year for the first light from when the ball starts moving to reach you.
If the ball moves at three-quarters of the speed of light, it will hit you in four-thirds of a year (a year and four months) after it is fired.
The last light from the ball will reach you just as the ball hits you.
As you perceive it, the time between the first and last light from the moving ball is four months.
During those four months, you will see the ball start at its initial position and travel a distance of one light-year.
So, to you, the ball appears to have been moving three times faster than light.
This is just how it appears to the \hyperlink{def-observer}{observer} due to the delay in the light signal, giving the latency in how the system is observed.

%█████████████
\begin{figure}[H]
	\centering
	\includegraphics[width = 10cm]{images/pdf/Perceived_speed.pdf}
	\caption{\textbf{Perceived faster than light movement.} A diagram demonstrating the perceived speed of a ball vs its actual speed ... the red arrow represents the light being emitted from when the ball starts moving from its position one light year away...}
	\label{fig: perceived vs actual speed}
\end{figure}
%███████████

This shows how important it is to consider the delay in the light from objects when observing relativistic systems.
This view is called the delayed/retarded view, meaning what we see now are objects in their past positions, and the further things are from us, the further into the past we are currently seeing them.

%*** Javascript can redo truck diagrams but with speeds less than that of light and have the time between emission and absorption being identical, but speeds and direction of pulse changing depending on rest direction

%*** javascript Diagram could have an animated polar graph of how velocities change for low and fast velocities and frame changes *** could show classical addition of velocities in it too, either as an overlay, beside it, or using button

% Is there a way to visualize the change in none speed of light velocities

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
%\section{The More Abstract Properties...}% of Momentum, Energy and Mass}

%*** could talk about what happens to the quantities without saying why

%This also means that it is impossible to get any particle with mass up to the speed of light, as the closer the particle gets to the speed of light, the heavier it is perceived and, therefore, keeps requiring a greater and greater force to accelerate it, This amount of perceived mass tends to infinity and the force needed to accelerate it would also tend to infinity.\newline

%***
%(diagram)
%If we have two balls roll to the center of a truck at rest and hit each other and stick, giving zero overall momentum as both ball's momentum cancels each other out, but to the observer on the road, the stuck-together balls move with the truck, so the ball at the back of the truck must have more momentum before the collision...
%*** So far, this is also true for classical frame transform

%From before, we have that the consequence of the different times and coordinates is that if a moving object emits light to allow the speed of light to stay constant, the transform will also have the consequence of changing the frequency of the light and hence its energy.

%Since energy is measured in units of position and time (as well as mass), the energy of a particle and systems in different frames have to go through transformations themselves, which leads to the famous energy and mass equivalence equation E = mc2 (this is the reduced form of the equation)\newline

%From finding how the momentum changes between 2 frames due to the Lorentz transformations, we see a relation between the mass of a particle and how much energy this particle is equivalent to. That is, if a particle with a certain mass annihilates with its anti-particle, it gives out photons, corresponding to the energy of the particle, which is different whether it is at rest or moving, as the perceived mass of a particle increases the faster it moves\newline

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Summary}

A key early concept was that light traveled through a medium called the luminiferous aether.
The Michelson-Morley experiment attempted to measure Earth's motion relative to this aether.
Surprisingly, no difference was found in the speed of light regardless of direction through this proposed aether.
This conflicted with the intuitive addition of velocities, discredited the aether theory, and led Einstein to propose light's constant speed in all inertial frames of reference as a fundamental principle.

Special relativity emerged from this insight that light's speed in a vacuum is constant for all observers, regardless of the light source's speed relative to each observer.
This required rethinking the concepts of time intervals and distances between points to accommodate light's fixed speed.
This led to the requirement that a clock moving relative to an observer ticks slower from the observer's perspective while also being contracted in the direction of its motion.
This was shown in Figure (\ref{fig: truck clock}) and Figure (\ref{fig: full truck transform}).
The faster an object moves relative to an observer, the more its length contracts and its time dilates to the observer.

It also led to the \hyperlink{def-simultaneity}{simultaneity} of events not being absolute.
For example, light emitted from the middle of a moving truck reaches the front and back walls simultaneously for an observer at rest in the truck.
But an observer standing still on the road sees the light hit both walls at different times, as shown in Figure (\ref{fig: truck simultaneity}).
There is no universal "now" at a distance-observers relate times of events differently.
It is only events that happen simultaneously at the same location that happen simultaneously in all frames of reference.

Classical physics is verified by our day to day experience, though this does not reflect the full reality, as relativistic effects only become readily noticeable at speeds close to that of light.
With the speed of light being 300 million meters per second, astronomically faster than what occurs in our daily experience.

When it comes to velocities, they combine differently than in classical physics.
However, we must ensure that the transforms reduce to the intuitive addition of velocities of classical physics at low speeds while accommodating light's constant rate in all frames of reference.
This leads to initially bizarre outcomes such as \textbf{apparent} faster-than-light motion emerging from how relativistic optical effects play out across distances, which is due to the delay in light signals from objects at a distance.
Nevertheless, special relativity gives a truer, more accurate picture of reality.

Due to space-time effects on wave propagation, we also have seen that the emitted light's frequencies shift (Doppler effect) for a moving source, and that light is concentrated in the direction of the source's motion (aberrational effect).
Together, both intensely focus light in the direction of rapidly moving objects, giving relativistic beaming.

These effects will all be explained more fully with math in the coming chapters, along with other effects that require the math to fully understand, as well as new energy, mass, and momentum conservation laws.
We will derive everything step by step, starting with the transformation of positions and times between reference frames.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\input{Tex/Terms/Definitions.tex}

*** I could add a section about Skewing and Terrell Rotation in Special Relativity

%███████████████████████████████████████████████████████████████████
\printbibliography[segment=\therefsegment, heading=subbibliography] % , resetnumbers=true]

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\chapter{Position, Time and Velocity} \label{ch: Position, Time and Velocity} %The Math Begins:

Now that we have learned about the concepts of special relativity, we can use them and let the mathematics begin.
Starting with classical relativity, which will give us an understanding of how to \hyperlink{def-transform}{transform} coordinates between \hyperlink{def-Reference-frame}{reference frame}s.
This will give us something to compare special relativity to later, and help with our intuition.

What we learn here will be directly used in all of the following chapters, to derive more of the foundational concepts of the theory.
As everything else is all built upon this chapter, which is about how the positions and times are transformed between two inertial frames to allow the speed of light to stay constant.

In this chapter, we will start with how swapping between two inertial frames works classically.
Then using the two assumed facts, the postulates, that are used as the basis of reasoning for special relativity, we will find out how to swap between frames in special relativity, by following the train of thought that we did in the previous conceptual chapter.
By first deriving the time dilation, and length contraction equations in order to then find the full transform of the space and time coordinates between two inertial frames.
We will come across a very useful quantity which we will denote with a ${\gamma}$, this quantity will be used throughout this book to simplify equations.
After this, we will look at the transform for infinitesimal changes in distances and use this to derive how velocities and accelerations change when swapping between two inertial frames.
By the end of this chapter, you will understand the coordinate transforms conceptually and mathematically when swapping between two frames, and how to derive the velocity and acceleration transforms.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Classical Relativity} \label{sect: Classical Relativity}

Classical (Galilean) relativity was the earlier theory of how to transform coordinates in different inertial frames.

It was based on two assumptions, which are that \textbf{in each frame, you would observe the following:}

\begin{itemize}
	\item The distance between objects is the same.
	\item Time flows at the same rate, giving the same time for an event in each frame.
\end{itemize}

Before special relativity, it was assumed that distances between two points were the same for all \hyperlink{def-observer}{observer}s.
That is, the first \hyperlink{def-observer}{observer} would see a stick and measure it to be the same length as another \hyperlink{def-observer}{observer} who is moving relative to the first.
The other assumption is that the flow of time is the same for everyone.
That is, clocks move at the same rate for each \hyperlink{def-observer}{observer} and if, say, a particle was to emit light at a particular time, this light would be emitted at the same time for all \hyperlink{def-observer}{observer}s.

For classical relativity, if we have the positions and times of a particle's motion relative to one observer in their frame, and we want to find the motion of the particle relative to a second observer who is moving at constant velocity relative to the first.
We need to know how to transform these into this second observer's frame.
That is, if we have how one \hyperlink{def-observer}{observer} would describe the coordinates of a particle over time relative to them and we want to now know the coordinates of the particle with respect to the other \hyperlink{def-observer}{observer}, we need to know how the transformation of coordinates works.

So let us see how the mathematics works for the classical coordinate system transform between two inertial observers frames, by looking at the coordinates of an event in an initial reference frame with a second inertial frame's coordinate axis moving relative to the initial frame's, illustrated in Figure (\ref{fig: simple Galilean transform derivation}):

%█████████████
\begin{figure}[H]
	\centering
	\tikzsetnextfilename{Tikz_simple_Galilean_transform_derivation}
	\begin{tikzpicture}[scale = 3]%,tdplot_main_coords]
		\coordinate (O) at (0,0,0);
		%
		\draw[black, thick,->] (1.5,0,0)--(2.1,0,0) node[anchor = north east]{${x}$};
		\draw[black, thick,->] (1.7,-0.2,0)--(1.7,0.45,0) node[anchor = west]{${z}$};
		\draw[black, thick,->] (1.7,0,0.3)--(1.7,0,-0.7) node[anchor = south]{${y}$};
		%
		\draw[gray, dashed, thick,->] (1.5,0.7,0)--(2.1,0.7,0) node[anchor = north east]{${x{'}}$};
		\draw[gray, dashed, thick,->] (1.7,0.5,0)--(1.7,1.2,0) node[anchor = west]{${z{'}}$};
		\draw[gray, dashed, thick,->] (1.7,0.7,0.3)--(1.7,0.7,-0.8) node[anchor = south]{${y{'}}$};
		\draw[gray, thick,->>] (1.55,0.7,0)--(1.55,0.92,0) node[anchor = east]{${v}$};
		\fill[red] (3.03,0.9,0) circle (0.6pt);
		%
		\draw[red, thick,->] (1.7,0,0)--(3.02,0.87,0) node[midway,anchor = north]{${\mathbf{r}}$};
		\draw[red, thick,->] (1.7,0,0)--(1.7,0.7,0) node[midway,anchor = east]{${\vec{OO{'}}}$};
		\draw[red, thick,->] (1.7,0.7,0)--(3,0.9,0) node[midway,anchor = south]{${\vec{O{'}E}}$};
		%
	\end{tikzpicture}
	\caption{\textbf{An event in initial frame with a primed frame's axis moving relative to its axis.}	This shows an initial frame with its associated $x,y,z$-coordinate system at rest in this frame, with origin ${O}$. There is also an $x',y',z'$-coordinate system with origin ${O'}$ associated with the "primed" frame, at position ${\vec{OO'}}=(0,0,{v}{t})$ in the initial frame, where ${v}$ is the speed of the primed frame in the z-direction relative to the initial frame, and ${t}$ is the time in the initial frames. An event ${\vec{E}}$ in this initial frame is described by a set of spatial and time coordinates ${\mathbf{r}} = ({x},{y},{z})$ and ${t}$. We choose the time to be zero in both frames when both axes overlapped, so that ${t}$ is also the time from when they overlapped. We also show ${\vec{O'E}}$ which represents the vector from the primed axis origin to the event in the initial frame.}
	\label{fig: simple Galilean transform derivation}
\end{figure}
%███████████

As shown in the diagram, we are in the initial frame with origin ${O}$ defined by coordinates $(0,0,0)$ and the primed frame is moving in the z-direction at velocity ${v}$ such that the position of the primed origin relative to the initial frame's axis is

\begin{equation}
	\vec{OO{'}} = (0,0,{v}{t})
\end{equation}

at time ${t}$ from when the origins overlapped.
If there is an \hyperlink{def-event}{event} at position

\begin{equation}
	\mathbf{r} = ({x},{y},{z})
\end{equation}

the event is described by

\begin{equation}
	\vec{E} = ({x},{y},{z},{t})
\end{equation}

then in the primed frame, we will have the event described by the primed coordinates that we want to transform into, as

\begin{equation}
	\vec{E{'}} = ({x{'}},{y{'}},{z{'}},t{'})
\end{equation}

To swap into the primed frame's coordinates, we need to recall from the previous assumptions that distances and times are conserved, and therefore the length and directions of all the vectors between ${O}$, ${O^{'}}$ and ${E}$ are the same in each frame, and time flows at the same rate (${t'} = {t}$), from this knowledge and Figure (\ref{fig: simple Galilean transform derivation}) we have the event's coordinates described in the primed frame by its coordinate axis as

\begin{equation}
	{\mathbf{r}{'}} = ({x{'}},{y{'}},{z{'}}) = \mathbf{r}-\vec{OO{'}} = ({x},{y},{z}-{v}{t})
	\label{eq: classical event}
\end{equation}

This gives us the full description of the position and time \hyperlink{def-transform}{transform} for an \hyperlink{def-event}{event} as

\begin{equation}
	\mhl{
		\begin{aligned}
			 & {x{'}} = {x}        \\
			 & {y{'}} = {y}        \\
			 & {z{'}} = {z}-{v}{t} \\
			\text{at time \ \ \ }  \\
			 & {t{'}}= {t}
		\end{aligned}
	}
	\label{eq: Galilean transformation}
\end{equation}

These are the equations that define classical relativity, we can compare this to the equations of the coordinate transforms in special relativity later. They define the event's position relative to whichever frame that we are in's axis. The special relativistic equations later will look similar to these, but with an extra factor in the z-component and with the time will no longer be consistent in both frames.

We can also write the initial frame's event coordinates in terms of the primed coordinates, by rearranging the transformation equations giving the inverse transform as

\begin{equation}
	\begin{aligned}
		 & {x} = {x{'}}             \\
		 & {y} = {y{'}}             \\
		 & {z} = {z{'}} + {v}{t{'}} \\
		\text{at time \ \ \ }       \\
		 & {t} = {t{'}}
	\end{aligned}
	\label{eq: Inverse Galilean transformation}
\end{equation}

So the inverse transformation, going from \hyperlink{def-Primed-Frame}{primed frame} to original is just a matter of swapping all primed and initial coordinates and changing the sign on the \hyperlink{def-frame-velocity}{frame velocity}
This can be seen at time ${t} = 0$ when we have the frame's origins overlapping and there is a symmetry from here, as we have the freedom to choose either frame to be the original, as no frame is particularly special and depending which one you pick the relative velocity is either ${v}$ or-${v}$. We will have the same rules in special relativity later on when we want to get the inverse transform.

You might have noticed that the direction of the second frame is in the upward z-direction instead of being to the right in the case of the truck diagrams from the previous chapter, this is to help us when we use spherical polar coordinates later and to help see the symmetries. But that is a couple of chapters away, for now we will look at the assumptions of special relativity and their consequences, which we will then apply to the same notion of an event that we have in the Figure (\ref{fig: simple Galilean transform derivation}).

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Postulates of Special Relativity} \label{sect: Postulates of Special Relativity}

For classical relativity, we started with two assumptions. It turns out that these assumptions need to be thrown away, as they contradict the experimental evidence that the speed of light is constant for every observer and frame. We replace them with two new assumptions, called the \textbf{postulates of special relativity:}

\begin{mainpoints}
		\item The speed of light in a \hyperlink{def-vacuum}{vacuum} is the same in all inertial/non-accelerating frames of reference.
		\item The laws of physics and outcome of experiments are the same in all \hyperlink{def-Inertial-reference-frame}{inertial frames of reference}. If an observer in an inertial reference frame carries out an experiment, they would find the same result if they had carried it out within a different inertial frame instead.
\end{mainpoints}

The first postulate here will be the most important to us in deriving the transform equations of special relativity and will be used to show how time is dilated/slowed down for moving objects. The second postulate has a consequence that if events happen simultaneously at an overlapping position in one frame, then they will also happen simultaneously in an overlapping position in any other inertial frame.
We will now use these assumptions with the concept of a light clock to show the effect of length contraction.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Time Dilation} \label{sect: Time Dilation}

Time passes more slowly for things moving relative to you, this is called time dilation.
To explain why it happens we will use the simple concept of a light clock.
It consists of light bouncing between two mirrors.
It keeps time by measuring when light returns to the first mirror, counting it as one tick of its clock, as shown in Figure (\ref{fig: light clock}).

%█████████████
\begin{figure}[H]
	\begin{subfigure}{.49\textwidth}
		\centering
		\tikzsetnextfilename{Time_dilation_rest_frame}
		\begin{tikzpicture}[scale = 0.65]
			% Define the coordinates with more space between ellipses
			\coordinate (A1) at (0, 6);
			\coordinate (B1) at (6, 6);

			% Draw the ellipses
			\draw[fill = gray] (A1) ellipse (0.5 and 1);
			\draw[fill = gray] (B1) ellipse (0.5 and 1);

			% Custom arrowhead style with thicker arrowheads
			\tikzset{thick arrows/.style = {-stealth, thick, line width = 1.5pt}}

			% Draw the dashed arrowed lines with custom thick arrowheads
			\draw[red, dashed, thick arrows] (0, 5.85)--(6, 5.85);
			\draw[red, dashed, thick arrows] (6, 6.15)--(0, 6.15) node[midway, above] {$\frac{1}{2}{c}{\Delta t}$};

			% Draw the distance labels
			\draw[<->, thick] (0, 4.7)--(6, 4.7) node[midway, above] {${L}$};

			\draw[] (0,-1.25);

		\end{tikzpicture}
		\caption{\hyperlink{def-proper-frame}{rest frame}}
		\label{fig: light clock rest frame}
	\end{subfigure}
	\begin{subfigure}{.49\textwidth}
		\centering
		\tikzsetnextfilename{Time_dilation_moving_frame}
		\begin{tikzpicture}[scale = 0.65]
			% Define the coordinates with more space between ellipses
			\coordinate (A1) at (0, 6);
			\coordinate (A2) at (0, 3);
			\coordinate (A3) at (0, 0);
			\coordinate (B1) at (6, 6);
			\coordinate (B2) at (6, 3);
			\coordinate (B3) at (6, 0);

			% Draw the ellipses
			\draw[fill = gray] (A1) ellipse (0.5 and 1);
			\draw[fill = gray, fill opacity = 0.2, draw = gray, dashed] (A2) ellipse (0.5 and 1);
			\draw[fill = gray, fill opacity = 0.1, draw = gray, dashed] (A3) ellipse (0.5 and 1);
			\draw[fill = gray] (B1) ellipse (0.5 and 1);
			\draw[fill = gray, fill opacity = 0.2, draw = gray, dashed] (B2) ellipse (0.5 and 1);
			\draw[fill = gray, fill opacity = 0.1, draw = gray, dashed] (B3) ellipse (0.5 and 1);

			% Custom arrowhead style with thicker arrowheads
			\tikzset{thick arrows/.style = {-stealth, thick, line width = 1.5pt}}

			% Draw the dashed arrowed lines with custom thick arrowheads
			\draw[red, dashed, thick arrows] (A3)--($(B2)!0.02!(A3)$) node[midway, below] {$\frac{1}{2}{c}{\Delta t{'}}$};
			\draw[red, dashed, thick arrows] (B2)--(A1) node[midway, below] {$\frac{1}{2}{c}{\Delta t{'}}$};

			% Draw the velocity arrow
			\draw[black, thick,->, line width = 1.5pt] (3, 6)-- +  + (0, 0.5) node[midway, right] {${u}$};

			% Draw the distance labels
			\draw[<->, thick] (0,-1.3)--(6,-1.3) node[midway, above] {${L}$};
			\draw[->, thick] (-1, 0)--(-1, 6) node[midway, left] {${u}{\Delta t{'}}$};

		\end{tikzpicture}
		\caption{Moving frame}
	\end{subfigure}
	\caption{\textbf{Light clock showing time dilation.} The light clock keeps time by counting each time the light makes a return journey when bouncing between two mirrors with length ${L}=\frac{1}{2}{c}{\Delta \tau}$ between them, were ${\Delta\tau}$ is the time for the return journey in the rest frame, the diagram shows the mirror's rest frame (left) and a frame with them moving at speed ${u}=-{v}$ (right). In this second frame, there is a distance ${u}{\Delta t{'}}$ between where the light was initially reflected by the left mirror and where it returned to it. For this, the light had to travel a total diagonal distance of ${c}{\Delta t{'}}$ to return, were ${\Delta\tau}$ is the time for the return journey in the primed frame.}
	\label{fig: light clock}
\end{figure}
%███████████

The light in the clock, takes a time ${\Delta\tau}$ in the clock's rest frame to make the return journey.
We can see from Figure (\ref{fig: light clock rest frame}) that in the rest frame, the distance the light travels to the mirror and back in this time is

\begin{equation}
	2{L} = {c}{\Delta\tau}.
\end{equation}

The distance the mirrors move during this return journey in the moving frame is

\begin{equation}
	{u}{\Delta t{'}} =-{v} {\Delta t{'}},
\end{equation}

where ${\Delta t{'}}$ is the time it took light to return in the moving frame and ${u}$ is the speed of the light clock, which is in the opposite direction of the movement of the \hyperlink{def-Primed-Frame}{primed frame} relative to the \hyperlink{def-proper-frame}{rest frame}, that is ${u} =-{v}$.

The distance light travels in this time is

\begin{equation}
	{c}{\Delta t{'}}
\end{equation}

This is the hypotenuse of a right angled triangle formed by ${u}{\Delta t{'}}=-{v}{\Delta t{'}}$ and $2{L}$, so we have the square of the hypotenuse equal to the square of the other two lengths:

\begin{equation}
	{c}^2 {\Delta t{'}}^2 = {v}^2 {\Delta t{'}}^2 + {c}^2{\Delta\tau}^2
\end{equation}

rearranging to find the time it took in the \hyperlink{def-Primed-Frame}{primed frame} relative to the \hyperlink{def-proper-frame}{rest frame}, we find

\begin{equation}
	{\Delta t{'}} = \frac{1}{\sqrt{1-\frac{{v}^2}{{c}^2}}} {\Delta\tau} = {\gamma} {\Delta\tau}
\end{equation}

with

\begin{equation}
	{\gamma} = \frac{1}{\sqrt{1-\frac{{v}^2}{{c}^2}}}.
\end{equation}

This factor, ${\gamma}$, is used throughout special relativity to simplify equations.
We can see from the diagram and the equations, that the time for the return journey in the frame with the clock moving is longer relative to its rest frame,

\begin{equation}
	{\Delta t{'}} \geq {\Delta\tau}
\end{equation}

We take this outcome as the time taken between two \hyperlink{def-event}{event}s at the same position in the moving frame takes longer than in the \hyperlink{def-proper-frame}{rest frame} of the clock, due to the longer distance light must travel at the same speed.
Hence systems that are moving seem to have there time flowing slower.
One example of this, is that unstable particles that are moving faster have longer livespans before they decay.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Length Contraction} \label{sect: Length Contraction}

An object's size gets smaller in the direction of movement compared to when it is at rest, this is called length contraction.
To explain why it happens we will add a second perpendicular light path to previous section's experimental setup.
So there is now light moving perpendicular as well as parallel the the primed frame's movement, as shown in Figure (\ref{fig: length contraction math})

%█████████████
\begin{figure}[H]
	\begin{subfigure}{.49\textwidth}
		\centering
		\tikzsetnextfilename{Length_contraction_rest_frame}
		\begin{tikzpicture}[scale = 0.55]
			% Define the coordinates with more space between ellipses
			\coordinate (A1) at (0, 0);
			\coordinate (B1) at (6, 0);
			\coordinate (C1) at (0, 6);

			% Draw the ellipses
			\draw[fill = orange] (A1) ellipse (0.5 and 0.5);
			\draw[fill = gray] (B1) ellipse (0.5 and 1);
			\draw[fill = gray] (C1) ellipse (1 and 0.5);

			% Custom arrowhead style with thicker arrowheads
			\tikzset{thick arrows/.style = {-stealth, thick, line width = 1.5pt}}

			% Draw the dashed arrowed lines with custom thick arrowheads
			\draw[red, dashed, thick arrows] (0, -0.15)--(6, -0.15);
			\draw[red, dashed, thick arrows] (6, 0.15)--(0, 0.15);
			\draw[red, dashed, thick arrows] (-0.15, 0)--(-0.15, 6) node[midway, left] {${l_1}$};
			\draw[red, dashed, thick arrows] (0.15, 6)--(0.15, 0) node[midway, right] {${l_2}$};

			% Draw the distance labels
			\draw[<->, thick] (-1.5, 0)--(-1.5, 6) node[midway, left] {${\Delta L}$};
			\draw[draw=none, fill opacity = 0] (0,-7) circle (0.5);

		\end{tikzpicture}
		\caption{\hyperlink{def-proper-frame}{Rest frame}}
		\label{fig: light clock length contraction rest frame}
	\end{subfigure}
	\begin{subfigure}{.49\textwidth}
		\centering
		\tikzsetnextfilename{Length_contraction_moving_frame}
		\begin{tikzpicture}[scale = 0.55]
			% Define the coordinates with more space between ellipses
			\coordinate (A1) at (0, 0);
			\coordinate (B1) at (6, 0);
			\coordinate (C1) at (0, 4.5);
			\coordinate (P1) at (0, -7);
			\coordinate (P2) at (6, -3.5);
			\coordinate (P3) at (0, 3);

			% Draw the ellipses
			\draw[fill = orange] (A1) ellipse (0.5 and 0.5);
			\draw[fill = gray] (B1) ellipse (0.5 and 1);
			\draw[fill = gray] (C1) ellipse (1 and 0.5);
			\draw[fill = orange, fill opacity = 0.1, draw = gray, dashed] (P1) ellipse (0.5 and 0.5);
			\draw[fill = gray, fill opacity = 0.1, draw = gray, dashed] (P2) ellipse (0.5 and 1);
			\draw[fill = gray, fill opacity = 0.1, draw = gray, dashed] (P3) ellipse (1 and 0.5);

			% Custom arrowhead style with thicker arrowheads
			\tikzset{thick arrows/.style = {-stealth, thick, line width = 1.5pt}}

			% Draw the dashed arrowed lines with custom thick arrowheads
			\draw[red, dashed, thick arrows] ($(P1)+(-0.15,0)$)--($(P3)+(-0.15,0)$) node[midway, left] {${l^{'}_1}$};
			\draw[red, dashed, thick arrows] ($(P3)+(0.15,0)$)--($(A1)+(0.15,0)$) node[midway, right] {${l^{'}_2}$};
			\draw[red, dashed, thick arrows] (P1)--(P2);
			\draw[red, dashed, thick arrows] (P2)--(A1);

			\draw[<->, thick] ($(A1)+(-1.5,0)$)--($(C1)+(-1.5,0)$) node[midway, left] {${\Delta L^{'}}$};

			\draw[black, thick,->, line width = 1.5pt] (3, 4)-- +  + (0, 0.5) node[midway, right] {${u}$};

		\end{tikzpicture}
		\caption{Moving frame}
	\end{subfigure}
	\caption{\textbf{Light paths showing the need for length contraction.} A central orange bulb emits light in two directions, with all light being reflected by the mirrors back to reach the central bulb simultaneously. This is shown at rest, fig (a), and in another inertial frame with the system now moving at speed ${u}$, fig (b), with its length now having to be contracted in the direction of movement to allow for the simultaneous return of light to the bulb. The length between the bulb and front mirror is shown as ${\Delta L}$ and ${\Delta L^{'}}$ in each frame. The paths the light took to the front mirror ${l_1}$ and back ${l_2}$ are shown in the rest frame with the corresponding paths ${l^{'}_1}$ and ${l^{'}_2}$ in the moving frame.}
	\label{fig: length contraction math}
\end{figure}

If we have a system as described in Figure (\ref{fig: length contraction math}).
Then since the light returns simultaneously in the rest frame, we need the light to also return simultaneously in the second frame.
Multiple events that happen at a single point simultaneously in one frame, must happen simultaneously at a single point in all other frames.
This is to allow for the second postulate to hold true.
The time between the light being emitted and absorbed will be the dilated time that we worked out in the previous section.
This can be seen as the sideways light path in this and the light clock's setup from previous section is the same path.
In the moving frame, to achieve this simultaneity in the return of the light to the bulb, the length of the full path of light from the central bulb to the front mirror and back ($2 {\Delta L^{'}} = {l^{'}_1} + {l^{'}_2}$) must be the same as the perpendicular path, due to the speed of light being the same for both paths.
We can work out the length of the sideways paths from the time dilation section, ${c}{\Delta t^{'}}$, and this is the length the total path needs to be in the forward directions as well.
We will find that the paths can only have this length, if the distance between the bulb and the front mirror is contracted in the direction of movement.
Note that there can not be a contraction in the perpendicular direction to the movement due to the paradox explained in Figure (\ref{fig: width contraction}).

In the moving frame, the pulse sent forward has a path length equal to the speed of light times the time taken for the path.
Which is also equal to the primed frame's distance between the bulb and mirror plus the distance the mirror has moved away from the point it was emitted in this time, that is

\begin{equation}
	{l^{'}_1} = {c}{\Delta t^{'}_1} = {\Delta  L^{'}} + {u} {\Delta t^{'}_1}
\end{equation}

where ${u}$ is the speed that the front mirror is moving away from the point it was emitted, ${\Delta t^{'}_1}$ is the time taken to get to the mirror, and ${\Delta  L^{'}}$ is the distance between the bulb and the mirror in front in the primed frame.
After reaching the mirror, the light then must travel back to the bulb a distance

\begin{equation}
	{l^{'}_2} = {c} {\Delta t^{'}_2} = {\Delta  L^{'}} - {u} {\Delta t^{'}_2}.
\end{equation}

Where ${\Delta t^{'}_2}$ is the time taken to return to the bulb from the front mirror, with the source moving twowards the reflected light.

Both of these give the two times as

\begin{equation}
	{\Delta t^{'}_1} = \frac{\Delta  L'}{{c} - {u}}
\end{equation}

and

\begin{equation}
	{\Delta t^{'}_2} = \frac{{\Delta  L^{'}}}{{c} + {u}}.
\end{equation}

Adding both these times together gives the total dilated time of return as

\begin{equation}
	\begin{aligned}
	{\Delta t{'}} &\color{gray} = {\Delta  L^{'}}(\frac{1}{{c} + {u}} + \frac{1}{{c} - {u}}) \\
	&\color{gray} = \frac{\Delta  L^{'}}{c}\frac{2}{1- {u}^2/{c}^2} \\
	&=  2{\gamma}^2 \frac{\Delta  L^{'}}{c}
	\end{aligned}
\end{equation}

where we used ${u}=-{v}$ and then the ${\gamma}$ factor to simplfy equation.
Now from this and using the the time dilation equation, we have

\begin{equation}
	{c}{\Delta t{'}} = {c}{\gamma} {\Delta t} = 2{\gamma} {\Delta L} = 2{\gamma}^2 {\Delta  L^{'}}
\end{equation}

Finally, this leads to the length from the bulb to the front mirror in the primed frame to be

\begin{equation}
	{\Delta  L^{'}} = \frac{1}{{\gamma}}{\Delta  L}.
\end{equation}

This means that for a system moving relative to an observer, the distances for the system in the direction of movement are contracted compared to the rest frame of the object, that is

\begin{equation}
	{\Delta  L^{'}} \leq {\Delta  L}.
\end{equation}

Objects and the distance between them are therefore shorter in a frame with them moving compared to in the rest frame of the objects.

With this knowledge and the last section, we can now derive the coordinate transform equations.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Position and Time Transformation} \label{sect: Position and Time Transformation}

In the last two sections we have looked at the dilation between two different times at the same location and the contraction between two different positions at the same time, when we swap between frames.
Now we will use both these concepts to help us see how the combination of the time and the position coordinate, known as an event, transforms when we swap frames.
For the derivation of the coordinate transformation of an event between two inertial frames, we will be starting with the same diagram as we had in the classical relativity in Section (\ref{sect: Classical Relativity}) and apply what we have learned from the time dilation and length contraction sections so that we can be consistent with the postulates of special relativity.
This will allow us to derive the coordinate transformation equations, known as the Lorentz transformation.

%█████████████
\begin{figure}[H]
	\centering
	\tikzsetnextfilename{Tikz_simple_lorentz_transform_derivation}
	\begin{tikzpicture}[scale = 3]%,tdplot_main_coords]
		\coordinate (O) at (0,0,0);
		%
		\draw[black, thick,->] (1.5,0,0)--(2.1,0,0) node[anchor = north east]{${x}$};
		\draw[black, thick,->] (1.7,-0.2,0)--(1.7,0.45,0) node[anchor = west]{${z}$};
		\draw[black, thick,->] (1.7,0,0.3)--(1.7,0,-0.7) node[anchor = south]{${y}$};
		%
		\draw[gray, dashed, thick,->] (1.5,0.7,0)--(2.1,0.7,0) node[anchor = north east]{${x{'}}$};
		\draw[gray, dashed, thick,->] (1.7,0.5,0)--(1.7,1.2,0) node[anchor = west]{${z{'}}$};
		\draw[gray, dashed, thick,->] (1.7,0.7,0.3)--(1.7,0.7,-0.8) node[anchor = south]{${y{'}}$};
		\draw[gray, thick,->>] (1.55,0.7,0)--(1.55,0.92,0) node[anchor = east]{${v}$};
		\fill[red] (3.03,0.9,0) circle (0.6pt);
		%
		\draw[red, thick,->] (1.7,0,0)--(3.02,0.87,0) node[midway,anchor = north]{${\mathbf{r}}$};
		\draw[red, thick,->] (1.7,0,0)--(1.7,0.7,0) node[midway,anchor = east]{${\vec{OO{'}}}$};
		\draw[red, thick,->] (1.7,0.7,0)--(3,0.9,0) node[midway,anchor = south]{${\vec{O{'}E}}$};
		%
	\end{tikzpicture}
	\caption{\textbf{An event in initial frame with a primed frame's axis moving relative to it.} This shows an initial frame with its associated $x,y,z$-coordinate system at rest in this frame, with origin ${O}$. There is also an $x',y',z'$-coordinate system with origin ${O'}$ associated with the "primed" frame, at position ${\vec{OO'}}=(0,0,{v}{t})$ in the initial frame, where ${v}$ is the speed of the primed frame in the z-direction relative to the initial frame, and ${t}$ is the time in the initial frames. An event ${\vec{E}}$ in this initial frame is described by a set of spatial and time coordinates ${\mathbf{r}} = ({x},{y},{z})$ and ${t}$. We choose the time to be zero in both frames when both axes overlapped, so that ${t}$ is also the time from when they overlapped. We also show ${\vec{O'E}}$ which represents the vector from the primed origin to the event in the initial frame.}
	\label{fig: simple Lorentz transform derivation}
\end{figure}
%███████████

As shown in the diagram, we are in the initial frame with origin ${O}$ defined by coordinates $(0,0,0)$ and the primed frame is moving in the z-direction at velocity ${v}$ such that the position of the primed origin in the initial frame is

\begin{equation}
	\vec{OO{'}} = (0,0,{v}{t})
\end{equation}

at time ${t}$ from when the origins overlapped.
If there is an \hyperlink{def-event}{event} described by

\begin{equation}
	\vec{E} = ({x},{y},{z},{t})
\end{equation}

Then the displacement between the initial frame's origin and the event's position in the initial frame is

\begin{equation}
	\mathbf{r} = ({x},{y},{z})
\end{equation}

and displacement between the primed frame's origin and the event's coordinates in the initial frame is

\begin{equation}
	\vec{O'E} = ({x},{y},{z}-{v}{t})
\end{equation}

In the primed frame, we will have the event described by the primed coordinates that we want to transform into, as

\begin{equation}
	\vec{E}^{'} = ({x{'}},{y{'}},{z{'}},t{'})
\end{equation}

with the displacement between the primed frame's origin and the event's position in the primed frame given as

\begin{equation}
	{\mathbf{r}{'}} = ({x{'}},{y{'}},{z{'}})
\end{equation}

These are just the position coordinates of the event in the primed frame.

The primed frame's axis and coordinates are moving relative to the initial frame, so from the previous length contraction section we would have the displacement between the primed axis origin and the event in the intial frame $\vec{O'E}$, length contracted, in the $z$-direction, compared to the primed position coordinates in the primed frame ${\mathbf{r}{'}}$, that is

\begin{equation}
	\vec{O'E} = ({x},{y},{z}-{v}{t}) = ({x{'}},{y{'}},\frac{z{'}}{\gamma})
\end{equation}

The $x$ and $y$-components are unaffected, with the paradox of it they were effected, explained in Figure (\ref{fig: width contraction}).
Rearranging for the $z$-component, we have

\begin{equation}
	({x{'}},{y{'}},{z{'}}) = {\mathbf{r}{'}} = ({x},{y},{\gamma}({z}-{v}{t}) )
\end{equation}

There is a symmetry between the frames because if we were originally in the primed frame we would have the initial frame moving instead at -${v}$ in the z-direction relative to the primed frame and we could follow the above steps starting with this and the primed coordinate instead, and find the inverse \hyperlink{def-transform}{transformation} is the same apart from it replaces each frame's coordinates with the other and has the negative of the previous frame velocity instead.
That is

\begin{equation}
	({x},{y},{z}) = {\mathbf{r}} = ({x{'}},{y{'}},{\gamma}({z{'}}+{v}{t{'}}) )
\end{equation}

We can substitute both $z$-coordinate transforms into each other to find the time transform

\begin{equation}
	{z} = {\gamma} ( {\gamma} ({z}-{v}{t}) + {v}{t{'}})
\end{equation}

and rearranging gives

\begin{equation}
	{t{'}} = {\gamma} \left( \left( \dfrac{1}{{\gamma}^2}-1 \right)\frac{z}{v} + t \right)
\end{equation}

with $1/{\gamma}^{2} = 1-{v}^2/{c}^2$ leading to the primed frames time for the event given in initial frames coordinates as

\begin{equation}
	{t{'}} = {\gamma} \left( t-\dfrac{{v}{z}}{{c}^2} \right)
\end{equation}

again if we want the inverse transform from primed to initial frame we can swap the primed and initial frame coordinates and put an extra minus in front of the frame velocity.

\begin{equation}
	{t} = {\gamma} \left( t{'}+\dfrac{{v}{z{'}}}{{c}^2} \right)
\end{equation}

We now have the full description of the transformation of the position and time of an \hyperlink{def-event}{event} as

\begin{equation}
	\mhl{
		\begin{aligned}
			 & {x{'}} = x                                           \\
			 & {y{'}} = y                                           \\
			 & {z{'}} = {\gamma} ({z}-{v}{t})                       \\
			\text{at time \ \ \ }                                   \\
			 & {t{'}} = {\gamma} \bigg(t-\frac{{v}{z}}{{c}^2}\bigg) \\
			 & \text{from the overlap of coordinate axis. \ \ \ }   \\
			\text{with \ \ \ }                                      \\
			 & {\gamma} = \dfrac{1}{\sqrt{1-\frac{{v}^2}{{c}^2}}}
		\end{aligned}
	}
	\label{eq: Lorentz transformation}
\end{equation}

These are the equations that define special relativity, They allow us tyo find an event's position relative to whichever frame that we want to swap into's axis.

In the time \hyperlink{def-transform}{transform} equation the $\frac{{v}{z}}{{c}^2}$ term is the cause of the \hyperlink{def-simultaneity}{simultaneity} of \hyperlink{def-event}{event}s at two different positions in one inertial frame no longer being \hyperlink{def-simultaneity}{simultaneous} in another inertial frame, and the ${\gamma}$ factor, is the term that causes the overall change in how fast time flows at a point relative to the initial frame.
In the spatial coordinate transform equations the the ${v}{t}$ factor is due to both axes' origins moving away from each other and the ${\gamma}$ factor is the cause of the change of lengths in the direction of the frame's movement.

We can see how points representing the coordinates in an initial frame look like in a primed frame of reference, by looking at Figure (\ref{fig: coordinate transform}).

%█████████████
\begin{figure}[H]
	\centering
	\begin{subfigure}{0.29\textwidth}
		\centering
		\includegraphics[width=\textwidth]{images/pdf/coord_transform_initial.pdf}
		\caption{Initial frame}
		\label{fig: coordinate transform subfig_1}
	\end{subfigure}
	\begin{subfigure}{0.32\textwidth}
		\centering
		\includegraphics[width=\textwidth]{images/pdf/coord_transform_primed.pdf}
		\caption{primed frame}
		\label{fig: coordinate transform subfig_2}
	\end{subfigure}
	\begin{subfigure}{0.29\textwidth}
		\centering
		\includegraphics[width=\textwidth]{images/pdf/coord_transform_primed_sychronised.pdf}
		\caption{primed frame (${t{'}}=0$)}
		\label{fig: coordinate transform subfig_3}
	\end{subfigure}
	\caption{\textbf{Transformation of coordinates into a primed frame.} A diagram, showing a grid of points, representing the initial frame's coordinates, at time ${t} = 0$ that are at rest in their frame (left), giving the direct transformation, using the transform equations, into the moving primed frame (middle) where the points are now moving in the negative z-direction with ${z{'}} = {\gamma} {z}$, the colors and labels show the desynchronization of the primed times ${t{'}} = -\frac{{v}}{{c}^2} {\gamma} {z}$, the next figure (right) shows where these points would be when they are synchronized with the primed origin's time ${t{'}} = 0$, which can be worked out to be (${z{'}} = \frac{{z}}{{\gamma}}$).}
	\label{fig: coordinate transform}
\end{figure}
%███████████

This diagram shows stationary points representing coordinates in the initial frame.
In the primed frame, these points are transformed to the position ${z{'}} = {\gamma} {z}$ and are now moving at speed $-{v}$, they are transformed using the transformation equations to points that are more spread out in the primed frame, but the times they are located at each of these points are different, they have desynchronized times.
Therefore to find these points, which represent the coordinates in the initial frame, now in the primed frame at the synchronized time of ${t{'}} = 0$, we must propagate the points to that time, which ends up being ${z{'}} = \frac{{z}}{{\gamma}}$, as shown in figure (\ref{fig: coordinate transform subfig_3}).

This figure is to give you a little bit more intuition on how the coordinates and swapping between frames work.
We will later see a more natural interpretation of the coordinate transforms when we introduce the notion of retarded time in Chapter (\ref{ch: Observers Delayed Worldview}), which will give us another reason for why the time transformation is the way it is.

%███████████████████████████████████████████████████████████████████
\subsection{Transforms with Small Primed Frame Velocity} \label{subsect: Transforms with Slow Primed Frame Velocity}

If we have the primed frame velocity much smaller than the speed of light, ($v \ll c$), then we have ${v}/{c}\approx 0$ and therefore $\gamma \approx 1$.
Hence we get back the previous classical transform equations

\begin{equation}
	{t{'}} \approx t
\end{equation}

\begin{equation}
	z{'} \approx {z}-{v}{t}
\end{equation}

which is the expected result, as it agrees with the everyday observations we are used to seeing at these speeds.
That is, no noticeable difference in times on clocks or lengths of moving objects.
We can see when the $\gamma$-factor's influence starts to become significant from Figure (\ref{fig: Gamma Factor}).

%█████████████
\begin{figure}[H]
	\centering
	\tikzsetnextfilename{Gamma_Factor}
	\begin{tikzpicture}
		\begin{axis}[
				domain=0:0.99,
				samples=100,
				xlabel={$v/c$},
				ylabel={${\gamma}$},
				grid=major,
				grid style={dashed, gray!30},
				axis lines=middle,
				xmin=0, xmax=1.01,
				ymin=0, ymax=7.1,
				enlargelimits=false,
				xlabel near ticks,
				ylabel near ticks,
				x axis line style={-},
				y axis line style={-},
				xlabel style={anchor=west},
				ylabel style={anchor=south},
				tick label style={font=\small},
				width=10cm, % Set the width to take more space
				height=7cm, % Set the height to a smaller value to stretch the x-axis
				xtick={0,0.2,...,1},
				extra x ticks={0},
				extra x tick style={grid=none},
				ytick={0,1,...,7}, % Set y-axis ticks every 1 unit
			]
			\addplot[thick] {1/sqrt(1-x^2)};
		\end{axis}
	\end{tikzpicture}
	\caption{$\boldsymbol{\gamma}$\textbf{-factor.} A diagram, showing the magnitude of $\gamma$ with increasing ratio of primed frame's speed to the speed of light, with ${\gamma}$ tending to infinity as ${v}/{c}\rightarrow 1$.}
	\label{fig: Gamma Factor}
\end{figure}
%███████████

As can be seen, it is not until around when the primed frame velocity is a third of the speed of light, that it significantly differs from being equal to 1.
This is a speed unattainable to us, the only thing we can bring up close to this speed is particles, and nothing humanmade is even a 1000th the speed of light.

%███████████████████████████████████████████████████████████████████
\subsection{Space and Time Intervals} \label{subsect: Space and Time Intervals}

To get the velocity transform equations we will first need the equations to transform the displacement between two positions and the interval between times, then take them in the limit as the changes go to zero.
That is, when we have infinitesimal changes of coordinates.
If we want to know how the displacement between two coordinates ${\vec{R}_1} = (x_1,y_1,z_1)$ and ${\vec{R}_2} = (x_2,y_2,z_2)$ transforms, we can take the difference of the transforms of both the coordinates as follows

\begin{equation}
	\begin{aligned}
		 & {x{'}}_2-{x{'}}_1 = x_2-x_1                                                                                         \\
		 & {y{'}}_2-{y{'}}_1 = y_2-y_1                                                                                         \\
		 & z{'}_2-z{'}_1 = {\gamma} ( z_2- {v} {t}_2)-{\gamma} ( z_1- {v} {t}_1)                                               \\
		 & {t{'}}_2-t{'}_1 = {\gamma} \bigg( {t}_2-\frac{v}{{c}^2} z_2 \bigg)-{\gamma} \bigg( {t}_1-\frac{v}{{c}^2} z_1 \bigg)
	\end{aligned}
\end{equation}

rearranging and replacing the difference of the first and second of each coordinate with ${\Delta}{\vec{R}} = ({\Delta}x,{\Delta}y,{\Delta}z) = (x_2-x_1,y_2-y_1,z_2-z_1)$, giving the displacement transform as

\begin{equation}
	\label{eq: interval of Coordinates}
	\begin{aligned}
		 & \Delta x{'} = {\Delta x}                                                   \\
		 & \Delta {y{'}} = {\Delta y}                                                 \\
		 & \Delta {z{'}} = {\gamma} ( {\Delta z}- {v} \Delta t)                       \\
		 & {\Delta t{'}} = {\gamma} \bigg( \Delta t-\frac{v}{{c}^2} {\Delta z} \bigg)
	\end{aligned}
\end{equation}

This is the same form as the original coordinate transform equations.

From these equations, we can also get the differential quantities when we take infinitesimal changes, which give the same form again, as

\begin{equation}
	\label{eq: Infintesmal interval of Coordinates}
	\begin{aligned}
		 & {dx{'}} = {dx}                                        \\
		 & {dy{'}} = {dy}                                        \\
		 & {dz{'}} = {\gamma} (dz- {v}dt)                        \\
		 & {dt{'}} = {\gamma} \bigg(dt-\frac{v}{{c}^2} dz \bigg)
	\end{aligned}
\end{equation}

So when we make an infinitesimally small change in position and/or time within a frame, we know what the corresponding change is in a primed frame, we will use these to get the velocity transform equations.
As velocity at any instance is the infinitesimal change in position per infinitesimal change in time.
These will also be used later to find, invariant quantities, quantities that remain the same in each frame.
For example, the space-time interval and the energy-momentum relationship in Chapter (\ref{ch: Invariant Quantities}).

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Velocity} \label{sect: Velocity}

The velocity at any instant is the infinitesimal change in position over the infinitesimal change in time $\frac{d\vec{R}}{dt}$.
So using the infinitesimals from Equation \eqref{eq: Infintesmal interval of Coordinates}, we get the velocity in each direction as

\begin{equation}
	\begin{aligned}
		 & {{u}_{x}}^{'} = \frac{dx{'}}{dt{'}} = \frac{dx}{{\gamma} \bigg(dt-\frac{vdz}{{c}^2}\bigg) }                    \\
		 & {{u}_{y}}^{'} = \frac{dy{'}}{dt{'}} = \frac{dy}{{\gamma} \bigg(dt-\frac{vdz}{{c}^2}\bigg) }                    \\
		 & {{u}_{z}}^{'} = \frac{dz{'}}{dt{'}} = \frac{{\gamma} (dz - {v}dt)}{{\gamma} \bigg(dt-\frac{vdz}{{c}^2}\bigg) }
	\end{aligned}
\end{equation}

now dividing the top and bottom of the fraction on the right hand side by ${dt}$ we can give the equations in their vector form as

\begin{equation}
	\mhl{
		\begin{aligned}
			 & \mathbf{u}{'} = \dfrac{1}{{\gamma}\left(1-\dfrac{v}{{c}^2} {{u}_{z}}\right) }
			\begin{pmatrix}
				{{u}_{x}}                              \\
				{{u}_{y}}                              \\
				{\gamma} \left( {{u}_{z}}- {v} \right) \\
			\end{pmatrix}
			\\
			 & \text{at position ${\mathbf{r}{'}}$ and time ${t{'}}$ }
		\end{aligned}
	}
	\label{eq: velocity transform}
\end{equation}

This is used to find the velocity of anything in another frame at the corresponding primed position and time.
We will put this equation to work in a later section when we look at how the light emitted from a source particle has its velocity direction changed/aberrated and the effect this has on its intensity in all directions. Next, we will use this to get the acceleration transform.

\textbf{Side note:}

For those interested; The generalized velocity \hyperlink{def-transform}{transform} (which we will not derive here) for a frame velocity in any direction and not just the z-direction is

\begin{equation}
	\mathbf{u}{'} = \dfrac{1}{{\gamma}} \dfrac{\mathbf{u} + \Big[\dfrac{{\gamma}-1}{\|\mathbf{v}\|^2}(\mathbf{u}\cdot \mathbf{v})-{\gamma} \Big] \mathbf{v}}{1-\dfrac{\mathbf{u}\cdot\mathbf{v}}{{c}^2}}
\end{equation}

with ${\mathbf{v}}$ being the frame's velocity in any generalized direction.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Acceleration} \label{sect: Acceleration}

To find how the acceleration (known as the 3-acceleration) of a particle transforms for \hyperlink{def-observer}{observer}s in two different frames, we take the differential of the velocity \hyperlink{def-transform}{transform} in equation \eqref{eq: velocity transform} and use the differentiation rules for two generic functions ${f}$ and ${g}$: ${d(gf)} = {f} {dg} + {g} {df}$, and ${d[{{f}({g}(x))}]} = {{dg}(x)} * {df({{g}(x)})}$

\begin{equation}
	\begin{aligned}
		d\mathbf{u}{'} &\color{gray} = \dfrac{1}{{\gamma}\left(1-\dfrac{v}{{c}^2} {{u}_{z}}\right) }
		\begin{pmatrix}
			d{{u}_{x}}          \\
			d{{u}_{y}}          \\
			{\gamma} d{{u}_{z}} \\
		\end{pmatrix}
		+ \dfrac{{\gamma} \dfrac{v}{{c}^2} d{{u}_{z}}}{{\gamma}^2\left(1-\dfrac{v}{{c}^2} {{u}_{z}}\right)^2 }
		\begin{pmatrix}
			{{u}_{x}}                              \\
			{{u}_{y}}                              \\
			{\gamma} \left( {{u}_{z}}- {v} \right) \\
		\end{pmatrix} \\
		               &\color{gray} = ...
		\\
		               & = \dfrac{1}{{\gamma}\left(1-\dfrac{v}{{c}^2} {{u}_{z}}\right)^2 }
		\begin{pmatrix}
			d{{u}_{x}} + \frac{v}{{c}^2}( {{u}_{x}} d{{u}_{z}}-{{u}_{z}} d{{u}_{x}}) \\
			d{{u}_{y}} + \frac{v}{{c}^2}( {{u}_{y}} d{{u}_{z}}-{{u}_{z}} d{{u}_{y}}) \\
			\frac{1}{{\gamma}} d{{u}_{z}}                                            \\
		\end{pmatrix}
	\end{aligned}
\end{equation}

Now, divide by ${dt{'}}$ as we did for the velocity in the previous section, and we get the acceleration transform as

\begin{equation}
	\mhl{
		\begin{aligned}
			&\mathbf{a}{'} = \dfrac{1}{{\gamma}^2\left(1-\dfrac{v}{{c}^2} {{u}_{z}}\right)^3 }
			\begin{pmatrix}
				{{a}_{x}} + \frac{v}{{c}^2}({{u}_{x}} {{a}_{z}}-{{u}_{z}} {{a}_{x}}) \\
				{{a}_{y}} + \frac{v}{{c}^2}({{u}_{y}} {{a}_{z}}-{{u}_{z}} {{a}_{y}}) \\
				\frac{1}{{\gamma}} {{a}_{z}}                                         \\
			\end{pmatrix}
			\\
			&\text{at position ${\mathbf{r}{'}}$ and time ${t{'}}$ }
		\end{aligned}
	}
	\label{eq: acceleration transform}
\end{equation}

So if we know how a particle accelerates in one frame we will know its corresponding acceleration in another frame at the corresponding primed time and position.

\textbf{Side note:}

Again for those interested; The generalized acceleration \hyperlink{def-transform}{transform} (which we will not derive here) for a frame velocity in any direction and not just the z-direction is

\begin{equation}
	\mathbf{a{'}} = \frac{1}{{\gamma} ^3 \left(1-\frac{(\mathbf{u}\cdot \mathbf{v})}{{c}^2}\right)^3}\left[ {\gamma} \left(1-\frac{(\mathbf{u}\cdot\mathbf{v})}{{c}^2}\right)\mathbf{a} + \frac{{\gamma} (\mathbf{a}\cdot\mathbf{v})}{{c}^2}\mathbf{u} + (1-{\gamma} ) (\mathbf{a}\cdot\hat{\mathbf{v}}) \cdot\hat{\mathbf{v}}\right]
\end{equation}

at position ${\mathbf{r}{'}}$ and time ${t{'}}$

This is the 3-acceleration, not to be confused with the 4-acceleration that will be mentioned in a later chapter, which is a more abstract quantity.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Summary}

In this chapter, we derived the mathematics for the transformation of the spatial and time coordinates for classical relativity to help us, later, understand the derivation of special relativity.
We then introduced the assumptions, known as the postulates of special relativity, which we use to derive how time slows down due to time dilation, and how lengths of moving objects get smaller due to length contraction.
This introduced us to $\gamma$, which is a factor used throughout relativity to simplify equations.
From this we had the tools to derive the transformation equations, which in turn allowed us to calculate the velocity and acceleration transforms.

So we have learnt how to transform from one reference frame into another, in special relativity.
The outline of steps to transform a system of particles and their properties such as position, time, velcoity and accelerationa are as follows.
If you have a system of particles in an initial frame and you want to transform their positions to a new frame, you need to first define where this initial axis' origin is.
You are free to choose where it is.
The primed frame's axis will overlap with this initial frame's axis at your arbitrarily chosen starting time, that is when you define the time as ${t}=0$ (the time of the overlap is also ${t{'}}=0$ in the primed frame).
You can now transform the positions into the primed frame.
These particles have these primed frame positions at the calculated primed frame times, defined in Equations \eqref{eq: Lorentz transformation}.
To transform the velocities and acceleration of these particles at their primed frame positions at the corresponding primed times in the primed frame, you can use equations \eqref{eq: acceleration transform} and \eqref{eq: velocity transform}.

And this is all the steps that are needed, but an easy mistake to make is to forget that ${t}$ and ${t{'}}$ are the times from the overlap of the frame origins, in their respective frames.

So, this chapter shows the foundations of special relativity, but there is still more to come.
Before we go further though, we will take a look at the delayed view of the world an observer sees, due to the delay in light from their surrounding.
This will help us understand why we need the time transformation to be the way it is.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\input{Tex/Terms/Terms_ch2.tex}

%███████████████████████████████████████████████████████████████████
\printbibliography[segment=\therefsegment, heading=subbibliography]

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\chapter{Observers Delayed Worldview} \label{ch: Observers Delayed Worldview}

Light travels extremely fast compared to other everyday speeds we are used to, roughly at 300,000,000 meters per second.
In the blink of an eye, light could travel around the world twice.
So we do not need to normally worry about the delay in the light signal, as the time to propagate the distances in our everyday world is extremely short, so the signal can be approximated as being instantaneous, ignoring the more complex modeling of the delayed light signal.
But when it comes to particle physics or astronomy, we might be dealing with speeds close to that of light or huge distances.
For example, light has taken 152,000 years to travel from the Andromeda Galaxy, so we are currently seeing the Andromeda Galaxy where it was and how it looked 152,000 years ago.
These past positions that we currently see are called the delayed view/\hyperlink{def-retarded-position}{retarded} positions.
The topic in this chapter is not normally included in Special relativity texts, but it is needed to give you a more full story and understanding of relativity.
This comes with extra insights into the reason for why the coordinate transform equations have to be the way that they are.
As we will see when transforming retarded positions between frames.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Retarded Coordinates} \label{sect: Retarded Coordinates}

*** include an x-coordinate in the vectors

In an initial frame we have its own coordinates at rest.
If a light signal is emitted from a coordinate to an observer at the origin, it takes time to reach them, so the observer would see this stationary coordinate at the previous time that the light was emitted from this coordinate, this is the coordinate's retarded time.

%We will separate out the coordinate which we attach to the coordinate system and the position of the object which moves independently of the coordinate system, but which we describe relative to the coordinate system.

%█████████████
\begin{figure}[ht]
	\begin{subfigure}[b]{.49\textwidth}
		\tikzsetnextfilename{Tikz_Particles_position_in_rest_frame}
		\begin{tikzpicture}[scale = 5] %[,tdplot_main_coords]
			%\usetikzlibrary{arrows.meta}
			\draw[thick] (0,0) circle (0.025);
			\draw[black, thick,->] (0,0,0)--(0.4,0,0) node[anchor = north east]{${y}$};
			\draw[black, thick,->] (0,0,0)--(0,0.4,0) node[anchor = north east]{${z}$};
			\draw[black, thick,->] (0,0,0)--(0,0,0.55) node[anchor = south east] {${x}$};
			\draw[gray,dashed, thick,->] (0,0,0)--(0.2,0,0) node[anchor = north east]{${y{'}}$};
			\draw[gray,dashed, thick,->] (0,0,0)--(0,0.2,0) node[anchor = north east]{${z{'}}$};
			\draw[gray,dashed, thick,->] (0,0,0)--(0,0,0.35) node[anchor = south] {${x{'}}$};
			\draw[gray, thick,,->>] (-0.15,0,0)--(-0.15,0.1,0) node[anchor = north east]{${v}$};
			\draw[->] (0,0.25/2,0) to[bend left = 45] (0.19/2,0.18/2,0);
			\node at (0.08,0.17,0) {${\theta_{ret}}$};
			\draw[red, thick, dotted,<-] (0.02,0.02,0)--(0.47,0.46,0); % Reduced by 0.02
			\fill[blue] (0.49,0.48,0) circle (0.4pt);
			\node[blue] at (0.67,0.48,0) {\text{ ${\mathbf{r}_{ret}}$}}; % Reduced by 0.02
			\draw[gray,dashed] (0.49,0.48,0)--(0.49,0.65,0); % Reduced by 0.02
			\draw[red,->] (0.49,0.58,0) arc (90:-135:0.1);
			\node[red] at (0.54,0.47,0) {${\alpha} $};
		\end{tikzpicture}
		\caption{Source and \hyperlink{def-observer}{observer}'s \hyperlink{def-proper-frame}{rest frame}}
		% \label{fig:sub1}
	\end{subfigure}
	\begin{subfigure}[b]{.49\textwidth}
		\tikzsetnextfilename{Tikz_Particles_position_in_primed_frame_with_delayed_position}
		\begin{tikzpicture}[scale = 5] %[,tdplot_main_coords]
			%\usetikzlibrary{arrows.meta}
			\draw[thick] (0,0) circle (0.025);
			\draw[gray,	thick, dashed] (0,0.7,0) circle (0.03);
			\draw[blue,thick,dotted,->] (0.47,0.9,0)--(0.47,0.22,0); %node[midway,left]{\textcolor{black}{ $\mathbf{P}{'}$}}; %$\mathbf{P}{'}$}}; % Reduced by 0.02
			\draw[gray,dashed, thick,->] (0,0.7,0)--(0.2,0.7,0) node[anchor = north east]{${y}$};
			\draw[gray,dashed, thick,->] (0,0.7,0)--(0,0.9,0) node[anchor = north east]{${z}$};
			\draw[gray,dashed, thick,->] (0,0.7,0)--(0,0.7,0.35) node[anchor = south] {${x}$};
			\draw[gray,dashed, thick,->] (0,0,0)--(0.2,0,0) node[anchor = north east]{${y}$};
			\draw[gray,dashed, thick,->] (0,0,0)--(0,0.2,0) node[anchor = north east]{${z}$};
			\draw[gray,dashed, thick,->] (0,0,0)--(0,0,0.35) node[anchor = south] {${x}$};
			\draw[thick,->] (0,0,0)--(0.4,0,0) node[anchor = north east]{${y{'}}$}; % Reduced by 0.02
			\draw[thick,->] (0,0,0)--(0,0.4,0) node[anchor = north east]{${z{'}}$};
			\draw[thick,->] (0,0,0)--(0,0,0.55) node[anchor = south east] {${x{'}}$};
			%\draw[gray,->] (0,0.25,0) to[bend left = 40] (0.15,0.2,0);
			\draw[red, thick, dotted,<-] (0.02,0.02,0)--(0.45,0.88,0); % Reduced by 0.02
			\draw[gray, thick, dotted,->] (0,0.7,0)--(0,0.02,0);
			\fill[gray] (0.47,0.9,0) circle (0.4pt); % Reduced by 0.02
			\fill[blue] (0.47,0.2,0) circle (0.4pt) node[right] {\text{ ${\mathbf{r}_{{t{'}} = 0}^{'}}$}}; % Reduced by 0.02
			\draw[gray, thick,->>] (0,0.58,0)--(0,0.49,0) node[midway,right]{$-{v}$};
			\draw[blue, thick,->>] (0.47,0.58,0)--(0.47,0.49,0) node[midway,right]{$-{v}$}; % Reduced by 0.02
			\draw[gray,dashed] (0.47,0.9,0)--(0.47,1.07,0); % Reduced by 0.02
			\draw[red,->] (0.47,1,0) arc (90:-120:0.1); % Reduced by 0.02
			\node[red] at (0.52,0.91,0) {${\alpha^{'}}$}; % Reduced by 0.02
			\draw[->] (0,0.23,0) to[bend left = 25] (0.11,0.2,0);
			\node at (0.065,0.29,0) {${\theta_{ret}^{'}}$};
			\node[gray] at (0.67,0.91,0) {${\mathbf{r}_{ret}^{'}}$}; % Reduced by 0.02
		\end{tikzpicture}
		\caption{\hyperlink{def-Primed-Frame}{primed frame}}
		% \label{fig:sub2}
	\end{subfigure}
	\caption{\textbf{Retarded coordinates.} Diagrams of a source of light that represents, in the source's rest frame, the coordinate ${\mathbf{r}} = {\mathbf{r}_{ret}}$ (blue) emitting light (red) at an angle ${\alpha}$ and ${\alpha^{'}}$ respectively towards the origin, which is received by an \protect\hyperlink{def-observer}{observer} positioned at the origin at time ${t} = {t{'}} = 0$ with the \protect\hyperlink{def-observer}{observer} and source at rest in the first inertial frame (left) and then shown moving in a \protect\hyperlink{def-Primed-Frame}{primed frame} at speed $-{v}$ in the z-direction (right). in the primed frame, the past, retarded position of the rest frame and also the source's coordinate ${\mathbf{r}_{ret}^{'}}$ at its retarded time are shown in gray, with the source's current position ${\mathbf{r}_{{t{'}} = 0}^{'}}$ shown in blue. The path light takes is shown in red. The corresponding axis in each frame is also shown in black. The angle of the retarded position from the origin is ${\theta_{ret}}$ and ${\theta_{ret}^{'}}$ respectively.}
	\label{fig: Retarded field}
\end{figure}
%███████████

As shown in the diagram, if we take the \hyperlink{def-proper-frame}{rest frame} of an \hyperlink{def-observer}{observer} and a source that emits a pulse of light from its position at ${\mathbf{r}}$ so that it is received by the \hyperlink{def-observer}{observer} at the origin, at time ${t} = 0$.
The retarded time the pulse of light was emitted is

\begin{equation}
{{t}_{ret}} =-\frac{\|\mathbf{r}\|}{c},
\end{equation}

which is the negative of the time it took for light to propagate along ${\mathbf{r}}$ to the origin.
The velocity of the light that propagated to the origin is

\begin{equation}
	\mathbf{c} = {c}
	\begin{pmatrix}
		0            \\
		\sin{\alpha} \\
		\cos{\alpha} \\
	\end{pmatrix}
\end{equation}

Were ${\alpha}$ is the direction of propagation.
This and the retarded time (which is negative) gives the retarded position the light was emitted from as

\begin{equation}
	\mathbf{r}_{ret} = -\|\mathbf{r}\|\hat{c} ={c}{{{t}_{ret}}}
	\begin{pmatrix}
		0            \\
		\sin{\alpha} \\
		\cos{\alpha} \\
	\end{pmatrix}
\end{equation}

The source's position and retarded position are the same in the rest frame as the source is not moving.
Also, the position vector and light's velocity vector are in opposite directions, The emitted time being negative flips the direction of the velocity vector here.
Now inputting this retarded position and time into the coordinate transform we get the retarded position and time in the primed frame as

\begin{equation}
	\begin{aligned}
		\mathbf{r}_{ret}^{'}     & = {c}{{t}_{ret}}
		\begin{pmatrix}
			0                                                \\
			\sin{\alpha}                                     \\
			{\gamma} \left( \cos{\alpha}-\frac{v}{c} \right) \\
		\end{pmatrix}
		=
		\begin{pmatrix}
			0                                             \\
			{y}                                           \\
			{\gamma} \left( {z}-{v} {{{t}_{ret}}} \right) \\
		\end{pmatrix}
		\\
		\text{at retarded time } &
		\\ {{t}_{ret}^{'}} & = {\gamma} \left(1-\frac{v}{c} \cos{\alpha} \right) {{{t}_{ret}}}
	\end{aligned}
\end{equation}

If instead we use the angle of the retarded coordinate from the z-axis, $\theta_{ret} = \alpha - \pi$, we have that $\cos{\alpha}=\cos{(\theta_{ret}+\pi)}=-\cos{\theta_{ret}}$ and therefor the retarded time can be given as

\begin{equation}
	\\ {{t}_{ret}^{'}} = {\gamma} \left(1 + \frac{v}{c} \cos{\theta_{ret}} \right) {{{t}_{ret}}}
\end{equation}

With the light being received at the origin of the \hyperlink{def-Primed-Frame}{primed frame} axis at time ${t{'}} = 0$.

The coordinate transform here for retarded coordinates is the normal coordinate transform, except the time transform simplifies and allows us to take the retarded time out of brackets with just the factor $\text{\AA}={\gamma} \left(1-\frac{v}{c} \cos{\alpha} \right) = {\gamma} \left(1 + \frac{v}{c} \cos{\theta_{ret}} \right)$ now in front of it.
This factor will also come up in the Doppler effect, in aberration and when finding the density of light from a source that is emitting it continuously in all directions.
We can use this factor to simplify equations like we did with $\gamma$ previously.
We will call $\text{\AA}$ the aberrational factor, but it is also referred to as the relativistic Doppler factor.

When swapping to the primed frame, the angle that the light is being emitted and the angle it is being received at has changed, this is called the relativistic aberration of light.
This aberration will be described fully in the next chapter.

\textbf{Side Note:}

This retarded position of the source is at its retarded time.
If you wanted to find the position of where the source is at the same time as the observer, $t'=0$, we need to propagate this from its retarded position and time, to this time of zero.
So we need to take into account that the source is moving at $u = -v$ and the retarded time is the negative of the time that we want to pass, for the source to move to its current position.
These negatives cancel out.
This gives the current position, with a bit of working out, as

\begin{equation}
	\label{eq: primed position with synced times}
	\mathbf{r}_{{t{'}} = 0}^{'} = \mathbf{r}_{ret}^{'} + \mathbf{v}t_{ret}^{'} = {c}{{t}_{ret}}
	\begin{pmatrix}
		0                               \\
		\sin{\alpha}                    \\
		\frac{1}{{\gamma}} \cos{\alpha} \\
	\end{pmatrix}
\end{equation}

So for a stationary source in the rest frame at $t=0$, we have this position in the primed frame at $t'=0$.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{The Transformed Retarded Coordinates} \label{sect: Delayed View of Transformed Coordinates}

If we treat the coordinates of a coordinate system as retarded sources of light in the same way as we did for the source in the previous section, we can transform these retarded coordinates of the initial frame into the primed frame
This is shown in the figure below for a small subset of coordinates, to give you an idea of how the initial frame's retarded coordinates are spread in the primed frame.

%█████████████
\begin{figure}[H]
	\centering
	\begin{subfigure}{0.45\textwidth}
		\centering
		\includegraphics[height=5cm]{images/pdf/coord_transform_initial_with_retarded_time.pdf}
		\caption{Initial frame (${t_{ret}}$)}
		\label{fig: retarded coordinate transform subfig_1}
	\end{subfigure}
	\begin{subfigure}{0.45\textwidth}
		\centering
		\includegraphics[height=5cm]{images/pdf/coord_transform_primed_retarded.pdf}
		\caption{primed frame (${t_{ret}^{'}}$)}
		\label{fig: retarded coordinate transform subfig_2}
	\end{subfigure}
	\caption{\textbf{Retarded coordinate transform.} A diagram, showing an initial small grid of points, representing some position coordinates that are at rest in their proper frame (left), with an \protect\hyperlink{def-observer}{observer} at the origin, using the retarded time ${t_{ret}} = \frac{\|\mathbf{r}\|}{c}$ for these coordinates, we can transform these to their retarded positions in a primed frame using the coordinate transform, with the original frames coordinates now moving at velocity $-{v} =-0.9$, the initial frames coordinates are transformed to where they would be seen to be at by an \protect\hyperlink{def-observer}{observer} at the origin with the \protect\hyperlink{def-observer}{observer}s time ${t{'}} = 0$, these positions are due to the delay in the light from these points taking time to get to the origin, they are also known as the \protect\hyperlink{def-retarded-position}{retarded position}s.}
	\label{fig: retarded coordinate transform}
\end{figure}
%███████████

The density of these  initials frame's retarded coordinates in its own frame is constant everywhere, but in the primed frame, these initial frames coordinates have a density that depends on the angle $\alpha'$, as shown in the figure below.
This figure is shown but not derived, as this requires mathematics from later in section (\ref{sect: Intensity of Light per differential solid angle from a Point Source}).

%█████████████
\begin{figure}[H]
	\centering
	\includegraphics[height=5cm]{images/pdf/coord_transform_Retarded_Coordinate_Density_Transform.pdf}
	\caption{\textbf{Density of initial frame's retarded coordinates in primed frame}. This shows the density of the initial frames coordinates when they are in their retarded positions in the primed frame, with $v=0.9$, with the colour scale showing the density.}
	\label{fig: Density of initial frame's retarded coordinates in primed frame}
\end{figure}
%███████████

If we are at rest in the initial frame and we see the points as they are shown the initial frame in figure (\ref{fig: retarded coordinate transform subfig_1}), then if there was another observer overlapping with us moving at $\mathbf{v}$ then they would see all the points distributed as they are shown in their primed frame in figure (\ref{fig: retarded coordinate transform subfig_2}).

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Perceived Velocity} \label{sect: Perceived Velocity}

From the previous section we have seen that objects are perceived to be at their retarded positions, That would also mean that we also have that the rate of change of the perceived positions being different to their actual rate of change.
That is, the perceived velocity of an object is different from its actual velocity.
This was demonstrated in section (\ref{subsect: Perceived vs Actual Speed}), where we have seen that objects can be perceived to be going faster than light even if they are not actually doing so.
Here we will show how to find the perceived velocity of objects.

If we have a moving particle positioned at $\mathbf{r}$, then in a infinitesimal time ${dt}$ it will move

\begin{equation}
	d\mathbf{r}= \mathbf{u} {dt}
\end{equation}

to position $\mathbf{r} + d\mathbf{r}$, as shown in the diagram

%█████████████
\begin{figure}[H]
	\centering
	\tikzsetnextfilename{Tikz_Perceived_Velocity}
	\begin{tikzpicture}[scale = 5]
		\draw[black, thick,->] (0,0,0)--(0.4,0,0)  node[anchor = north east] {${y}$};
		\draw[black, thick,->] (0,0,0)--(0,0.4,0)  node[anchor = north east] {${z}$};
		\draw[black, thick,->] (0,0,0)--(0,0,0.55) node[anchor = south east] {${x}$};
		\draw[red, thick, dotted,<-] (0,0,0)--(0.4,0.4,0);
		\draw[red, thick, dotted,<-] (0,0,0)--(0.5,0.3,0);
		\draw[blue, thick,->] (0.4,0.4,0)--(0.49,0.31,0);
		\fill[blue] (0.4,0.4,0) circle (0.4pt) node[anchor = south] {\text{ ${\mathbf{r}}$}};
		\fill[blue] (0.5,0.3,0) circle (0.4pt) node[anchor = west] {\text{ ${\mathbf{r}} + {\mathbf{dr}}$}};
	\end{tikzpicture}
	\caption{\textbf{Perceived velocity.} Diagram showing a particle (blue) moving from $\mathbf{r}$ by displacement of $d\mathbf{r}=\mathbf{u}dt$ with the paths that light (red) has to travel to get to the origin from both these positions. Leading to a different retarded time between the positions than the actual time between them. As, there is the actual time between these positions, but, due to the particle moving to a different position, the light may also have to travel a different distance, which also introduces an additional time difference. This gives a different perceived velocity to the actual velocity.}
	\label{fig: Perceived velocity}
\end{figure}
%███████████

The difference between the retarded times of light from each position reaching the origin is the time that light takes to get from position  $\mathbf{r} + d\mathbf{r}$ minus the time it takes to get from position $\mathbf{r}$, plus the time it takes for the particle to move to the new position $dt$. Which is


\begin{equation}
	dt_{ret} =   \frac{\|\mathbf{r} + d\mathbf{r}\|}{c} -  \frac{\|\mathbf{r}\|}{c} + dt
\end{equation}

since $d\mathbf{r}$ is infinitesmally small we can simplify this expression by using some approximations as shown in the following

\begin{equation}
	\begin{aligned}
		\|\mathbf{r} + d\mathbf{r}\| &\color{gray} =  \sqrt{(\mathbf{r} + d\mathbf{r}) \cdot (\mathbf{r} + d\mathbf{r})}                                                                         \\
		                             &\color{gray} = \sqrt{\mathbf{r} \cdot \mathbf{r} + 2 \mathbf{r} \cdot d\mathbf{r} + d\mathbf{r} \cdot d\mathbf{r}}                                         \\
		                             &\color{gray} \approx \sqrt{\mathbf{r} \cdot \mathbf{r} + 2 \mathbf{r} \cdot d\mathbf{r}}                                                                   \\
		                             &\color{gray} = \|\mathbf{r}\| \sqrt{ 1 + \frac{2 \mathbf{r} \cdot d\mathbf{r}}{\mathbf{r} \cdot \mathbf{r}}}                                               \\
		                             &\color{gray} \text{using the Taylor expansion $\sqrt{1 + x} \approx 1 + \frac{x}{2} \text{ for } x \ll 1$:}                                                     \\
		                             &\color{gray} \approx \|\mathbf{r}\| \left(1 + \frac{\mathbf{r} \cdot d\mathbf{r}}{\|\mathbf{r}\| }\right) \\
									 & \approx \|\mathbf{r}\|  + \mathbf{r} \cdot d\mathbf{r}
	\end{aligned}
\end{equation}

so for infinitesimal changes $\|\mathbf{r} + d\mathbf{r}\|= \|\mathbf{r}\|  + \mathbf{r} \cdot d\mathbf{r}$, we have the perceived time between these events at the origin as

\begin{equation}
	\begin{aligned}
		dt_{ret} &\color{gray} =   dt + \frac{\mathbf{r} \cdot d\mathbf{r}}{ c}               \\
		         &\color{gray} = dt + \frac{\mathbf{r} \cdot \mathbf{u} dt}{ c}                 \\
		         & = \left( 1 + \frac{ \mathbf{u} \cdot \mathbf{r} }{ c} \right) dt
	\end{aligned}
\end{equation}

The distances between the points is the same to the observer as the true distance between them, it is just the perceived times that are different.
Therefore, we can get the perceived/retarded velocity as

\begin{equation}
	\mathbf{u}_{ret} = \frac{d\mathbf{r}}{dt_{ret}} = \frac{d\mathbf{r}}{ \left( 1 + \frac{ \mathbf{u} \cdot \mathbf{r} }{ c} \right) dt } = \frac{\mathbf{u}}{ 1 + \frac{ \mathbf{u} \cdot \mathbf{r} }{ c} }
\end{equation}

This equation shows that the perceived velocity can be much smaller or larger depending on which direction the object is moving and the distance it is from you.

This section is to just highlight an interesting concept, that needs to be taken into account when making some experimental observations.

% %███████████████████████████████████████████████████████████████████
% \subsubsection{Delayed Coordinate Distribution and Density}

% need to find the function for differential dz

% \begin{equation}
% 	\begin{aligned}
% 		 & \frac{dx}{{dx{'}}} = 1 \\
% 		 & \frac{dy}{dy{'}} = 1 \\
% 		 & \frac{dz}{{dz{'}}} =
% 	\end{aligned}
% \end{equation}

% *** todo: wanna get the relative delayed view proper coordinate density in the primed frame, there should also be a rotational aspect to it due to the non-uniform distribution of delayed proper coordinates

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Summary}

In this chapter we introduced retarded positions which are the positions an observer perceives objects to be at due to the delay in the light signal from the object to the observer, with their associated retarded time, which is the time light takes to travel from the retarded position to the observer.
We also derived how to transform these retarded coordinates to the prime frames retarded coordinates.
The retarded coordinate transform and also the density of the transformed initial frames retarded coordinates in the primed frame were shown in figure (\ref{fig: retarded coordinate transform}) and figure (\ref{fig: Density of initial frame's retarded coordinates in primed frame}) respectively.
We then derived the retarded velocity of objects, which is the velocity that an observer perceives an object to be moving at, that is consequence of the delay in the light signal.
You could go one step further and find the retarded acceleration if you wanted to, but we will leave that for now.
This differs to the actual speed the object is moving.
What we have learned here will be used later when transforming light pulses later.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\input{Tex/Terms/Terms_ch3.tex}

%███████████████████████████████████████████████████████████████████
\printbibliography[segment=\therefsegment, heading=subbibliography]

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\chapter{A Point Source: Emitting a Pulse of Light} \label{ch: A Point Source Emitting a Pulse of Light}

If light pulse is emitted from a resting point source in all directions, in a reference frame, how will this be effected when swapping to a frame where the source is now moving.
This will be the topic of this chapter.
We will look at the velocity transform specifically for the speed of light, which will be used throughout this chapter, starting with the Doppler effect on the frequency of light that a source emits.
Next we will get to relativistic aberration, which is how, the angle that the emitted light is propagated at, is effected.
The combined effects of these together is called relativistic beaming.
Knowing this allows us to transform a field of continuous pulses of light from a source in the next chapter.
We will start with looking at the mathematics of spherical polar coordinates which will allow us to look at all of this.
The topics of relativistic aberration and beaming are not topics that are touched upon in most special relativity sources, but they are interesting and hold some important insights, that you will hopefully appreciate.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Spherical Polar Coordinates}\label{sec: Spherical Polar Coordinates}

Before we go any further with special relativity, we will need to take some time making sure we know the math needed for what comes next.
This section will be about spherical polar coordinates, which will help us describe how the propagation of light changes between frames, by allowing us to explain aberration, which is how the propagation angle changes between frames, and the Doppler effect, which is how the wave length of light changes between frames.
So let us start with how to describe a vector in terms of the Spherical Polar Coordinates, which is shown in the following figure in red:

*** This is how far aran has got doing some checks to see if ive messed up anything

%█████████████
\begin{figure}[H]
	\centering
	\tdplotsetmaincoords{60}{110}
	\tikzsetnextfilename{Tikz_Spherical_Polar_Coordinates}
	\begin{tikzpicture}[scale = 3,tdplot_main_coords]
		% variables
		\def\rvec{.8}
		\def\thetavec{30}
		\def\phivec{65}
		% axes
		\coordinate (O) at (0,0,0);
		\draw[thick,->] (O)--(1,0,0) node[anchor = north east]{${x}$};
		\draw[thick,->] (O)--(0,0.92,0) node[anchor = north west]{${y}$};
		\draw[thick,->] (O)--(0,0,1) node[anchor = south]{${z}$};
		% vectors
		\tdplotsetcoord{P}{\rvec}{\thetavec}{\phivec}
		\draw[dashed] (O)--(Pxy);
		\draw[dashed] (P)--(Pxy);
		\draw[dashed] (Py)--(Pxy);
		\draw[-stealth,thick, red] (O)--(P) node[above right] {$\mathbf{r}$} node[black, midway, above] {$r$};
		% arcs
		\tdplotdrawarc[->]{(O)}{0.2}{0}{\phivec}{anchor = north}{$\phi$}
		\tdplotsetthetaplanecoords{\phivec}
		\tdplotdrawarc[->,tdplot_rotated_coords]{(0,0,0)}{0.3}{0}{\thetavec}{}{}
		\node at (0,0.038,0.17) {$\theta$};
		% sphere
		\shadedraw[tdplot_screen_coords,ball color = gray, opacity = 0.3] (0,0) circle (\rvec);
		\draw[fill = gray,opacity = 0.3] (0,0) circle (\rvec);
	\end{tikzpicture}
	\caption{\textbf{Spherical polar coordinates.} Diagram of an $x,y,z$-axis showing a position vector $\mathbf{r}$ (red) with its associated spherical polar coordinates $(r,\theta,\phi)$, where $\theta$ is the angle from the $z$-axis, $\phi$ is the angle rotated around $z$-axis starting from the $x$-axis, and $r$ is the magnitude .}
\end{figure}
%███████████

As the figure shows, for a given position $\mathbf{r}$ we have the Cartesian coordinates $({x},{y},{z})$, but we can also write this position in terms of spherical polar coordinates $(r,\theta,\phi)$.
Where the angles from the Z-Axis and X-axis are $\theta$ (between 0 and $\pi$) and $\phi$ (between 0 and $2\pi$) respectively, and ${r}$ is the displacement to the position from the origin.

The position can be written using either coordinate system as follows

\begin{equation}
	\mhl{
		\mathbf{r} =
		\begin{pmatrix}
			x \\
			y \\
			z \\
		\end{pmatrix}
		= r
		\begin{pmatrix}
			\cos{\phi}\sin{\theta} \\
			\sin{\phi}\sin{\theta} \\
			\cos{\theta}           \\
		\end{pmatrix}
	}
\end{equation}

with

\begin{equation}
	\begin{aligned}
		r = \|\mathbf{r}\| & =\sqrt{x^2 + y^2 + z^2}      \\
		\cos\theta         & = \frac{z}{r}                \\
		\cos\phi           & = \frac{x}{\sqrt{x^2 + y^2}}
	\end{aligned}
\end{equation}

% Some useful formulae for later are the unit vectors

% \begin{equation}
% 	\mathbf{\hat{\text{${r}$}}} =
% 	\begin{pmatrix}
% 		\sin\theta \, \cos\phi \\
% 		\sin\theta \, \sin\phi \\
% 		\cos\theta             \\
% 	\end{pmatrix},
% 	\mathbf{\hat{\text{$\theta$}}} =
% 	\begin{pmatrix}
% 		\cos\theta \, \cos\phi \\
% 		\cos\theta \, \sin\phi \\
% 		-\sin\theta            \\
% 	\end{pmatrix},
% 	\mathbf{\hat{\text{$\phi$}}} =
% 	\begin{pmatrix}
% 		-\, \sin\phi             \\
% 		\hphantom{-} \, \cos\phi \\
% 		0                        \\
% 	\end{pmatrix}
% \end{equation}

% and the differentials with respect to each of the coordinates are

% \begin{equation}
% 	\begin{aligned}
% 		\frac{\partial\mathbf{r}}{\partial r}      & = \mathbf{\hat{\text{${r}$}}} \\
% 		\frac{\partial\mathbf{r}}{\partial \theta} & =
% 		\begin{pmatrix}
% 			r \cos\theta \cos\phi \\
% 			r \cos\theta \sin\phi \\
% 			-r \sin\theta         \\
% 		\end{pmatrix}
% 		= r\mathbf{\hat{\text{$\theta$}}}                                          \\
% 		\frac{\partial\mathbf{r}}{\partial \phi}   & =
% 		\begin{pmatrix}
% 			-r \sin\theta \sin\phi \\
% 			r \sin\theta \cos\phi  \\
% 			0
% 		\end{pmatrix}
% 		= r \sin\theta \mathbf{\hat{\text{$\phi$}}}
% 	\end{aligned}
% \end{equation}

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Light Velocity Transform} \label{sect: Light Velocity Transform}

The speed of light remains the same after transforming between frames, but the velocity does not, as the direction changes.
The velocity transformation in the case where the speed is that of light, $\|u\| = {c}$, with the direction in the initial frame at an angle $\alpha$ from the z-axis and $\varphi$ from the x-axis, so that the velocity of light in spherical polar coordinates is

\begin{equation}
	\mathbf{c} = {c} \cdot {\mathbf{\hat{c}}}= {c}
	\begin{pmatrix}
		\cos{\varphi}\sin{\alpha} \\
		\sin{\varphi}\sin{\alpha} \\
		\cos{\alpha}              \\
	\end{pmatrix},
\end{equation}

then from the velocity \hyperlink{def-transform}{transform} from equation \eqref{eq: velocity transform} we get the primed light's velocity as

% \begin{equation}
% \begin{aligned}
% & {{u}_{x}}{'} = \frac{c\sin\alpha\cos\varphi}{{\gamma} \bigg(1-\frac{v\cos\alpha}{c}\bigg) } \\ & {{u}_{y}}{'} = \frac{c\sin\alpha\sin\varphi}{{\gamma} \bigg(1-\frac{v\cos\alpha}{c}\bigg) } \\ & {{u}_{z}}{'} = \frac{c\cos\alpha- {v}}{ \bigg(1-\frac{v\cos\alpha}{c}\bigg) }
% \end{aligned}
% \end{equation}

\begin{equation}
	\label{eq: velocity transform for light}
	\mhl{
		\begin{aligned}
			 & \mathbf{c}{'} =
			c
			\begin{pmatrix}
				\cos\varphi\sin\alpha{'} \\
				\sin\varphi\sin\alpha{'} \\
				\cos\alpha{'}            \\
			\end{pmatrix}
			=
			\dfrac{c}{{\gamma}\left(1-\frac{v}{c} \cos\alpha\right) }
			\begin{pmatrix}
				\cos\varphi\sin\alpha                          \\
				\sin\varphi\sin\alpha                          \\
				{\gamma} \left( \cos\alpha-\frac{v}{c} \right) \\
			\end{pmatrix}
			\\
			 & \text{at position $\mathbf{r}{'}$ and time ${t{'}}$ }
		\end{aligned}
	}
\end{equation}

This still has the same speed of light, which can be shown by taking the magnitude of the velocity vector (that is the square root of the squares of all its elements).
However, the angle of propagation has been changed.

We will make use of the transformation of the cosine we can get from the z-component which gives

\begin{equation}
	\label{eq: cosine transform}
	\cos\alpha{'} = \dfrac{{\gamma} \left( \cos\alpha-\frac{v}{c} \right)}{{\gamma}\left(1-\frac{v}{c} \cos\alpha\right) }
\end{equation}

with its inverse achieved by swaping the primed and proper coordinates and taking the negative of the frames velocity, giving

\begin{equation}
	\label{eq: inverse cosine transform}
	\cos\alpha = \dfrac{{\gamma} \left( \cos\alpha{'} + \frac{v}{c} \right)}{{\gamma}\left(1 + \frac{v}{c} \cos\alpha{'}\right) }
\end{equation}

This equation shows how the angle of the emitted light changes, and will be needed in the next chapter.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Doppler Effect} \label{sect: Doppler Effect}

When we swap between frames there is also a change in light's wavelength, It is called the Doppler effect, which we will describe using the help of the following simple figure of light being emitted from a source in its rest frame and a frame that it is moving.

%█████████████
\begin{figure}[H]
	\begin{subfigure}{.49\textwidth}
		\centering
		\tikzsetnextfilename{Tikz_Lights_angle_with_particle_in_its_proper_frame}
		\begin{tikzpicture}[scale = 8]
			\draw[red,ultra thick,->] (0,0,0)--(0.235,-0.05,0) node[midway,anchor = north]{$\mathbf{c}$};
			\fill[black] (0,0,0) circle (0.7pt);
		\end{tikzpicture}
		\caption{Rest Frame}
		% \label{fig:sub2}
	\end{subfigure}
	\begin{subfigure}{.49\textwidth}
		\centering
		\tikzsetnextfilename{Tikz_Lights_angle_with_particle_With_particle_moving}
		\begin{tikzpicture}[scale = 8]
			\draw[-] (0,0.07,0) to[bend left = 45] (0.06,0.04,0);
			\node at (0.05,0.095,0) {$\alpha{'} $};
			\draw[cyan,ultra thick,->] (0,0,0)--(0.21,0.13,0) node[midway,anchor = north]{$\mathbf{c}{'}$};
			\draw[ultra thick,->] (0,0,0)--(0,0.15,0)node[midway,anchor = east]{$\mathbf{u}{'}$};
			\fill[black] (0,0,0) circle (0.7pt);
		\end{tikzpicture}
		\caption{Moving Frame}
		% \label{fig:sub1}
	\end{subfigure}
	\caption{\textbf{The Doppler effect.} Diagrams showing light being emitted by a source at velocity $\mathbf{c}$ in the source rest frame (left) and a frame were the source is now moving at velocity $\mathbf{u}{'}=-\mathbf{v}$ with the light now being emitted at an angle ${\alpha{'}}$ giving the light's velocity now as ${\mathbf{c}{'}}$. The different color of light in each frame is showing the effect on the lights frequency and hence color from the Doppler effect.}
	\label{fig: Doppler effect}
\end{figure}
%███████████

In the rest frame of the source, if it emits a wave at the speed of light in any direction, we have the length the wave has traveled from the source in the infinitesimal time ${d\tau}$ as being

\begin{equation}
	{d\lambda} = {c}{d\tau}
\end{equation}

If we change to a frame where the source is now moving at velocity ${\mathbf{u}{'}}$ in the z-direction and we have the wave now emitted at an angle $\alpha{'}$ from the z-axis, traveling a distance ${c}{dt{'}}$ in a time ${dt{'}}$, with the source moving a distance $ u{'} \cos\alpha{'} {dt{'}}$ in the direction of this emitted wave, this leads to a bunching up of the wave in the direction of the movement of the source, as the same amount of the wave has been emitted in this primed time, but the distance it has traveled from source is

\begin{equation}
	{d\lambda{'}} = {c}{dt{'}}-{u}{'} \cos\alpha{'} {dt{'}} = (1-\frac{u{'}}{c}\cos\alpha{'})cdt{'}
\end{equation}

we have ${dt{'}} = {\gamma} {d\tau}$, so the ratio of space the wave is taking up in that direction compared to in the \hyperlink{def-proper-frame}{rest frame} is

\begin{equation}
	Ratio = \frac{d\lambda{'}}{d\lambda} = {\gamma} \left(1-\dfrac{u{'}}{c} \cos\alpha{'} \right)
\end{equation}

since wavelength is inversely proportional to the frequency, and this bunching up at the front will proportionally decrease the wavelength, the frequency ratio $\nu{'}/\nu$ is then

\begin{equation}
	\label{eq: Doppler Effect}
	D_{r} = \frac{\nu{'}}{\nu} = \frac{d\lambda}{d\lambda{'}} = \frac{1}{ {\gamma} \left(1-\dfrac{u{'}}{c} \cos\alpha{'} \right)}
\end{equation}

This gives us a formula to find out how the frequency of a moving source's emitted light differs from when it is at rest.
This is used in astronomy to determine how fast stars and galaxies are moving relative to us on earth.

%*** can I find an experiment for the Doppler effect on frequency not just directly in forward or behind in the direction of movement, but at all angles. Ives–Stilwell experiment

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Aberration in Special Relativity} \label{sect: Aberration in Special Relativity}

A moving light source emits more of its radiation in the direction of its movement, and here we will show by how much.
If a source in its rest frame emits light evenly in all directions, then each emitted light's angle of propagation is transformed using equation \eqref{eq: velocity transform for light}.
So that the angles of the lights propagation from the z-axis can be found to be

\begin{equation}
	\label{eq: Cosine transform}
	\mhl{
		\cos\alpha{'} = \frac{\mathbf{c}_{z}^{'}}{\|\mathbf{c}{'}\|} = \dfrac{\cos\alpha - \dfrac{v}{c} }{1 - \dfrac{v}{c}\cos\alpha}.
	}
\end{equation}

with $v=- u{'}$

This is the relativistic aberration formula \cite{einstein1905electrodynamics}, it shows how the light's propagation direction transforms, shown in Figure (\ref{fig: aberrated emitted light}). To convert back we can use the inverse formula by either rearranging the equation, or simply swaping the primed and none primed notation and then taking negative of $v$ giving

\begin{equation}
	\label{eq: Cosine transform inverse}
		\cos\alpha = \dfrac{\cos\alpha{'} + \dfrac{v}{c} }{1 + \dfrac{v}{c}\cos\alpha{'}}.
\end{equation}

%█████████████
\begin{figure}[H]
	\begin{subfigure}{.49\textwidth}
		\centering
		\includegraphics[width = 5cm]{images/pdf/Aberrated_velocities_restframe.pdf}
		\caption{rest frame}
	\end{subfigure}
	\begin{subfigure}{.49\textwidth}
		\centering
		\includegraphics[width = 5cm]{images/pdf/Aberrated_velocities.pdf}
		\caption{primed frame}
	\end{subfigure}
	\caption{\textbf{Transforming emitted light.} Diagram showing the directions of propagation of an evenly distributed light pulse in the rest frame of a source (left) and the corresponding distribution of the light pulse's propagation directions in a primed frame in which the source is now moving (right), with the colors showing the Doppler effect on the light's frequency from the previous section.}
	\label{fig: aberrated emitted light}
\end{figure}
%███████████



If we want to see the opposite, when light is being absorbed, we can look at Figure (\ref{fig: aberrated absorbed light}) which shows what would happen in the case of incoming light from all directions.

%█████████████
\begin{figure}[H]
	\begin{subfigure}{.49\textwidth}
		\centering
		\includegraphics[width = 5cm]{images/pdf/Aberrated_velocities_inwards_restframe.pdf}
		\caption{rest frame}
	\end{subfigure}
	\begin{subfigure}{.49\textwidth}
		\centering
		\includegraphics[width = 5cm]{images/pdf/Aberrated_velocities_inwards.pdf}
		\caption{primed frame}
	\end{subfigure}
	\caption{\textbf{Transformeing absorbed light.} Diagram showing the directions of evenly distributed light being absorbed by a reciever in its rest frame (left) and the corresponding distribution of the light pulse's propagation directions in a primed frame in which the reciever is now moving (right), with the colors showing the Doppler effect on the light's frequency.}
	\label{fig: aberrated absorbed light}
\end{figure}
%███████████

It can be seen from equation \eqref{eq: Cosine transform} that as a source's speed tends to the speed of light, $u'/c$ tends to 1 and as a result, $\cos\alpha{'}$ tends to 1.
Hence all emitted or absorbed light in the source's rest frame tends to the direction of the source's movement.
But we also have to remember that the flow of time of the moving source relative to the primed frame, will become infinitly slow, coming to a stop at the speed of light.
That is, the act of emittance of the light stalls.
For both these reasons the light would remain in the vicinity of the source.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Relativistic Beaming} \label{sect: Relativistic Beaming}

Relativistic beaming is the combination of both of the two previous sections.
If we have a single pulse of light that is evenly spherically distributed, then after a certain time it will look like what is shown in the following figure, due to its aberrated emittion and Doppler effected frequency.

%█████████████
\begin{figure}[H]
	\begin{subfigure}{.32\textwidth}
		\centering
		\includegraphics[width = 3.8cm]{images/pdf/Rest_Pulse.pdf}
		\caption{Rest Frame \newline}
		\label{fig: Relativistic beaming 1}
	\end{subfigure}
	\begin{subfigure}{.32\textwidth}
		\centering
		\includegraphics[width = 3.8cm]{images/pdf/Prime_Pulse.pdf}
		\caption{Primed frame \newline}
		\label{fig: Relativistic beaming 2}
	\end{subfigure}
	\begin{subfigure}{.32\textwidth}
		\centering
		\includegraphics[width = 3.8cm]{images/pdf/Prime_Pulse_Simultaneous.pdf}
		\caption{Primed frame: synced times}
		\label{fig: Relativistic beaming 3}
	\end{subfigure}
	\caption{\textbf{Relativistic beaming.} Diagram showing, the position of an evenly spherically distributed light pulse after propagating for a certain amount of time, with its current time ${t}=0$, in the rest frame (left), it is also shown in the primed frame using the direct coordinate transform (middle) giving an ellipsoid with unsynchronised times, and also shown in the primed frame with each part of light pulse propagated forward or backwards to the origins time $t{'}=0$ (right). The black dot shows the current location of the source, with grey dot showing its position when the pulse was emitted. all the propagation of the light is in the directly away from this point.}
	\label{fig Relativistic beaming}
\end{figure}
%███████████

The pulse positions in the primed frame with their time synced with the origin are shown in figure (\ref{fig: Relativistic beaming 3}) and can be found from the transformed primed frame coordinates from figure (\ref{fig: Relativistic beaming 2}) by propagating the the light from these coordinates forward or backwards in time to be synced with the origins time of $t{'}=0$, that is

\begin{equation}
	\mathbf{l}{'} = \mathbf{r}{'} - \mathbf{c}{'} t{'}
\end{equation}

This can be extened to multiple pulses as we will do later in the next chapter.

% %███████████████████████████████████████████████████████████████████
% %███████████████████████████████████████████████████████████████████
% \section{Retarded Light Pulse Position Transform}\label{sect: Retarded Light Pulse Position Transform}

% *** what about math and diagram for the retarded time it takes light to get to R, i.e at $2T_p$ and the transform of this?

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Retarded Light Propagation in Source's Primed Frame} \label{subsect: Retarded Light Propagation}

There is a delay in the time light is emitted from a source and the time it reaches a reciever, so there is a difference in where you see moving objects compared to where they currently are due to this, and if the object is moving at velocity $\mathbf{u'}$ you see it in a previous position $\mathbf{u'} {T}'_{ret}$ due to this, this is called its retarded position where it was at the retarded time ${T}'_{ret}$.
The time the object and the light took to propagate from the objects retarded position to where they currently are is the same, $T'_{p}=-{T}'_{ret}$.
We can use the following figure to find the retarded position, and work out the distance $L'_{p}=\|\mathbf{c'} {T}'_{p}\|$ it has traveled from the retarded position in terms of the positions coordinates and the objects velocity.
This is done by first finding the propagation time in terms of the observers coordinates and the objects velocity, which can be derived from the following figure:

%█████████████
\begin{figure}[H]
	\centering
	\tikzsetnextfilename{Tikz_Light_Pulse_Primed_Frame}
	\begin{tikzpicture}[scale = 4.9] %[,tdplot_main_coords]
		%\usetikzlibrary{arrows.meta}
		%node[anchor = north west]{\textcolor{black}{ $\mathbf{P}$}}; %$\mathbf{P}$}};
		\draw[gray!40,fill = gray!40] (0,0,0) circle (1pt);
		\draw[black, thick,->] (0,0.7,0)--(0.29,0.7,0) node[anchor = north]{${y}'$};
		\draw[black, thick,->] (0,0.7,0)--(0,1,0) node[anchor = west]{${z}'$};
		\draw[black, thick,->] (0,0.7,0)--(0,0.7,0.45) node[anchor = south east] {${x}'$};
		\draw[red, thick, dotted,->] (0,0,0)--(0.68,0.88,0) node[midway, right] {$\mathbf{c}' {T}'_{p} $};
		\draw[red,->] (0,0.7,0)--(0.68,0.9,0) node[midway,above] {\text{ $\mathbf{l'}$}};
		\draw[blue, fill = blue] (0,0.7,0) circle (1pt);
		\draw[thick,blue,dotted,->] (0,0,0)--(0,0.66,0);
		\draw[blue, fill = blue] (0,0.7,0);
		\draw[blue, thick,->>] (0,0.7,0)--(0,0.8,0) node[left]{$\mathbf{u'}$};
		\fill[red] (0.7,0.9,0) circle (0.4pt);
		\node[blue, right] at (0,0.4,0) {$\mathbf{u'} {T}'_{p}$};
	\end{tikzpicture}
	\caption{The diagram shows a source particle moving at velocity $\mathbf{u'} = (0,0,u')$ in the z-direction in this frame, with the particle currently at the origin with time ${t'} = 0$, the particle was at the \protect\hyperlink{def-retarded-position}{retarded position} $-\mathbf{u'} {T}'_{p}$ shown in grey (with ${T}'_{p}$ being the propagation time of the light), the emitted light was then propagated from the particles retarded position, along $\mathbf{c'} {T}'_{p}$ shown by red dotted line, to reach position $\mathbf{l'}$ at ${t'} = 0$.}
	\label{fig: Retarded field outward field transform}
\end{figure}
%███████████

%*** explain what is going to be derived and how it will be derived (pre-expose the line of thought):
%*** make it so that it makes sense whether the derivation is hidden or not
%█████████████████
\begin{derivation}

	The triangle that the three vectors make allow us to get the equation for the velocity of the light as

	\begin{equation}
		\mathbf{c'} T'_{p} = \mathbf{u'} T'_{p} + \mathbf{l'}
	\end{equation}

	with $\mathbf{l'}=(l_x',l_y',l_z')$, writing out the vectors and rearanging to get the velocity vector for propagated light, gives

	\begin{equation}
		\mathbf{c'} = \frac{c}{ T'_{p}}
		\begin{pmatrix}
			l_x' \\
			l_y' \\
			l_z' + u' T'_{p}
		\end{pmatrix}
	\end{equation}

	The magnitude of the lights displacement is equal to the distance the light travels in the corresponding propagation time $ c T'_{p} = \|\mathbf{c'} T'_{p}\|$. The square of this gives

	\begin{equation}
		\begin{split}
			\left( c T'_{p}\right)^2 & = \|\mathbf{c'} T'_{p}\|^2                        \\
			                        & = (l_x'^2 + l_y'^2 + l_z'^2) + u'^2 {T'_{p}}^2 + 2u' T'_{p} l_z,
			%        (c^2 - v^2) T_{p}^2 &=  (x^2 + y^2 + z^2) - 2v T_{p}z
		\end{split}
	\end{equation}
	rearranging this, we get the quadratic
	\begin{equation}
		{T'_{p}}^{2} - \left(2\gamma^2\frac{u'}{c^2} l_z'\right)T'_{p} - \frac{\gamma^2}{c^2}(l_x'^2 + l_y'^2 + l_z'^2) = 0,
	\end{equation}
	where $\gamma = (1 - u'^2/c^2)^{-1/2}$. Now taking the solution for the past time, and making use of the identity
	\begin{equation}
		\gamma^2 = 1+\gamma^2\frac{u'^2}{c^2},
	\end{equation}
	we get the result (you can skip past this if you would like, as it doesnt add to understanding)
	\begin{equation}
		\begin{split}
			T'_{p} & = \gamma^2\frac{u'}{c^2} l_z' + \sqrt{\left(-\gamma^2\frac{u'}{c^2} l_z' \right)^2+\frac{\gamma^2}{c^2}(l_x'^2 + l_y'^2+ l_z'^2)} \\
			      & = \gamma^2\frac{u'}{c^2} l_z' + \frac{\gamma}{c}\sqrt{l_x'^2+ l_y'^2+\left(1+\gamma^2\frac{u'^2}{c^2}\right) l_z'^2}        \\
			      & = \gamma^2\frac{u'}{c^2} l_z' + \frac{\gamma}{c}\sqrt{l_x'^2 + l_y'^2+\gamma^2 l_z'^2}                                      \\
			      & = \gamma^2\frac{u'}{c^2} l_z' + \frac{\gamma}{c} L
		\end{split}
	\end{equation}

	with $ L=\sqrt{l_x'^2+l_y'^2+\gamma^2 l_z'^2}$.

	This is the time it has taken to propagate the light from where the source was when it was emitted to reach the current position.

\end{derivation}
%███████████████

The propagated distance between where the light was emitted and its current position, can then be given from this derivation of $T'_{p}$ as

\begin{equation}
	\label{eq: propagation distance}
	L'_{p} = cT'_{p} = \gamma^2 \frac{u'}{c} l_z' + \gamma  L = \gamma \left( 1 + \frac{u'}{c} \frac{\gamma l_z'}{L} \right) L
\end{equation}

with $ L=\sqrt{l_x'^2+l_y'^2+\gamma^2 l_z'^2}$.

This can then be used to find out how much the density of a field of light composed of spherical pulses of light from the moving source has dispated. as so we can find the density of light at a particular point in the field.

\begin{equation}
	\label{eq: direction of light from moving source}
	\mhl{
		\mathbf{c'} =
		\frac{c}{ \gamma \left( 1 + \frac{u'}{c} \frac{\gamma l_z'}{L} \right) }
	\begin{pmatrix}
		 \frac{l_x'}{L} \\
		 \frac{l_y'}{L} \\
		\gamma \left( \frac{\gamma l_z'}{L} + \frac{u'}{c} \right)
	\end{pmatrix}
	}
\end{equation}

We can find the cosine of the angle from the z-axis from the z-component of the unit vector of the velocity of light that is equal to the z-component of this equation with its magnitude $c$ removed, giving

\begin{equation}
	\label{eq: cos alpha prime in terms of l}
	\cos{\alpha'} = \frac{ \frac{\gamma l_z'}{L} + \frac{u'}{c}}{ 1 + \frac{u'}{c} \frac{\gamma l_z'}{L}}
\end{equation}

The reason I have explained this seperate this from the next subsection, is that I want to emphasise that the gamma function $\gamma$ has a role to play in retarded positions and times before we even get to swapping frames.
It has to be this way to allow us to swap between frames smoothly, in special relativity.
A reminder here, being that we are not changing betwen frames, we are just looking at the delay in signal that light has to get to a particular point, even though we have made use of the gamma symbol to simply the equations like we do in special relativity, we are not evoking special special relativity, but we will be looking at this when swapping between frames in the next section.

We could just as easily have said that this setup system is an initial frame and used the coordinates without the symbol to represent a primed frame ($'$), but we have the choice to denote this as the primed frame, and this will help in a later chapter.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Emitted Light When Swapping Frame}\label{subsect: Emitted Light When Swapping Frame}

This section is similar to what we have just done, but the emphasis here will be on swapping between frames, and will be used in the next chapter when we have continuous pulses of light in all directions from a source and want to see how this field of light transforms and what it looks like for moving sources.

Here, we will look at light being emitted from a source at rest first and then swap to a frame where the source is now moving, using the lorentz transformation of the emitted lights current locations (from $\mathbf{r}$ to $\mathbf{r}{'}$), but remembering these lorentz transformed times $t'$ are not sychronised with the sources time of zero.
To find this we need to use primed velocity of light $\mathbf{c}{'}$ to propagate back the light from where it is at $t'$ to were it was at the origins time of zero.
To get this position $L'$ where the light is at the syncronised time of zero with the source, we can use the triangle formed in figure (\ref{fig: primed frame 1}), which gives $\mathbf{l}' = (\mathbf{c}' - \mathbf{u'}) t'_p$.
The time $t'_p$ taken for the light to propagate from the source to point $\mathbf{l}'$ in the primed frame, is the dilated propagation time ($t'_p = \gamma t_p$)

%█████████████
\begin{figure}[H]
	\begin{subfigure}{.49\textwidth}
		\tikzsetnextfilename{Tikz_Light_Pulse_Proper_Frame}
		\begin{tikzpicture}[scale = 4.9] %[,tdplot_main_coords]
			%\usetikzlibrary{arrows.meta}
			\node[blue] at (0.06,-0.06,0) {$\mathbf{s}$};
			\draw[blue, thick,->] (0,0,0)--(0.4,0,0) node[anchor = north east]{${y}$};
			\draw[blue, thick,->] (0,0,0)--(0,0.4,0) node[anchor = north west]{${z}$};
			\draw[blue, thick,->] (0,0,0)--(0,0,0.55) node[anchor = south east] {${x}$};
			%\node[red] at (0.08,0.17,0) {$\alpha $};
			%\draw[red,->] (0,0.25,0) to[bend left = 45] (0.21,0.145,0);
			\draw[thick,red, dotted,->] (0,0,0)--(0.69,0.46,0) node[midway , right] {\text{ $\mathbf{c} {T}_{p}$}};
			\fill[blue] (0,0,0) circle (1pt);
			\fill[black] (0.71,0.48,0) circle (0.4pt) node[above] {\text{$ \mathbf{r}$}};
		\end{tikzpicture}
		\caption{proper frame}
		\label{fig: proper frame 1}
	\end{subfigure}
	\begin{subfigure}{.49\textwidth}
		\tikzsetnextfilename{Tikz_Light_Pulse_Primed_Frame_2}
		\begin{tikzpicture}[scale = 4.9] %[,tdplot_main_coords]
			%\usetikzlibrary{arrows.meta}
			%node[anchor = north west]{\textcolor{black}{ $\mathbf{P}{'}$}}; %$\mathbf{P}{'}$}};
			\node[gray] at (0.1,-0.1,0) {$\mathbf{s}_{ret}^{'}$};
			\draw[gray!40,fill = gray!40] (0,0,0) circle (1pt);
			\fill[red!40] (0.68*0.883,0.9*0.85,0) circle (0.4pt);
			\draw[black, thick,->] (0,0.7,0)--(0.29,0.7,0) node[anchor = north]{{\color{blue} ${y}$},${y{'}}$};
			\draw[black, thick,->] (0,0.7,0)--(0,1,0) node[anchor = west]{{\color{blue} ${z}$},${z{'}}$};
			\draw[black, thick,->] (0,0.7,0)--(0,0.7,0.45) node[anchor = south east] {{\color{blue} ${x}$}, ${x{'}}$};
			\draw[gray, dashed,->] (0,0,0)--(0.25,0,0) node[anchor = south east]{${y}$};
			\draw[gray, dashed,->] (0,0,0)--(0,0.2,0) node[anchor = north east]{${z}$};
			\draw[gray, dashed,->] (0,0,0)--(0,0,0.35) node[anchor = south east] {${x}$};
			%\node[red] at (0.06,0.17,0) {$\alpha {'}$};
			%\draw[red,->] (0,0.25,0) to[bend left = 40] (0.15,0.2,0);
			\draw[red, thick, dotted,->] (0,0,0)--(0.69*0.85,0.88*0.85,0) node[midway, right] {$\mathbf{c}{'} {T}_{p}^{'}$};
			\draw[gray, thick, dotted] (0.69*0.85,0.88*0.85,0)--(0.69,0.88,0);
			\draw[black,->] (0,0.7,0)--(0.68,0.9,0) node[midway,above] {\text{ $\mathbf{r}{'}$}};
			\draw[red,->] (0,0.7,0)--(0.68*0.85,0.9*0.85,0);
			\node[red] at (0.4,0.68,0) {\text{ $\mathbf{l}{'}$}};
			\draw[blue, fill = blue] (0,0.7,0) circle (1pt) node[anchor = north west]{$\mathbf{s}{'}$};
			\draw[thick,blue,dotted,->] (0,0,0)--(0,0.66,0);
			\draw[blue, thick,->>] (0,0.7,0)--(0,0.8,0) node[left]{$\mathbf{u}$};
			\fill (0.7,0.9,0) circle (0.4pt);
			\node[blue, right] at (0,0.4,0) {$\mathbf{u'} {T}_{p}^{'}$};
		\end{tikzpicture}
		\caption{primed frame with moving source}
		\label{fig: primed frame 1}
	\end{subfigure}
	\caption{The diagram shows a source particle ${s}$ in blue at rest in the \protect\hyperlink{def-proper-frame}{proper frame}, Fig (a), with a light pulse that has propagated along $\mathbf{c} {T}_{p}$ shown in red, to coordinate $\mathbf{r}$ shown in black, with the current time for whole system being ${t} = 0$. Fig (b), shows the system transformed to a \protect\hyperlink{def-Primed-Frame}{primed frame} moving at velocity $\mathbf{v} = (0,0,v)$ in the z-direction relative to the \protect\hyperlink{def-proper-frame}{proper frame}, such that the particle and its attached proper axis in this frame are moving at velocity $\mathbf{u'} =-\mathbf{v}$ and is currently at the primed origin with time ${t{'}} = 0$. when the light was emitted from the particle, the particle and attached proper axis were at the \protect\hyperlink{def-retarded-position}{retarded position} $\mathbf{s}_{ret}^{'}$ shown in grey, the emitted light was then propagated, along $\mathbf{c}{'} {T}_{p}^{'}$ to reach $\mathbf{l}{'}$ at ${t{'}} = 0$. with it reaching the \protect\hyperlink{def-lorentz-transform}{Lorentz transformed} coordinate $\mathbf{r}{'}$ at desynchronised time $t'$.}
	\label{fig: appendix Retarded field outward field transform}
\end{figure}
%███████████

As visualized in above figure.
If we have a light source particle ${s}$, in its \hyperlink{def-proper-frame}{rest frame} that had emitted a pulse of light in one direction such that it propagates along $\mathbf{c} {T}_{p}$ to its current position $\mathbf{r}$ at time ${t} = 0$, where $\mathbf{c}$ is the velocity of light and ${T}_{p}$ is the time it took to propagate to $\mathbf{r}$.
Using the coordinated transform from equation \eqref{eq: Lorentz transformation} on position $\mathbf{r}$ with time ${t} = 0$ we get

\begin{equation}
	\label{eq: displacement transform}
	\begin{aligned}
		\mathbf{r}{'} & =
		\begin{pmatrix}
			x          \\
			y          \\
			{\gamma} z \\
		\end{pmatrix},                                  \\
		\text{at time \ \ \ }                           \\
		{t{'}}        & =-{\gamma} \frac{{v}{z}}{{c}^2} \\
	\end{aligned}
\end{equation}

The light pulse's velocity using the velocity transform from equation \eqref{eq: velocity transform for light} in Cartesian coordinates with the particle's speed in the \hyperlink{def-Primed-Frame}{primed frame} ${v} =-{u'}$ gives the lights velocity to be

\begin{equation}
	\label{eq: light pulse velocity transform}
	\mathbf{c}{'} = \dfrac{c}{1 + \dfrac{u'}{c} \frac{z}{R} }
	\begin{pmatrix}
		\frac{1}{\gamma} \frac{x}{R} \\
		\frac{1}{\gamma} \frac{y}{R} \\
		\dfrac{u'}{c} + \frac{z}{R}   \\
	\end{pmatrix}
	= \dfrac{c}{1 + \dfrac{u'}{c} \frac{l_z}{L} }
	\begin{pmatrix}
		\frac{1}{\gamma} \frac{l_x}{L} \\
		\frac{1}{\gamma} \frac{l_y}{L} \\
		\dfrac{u'}{c} + \frac{l_z}{L}   \\
	\end{pmatrix}
\end{equation}

$L=R$ and $(x,y,z)=(l_x,l_y,l_z)$

% can also show in spherical polar coordinates

The time that the particle emits the light in the \hyperlink{def-proper-frame}{proper frame} is ${T}_{ret} =-{T}_{p}$ which corresponds to the contracted time

\begin{equation}
	T{'}_{ret} = {\gamma} {T}_{ret} =-{\gamma} {T}_{p}
\end{equation}

So that in the \hyperlink{def-Primed-Frame}{primed frame}, the \hyperlink{def-retarded-position}{retarded position} that the source particle emits the light pulse is

\begin{equation}
	\mathbf{s}_{ret}^{'} =-{\gamma} {T}_{p} \mathbf{u'}
\end{equation}

to find the position the light pulse is currently at, at time ${t{'}} = 0$, we have to rewind its time from the position $\mathbf{r}{'}$ that it is at when using the \hyperlink{def-lorentz-transform}{Lorentz transform} at time ${t{'}} =-{\gamma}\frac{{v}{z}}{{c}^2} = {\gamma}\frac{u' z}{{c}^2}$ taking away how much it propagated from the desynchronised time to get the current times position of the light to be (${t{'}_{p}} =-{T{'}_{ret}}$).

\begin{equation}
	\begin{split}
		\mathbf{l}{'}
		 & = \mathbf{s}_{ret}^{'} + \mathbf{c}{'}t{'}_{p}
		\\
		 & \color{gray} = \left( \mathbf{c}{'}-\mathbf{u'} \right)t{'}_{p}
		\\
		 & \color{gray} = \dfrac{{c}t{'}_{p}}{{\gamma}\left(1 + \frac{z}{R} \dfrac{u'}{c} \right)}
		\begin{pmatrix}
			\frac{x}{R}                                        \\
			\frac{y}{R}                                        \\
			{\gamma} \left( \frac{z}{R} + \dfrac{u'}{c} \right) \\
		\end{pmatrix}
		-
		\begin{pmatrix}
			0            \\
			0            \\
			u' {t{'}_{p}} \\
		\end{pmatrix}
		\\
		 & \color{gray} = \dfrac{{c}t{'}_{p}}{{\gamma}\left(1 + \frac{z}{R} \dfrac{u'}{c} \right)}
		\begin{pmatrix}
			\frac{x}{R}                                                                                                                     \\
			\frac{y}{R}                                                                                                                     \\
			{\gamma} \left( \frac{z}{R} + \dfrac{u'}{c} \right)-{\gamma}\left(1 + \frac{z}{R} \dfrac{u'}{c} \right) \dfrac{u'}{c} \\
		\end{pmatrix}
		\\
		 & = \dfrac{{c}t{'}_{p}}{{\gamma}\left(1 + \frac{z}{R} \dfrac{u'}{c} \right)}
		\begin{pmatrix}
			\frac{x}{R}                    \\
			\frac{y}{R}                    \\
			\frac{1}{{\gamma}} \frac{z}{R} \\
		\end{pmatrix}
	\end{split}
\end{equation}

now using $ t{'}_{p} = {\gamma} {T}_{p}$ and ${T}_{p}= R / c$

\begin{equation}
	\label{eq: time synced transform}
	\mhl{
		\begin{aligned}
			& \mathbf{l}{'} = \dfrac{1}{\left(1 + \frac{z}{R} \dfrac{u'}{c} \right)}
			\begin{pmatrix}
				x                    \\
				y                    \\
				\frac{1}{{\gamma}} z \\
			\end{pmatrix}
			= \dfrac{1}{\left(1 + \dfrac{u'}{c} \frac{l_z}{L} \right)}
			\begin{pmatrix}
				l_x                    \\
				l_y                    \\
				\frac{1}{{\gamma}} l_z \\
			\end{pmatrix}
			\\
			& \text{at time ${t{'}}=0$ }
		\end{aligned}
	}
\end{equation}


This is the position of the light at time zero, i.e. the same time as the source which is at the origin at time zero. This equation is what we will use to transform the positions of light, when we look at light that is being continuously emitted from a source, as shown in figure (\ref{fig: full field transformation}).

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\input{Tex/Terms/Terms_ch4.tex}

%███████████████████████████████████████████████████████████████████
\printbibliography[segment=\therefsegment, heading=subbibliography]

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\chapter{A Point Source: Continually Emitting Light Radially Outwards} \label{ch: A Point Source Continually Emitting Light}

This chapter will look at a source that continuously emits evenly distributed pulses of light radially outwards, giving in its rest frame a "field" of light that spreads out the further it is from the source.
The amount this is spread out, at a distance $r$, is proportional to the inverse square of the distance $1/r^2$.
This inverse square law is used to decribe how the classical forces between two masses or charges disipate with the distance between them.
But, this relative scalar density is not the only way to get an inverse square law, and in this chapter we will look at the rest of the other properties of a field of continously emitted light and we will see that they can also give you an inverse square law.

So a source at rest that is continously emitting evenly distributed light, gives the "field" of light shown in the first diagram in figure (\ref{fig: full field transformation}), with the second diagram in the figure showing how this "field" of light would look like in a frame with the source now moving.
Equation \eqref{eq: time synced transform} was used to transform each part of the propagating light to where it is at time $t'=0$ (the time that it is sychronised with the source at the origin).
The third diagram of the figure shows the rings of each pulse in th eprimed frame.
The Doppler effect in each direction can be seen from the ammount of spreading out or compacting of the rings in that direction, with the aberrational effect being shown on each particular ring with how the light is spread out on that ring.
This combination of the relativistic Doppler and aberration effects together, is called relativistic beaming.


%█████████████
\begin{figure}[H]
	\centering
	\begin{subfigure}{.3\textwidth}
		\centering
		\includegraphics[width = 3.6cm]{images/pdf/Field_Rest_Frame.pdf}
		\caption{Source's Rest Frame}
	\end{subfigure}
	\begin{subfigure}{.3\textwidth}
		\centering
		\includegraphics[width = 3.6cm]{images/pdf/Field_Moving_Frame_Doppler.pdf}
		\caption{Primed Frame}
	\end{subfigure}
	\begin{subfigure}{.3\textwidth}
		\centering
		\includegraphics[width = 3.6cm]{images/pdf/Field_Moving_Frame_Doppler_circles.pdf}
		\caption{Primed Frame again}
	\end{subfigure}
	\caption{\textbf{Source's field of Emmited Light.} A diagram showing, in the y-z plane, multiple spherically symmetrical pulses of light from a source at rest (left), and in a corresponding primed inertial frame where the source is moving (middle) with a time of $t'=0$ everywhere, the colors show the \protect\hyperlink{def-doppler-effect}{Doppler effect} on the light and the grey dots show the past positions of the source when it had emitted each pulse, there is also a diagram showing the circles of each of the spherical pulses (right), it shows the spherical waves being closer together in the direction of movement.}
	\label{fig: full field transformation}
\end{figure}
%███████████

Now that we have the means to transform this "field" of light, we can look at some of its physical/mathematical features/properties, looking at each feature in its rest frame and then finding out how it extends to a frame in which it is moving.
But first we will look at how to describe an infintesmal element on the surface of each spherical pulse at each point.
With this we will see how the density of the light on each pulse's surface changes when changing to a sources primed frame, along with the Doppler effects on the density of light in the radial direction.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Surface Element on a Sphere and the Solid Angle} \label{subsect: Surface Element on a Sphere}

...
This section will be about the differential elements of spherical polar coordinates, which will be used to get what is called a surface element, and in turn find out what the solid angle is and how to derive it.
*** start and check this next sentence
This will then lead into finding the density of light through this solid angle element.
Which will be needed when looking at the aberration section.
I realize a lot of these terms may be new to you, but they will be explained as we go.
...

If we define a sphere with radius $r$ we can find an infinitesimal portion of the surface of the sphere at angles ${\theta}$ and ${\phi}$ as shown on this figure:

%█████████████
\begin{figure}[H]
	\centering
	\tikzsetnextfilename{Tikz_Surface_Element}
	%Axis Angles
	\tdplotsetmaincoords{70}{110}
	%
	%Macros
	\pgfmathsetmacro{\rvec}{4}
	\pgfmathsetmacro{\thetavec}{40}
	\pgfmathsetmacro{\phivec}{45}
	\pgfmathsetmacro{\dphivec}{20}
	\pgfmathsetmacro{\dthetavec}{20}
	\pgfmathsetmacro{\drvec}{0}%1.5}
	%
	%Layers
	\pgfdeclarelayer{background}
	\pgfdeclarelayer{foreground}
	%
	\pgfsetlayers{background, main, foreground}
	\scalebox{1}{%0.6}{
		\begin{tikzpicture}[tdplot_main_coords]
			\shadedraw[tdplot_screen_coords,ball color = gray, opacity = 0.3] (0,0) circle (\rvec);
			\draw[fill = gray,opacity = 0.3] (0,0) circle (\rvec);
			%
			%Coordinates
			\coordinate (O) at (0,0,0);
			\tdplotsetcoord{A}{\rvec}{\thetavec}{\phivec}
			\tdplotsetcoord{B}{\rvec}{\thetavec + \dthetavec}{\phivec}
			\tdplotsetcoord{C}{\rvec}{\thetavec + \dthetavec}{\phivec + \dphivec}
			\tdplotsetcoord{D}{\rvec}{\thetavec}{\phivec + \dphivec}
			\tdplotsetcoord{E}{\rvec + \drvec}{\thetavec}{\phivec}
			\tdplotsetcoord{F}{\rvec + \drvec}{\thetavec + \dthetavec}{\phivec}
			\tdplotsetcoord{F'}{\rvec + \drvec}{90}{\phivec}
			\tdplotsetcoord{G}{\rvec + \drvec}{\thetavec + \dthetavec}{\phivec + \dphivec}
			\tdplotsetcoord{G'}{\rvec + \drvec}{90}{\phivec + \dphivec}
			\tdplotsetcoord{H}{\rvec + \drvec}{\thetavec}{\phivec + \dphivec}
			%
			%Axis
			\begin{pgfonlayer}{background}
				\draw[thick,-latex] (0,0,0)--(1.2*\rvec,0,0) node[pos = 1.1]{${x}$};
				\draw[thick,-latex] (0,0,0)--(0,1.2*\rvec,0) node[anchor = south east]{${y}$};
				\draw[thick,-latex] (0,0,0)--(0,0,1.2*\rvec) node[pos = 1.05]{${z}$};
			\end{pgfonlayer}
			%
			%Help Lines
			\begin{pgfonlayer}{foreground}
				%Up
				\draw[ultra thick, red,->] (O)--(A) node[pos = 0.6, left] {${\mathbf{r}}$};
				\draw (O)--(B);
				\draw (O)--(C);
				\draw[dashed] (O)--(D);
				%Down
				\draw (O)--(F');
				\draw (O)--(G');
			\end{pgfonlayer}
			%%Help Curves
			\begin{pgfonlayer}{foreground}
				\tdplotsetthetaplanecoords{\phivec}
				\tdplotdrawarc[tdplot_rotated_coords]{(O)}{\rvec}{\thetavec + \dthetavec}{90}{}{}
				%
				\tdplotdrawarc[tdplot_rotated_coords]{(O)}{\rvec + \drvec}{\thetavec + \dthetavec}{90}{}{}
				%
				\tdplotsetthetaplanecoords{\phivec + \dphivec}
				\tdplotdrawarc[tdplot_rotated_coords, dashed]{(O)}{\rvec}{\thetavec + \dthetavec}{90}{}{}
				\tdplotdrawarc[tdplot_rotated_coords]{(O)}{\rvec + \drvec}{\thetavec + \dthetavec}{90}{}{}
				%
				\tdplotdrawarc[tdplot_main_coords]{(O)}{\rvec}{\phivec}{\phivec + \dphivec}{}{}
				%
				\tdplotdrawarc[tdplot_main_coords]{(O)}{\rvec + \drvec}{\phivec}{\phivec + \dphivec}{below, rotate = 13}{$r\mathrm{d}\phi$}
			\end{pgfonlayer}
			%
			%Angles
			\begin{pgfonlayer}{foreground}
				%Phi
				\tdplotdrawarc[-stealth]{(O)}{1.5}{0}{\phivec}{}{}{}
				\node at (0.8,0.3,0) {$\phi$};
				\tdplotdrawarc[-stealth]{(O)}{1.5}{\phivec}{\phivec + \dphivec}{}{}
				\node at (1.4,1.9,0) {$\mathrm{d}\phi$};
				\tdplotsetthetaplanecoords{\phivec}
				%Theta
				\tdplotdrawarc[tdplot_rotated_coords,-stealth]{(0,0,0)}{1.5}{0}{\thetavec}{}{}
				\node at (0,0.15,0.8) {$\theta$};
				\tdplotdrawarc[tdplot_rotated_coords,-stealth]{(0,0,0)}{1.5}{\thetavec}{\thetavec + \dthetavec}{anchor = south west}{$\mathrm{d}\theta$}
			\end{pgfonlayer}
			%
			%Differential Volume
			%
			%%Lines
			\begin{pgfonlayer}{foreground}
				\draw[thick] (A)--(E);% node[midway, above left]{$\mathrm{d}r$};
				\draw[thick] (B)--(F);
				\draw[thick] (C)--(G);
			\end{pgfonlayer}
			\begin{pgfonlayer}{background}
				\draw[dashed, thick] (D)--(H);
			\end{pgfonlayer}
			%
			%%Curved
			\begin{pgfonlayer}{background}
				\tdplotsetrotatedcoords{55}{-50.4313}{-6.4086}
				\tdplotdrawarc[dashed, tdplot_rotated_coords, thick]{(O)}{\rvec}{0}{12.8173}{}{}
				%
				\tdplotsetthetaplanecoords{\phivec + \dphivec}
				\tdplotdrawarc[dashed, tdplot_rotated_coords, thick]{(O)}{\rvec}{\thetavec}{\dthetavec + \thetavec}{}{}
			\end{pgfonlayer}
			\begin{pgfonlayer}{foreground}
				\tdplotsetthetaplanecoords{\phivec}
				\tdplotdrawarc[tdplot_rotated_coords, thick]{(O)}{\rvec}{\thetavec}{\dthetavec + \thetavec}{}{}
				\tdplotdrawarc[tdplot_rotated_coords, thick]{(O)}{\rvec + \drvec}{\thetavec}{\dthetavec + \thetavec}{}{}
				%
				\tdplotsetthetaplanecoords{\phivec + \dphivec}
				\tdplotdrawarc[tdplot_rotated_coords, thick]{(O)}{\rvec + \drvec}{\thetavec}{\dthetavec + \thetavec}{above right}{$r\mathrm{d}\theta$}
				%
				\tdplotsetrotatedcoords{55}{-50.4313}{-6.4086}
				\tdplotdrawarc[tdplot_rotated_coords, thick]{(O)}{\rvec + \drvec}{0}{12.8173}{}{}
				%
				\tdplotsetrotatedcoords{55}{-30.3813}{-8.6492} %
				\tdplotdrawarc[tdplot_rotated_coords, thick]{(O)}{\rvec}{0}{17.2983}{}{}
				\tdplotdrawarc[tdplot_rotated_coords, thick]{(O)}{\rvec + \drvec}{0}{17.2983}{}{}
				\node[anchor=center, rotate=14, below] at (1.5,2.78,1.8) {$r\mathrm{d}\phi \sin\theta$};
			\end{pgfonlayer}
			%
			%Fill Color
			\begin{pgfonlayer}{main}
				%Front
				\fill[black, opacity = 0.15] (E) to (A) to[bend left = 4] (B) to (F) to[bend right = 4] cycle;
				\fill[black, opacity = 0.6] (E) to[bend left = 4] (F) to[bend left = 2] (G) to[bend right = 6.5] (H) to[bend right = 4] cycle;
				\fill[black, opacity = 0.4] (F) to[bend left = 2] (G) to[bend left = 1.5] (C) to[bend right = 2.5] (B) to[bend right = 4] cycle;
			\end{pgfonlayer}
			\begin{pgfonlayer}{background}
				%Back
				\fill[black!50, opacity = 0.5] (A) to[bend left = 2] (D) to[bend left = 6] (C) to[bend right = 2.5] (B) to[bend right = 4] cycle;
				\fill[black!50, opacity = 0.5] (A) to[bend left = 2] (D) to (H) to[bend right = 2.5] (E) to[bend right = 4] cycle;
				\fill[black!50, opacity = 0.5] (D) to (H) to[bend left = 6] (G) to[bend right = 2] (C) to[bend right = 6] cycle;
			\end{pgfonlayer}
		\end{tikzpicture}
	}
	\caption{\textbf{Differential surface element on a sphere} This shows a surface element on a sphere of radius $r$ that spans from $\theta$ to $\theta + d\theta$ and $\phi$ to $\phi + d\phi$ in spherical polar coordinates, the surface element is equivalent to a rectangle with sides $r d\theta$ and ${r}\sin\theta {d\phi}$, giving the infinitesimal surface area of $r^2 \sin\theta \,\mathrm{d}\theta \,\mathrm{d}\phi$.}
\end{figure}
%███████████

The surface element at a constant radius ${r}$, spanning from $\theta$ to $\theta + d\theta$ and $\phi$ to $\phi + d\phi$ on a spherical surface is equivalent to a rectangle with sides ${r}{dr}$ and ${r}\sin\theta {d\phi}$ giving the surface area as

\begin{equation}
	\mathrm{d}S =  r^2 \sin\theta \,\mathrm{d}\theta \,\mathrm{d}\phi
	%\left\|\frac{\partial {\mathbf R}}{\partial \theta} \times \frac{\partial {\mathbf R}}{\partial \phi}\right\| \mathrm{d}\theta \,\mathrm{d}\phi = \left\| r \mathbf{\mathbf{\hat{\text{$\theta$}}}} \times r \sin \theta \mathbf{\mathbf{\hat{\text{$\phi$}}}} \right\|
\end{equation}

This surface elements size depends on the angle from the z-axis and the distance from the origin, but if we want a quantity that only depends on the angle, we can divide the surface element by $r^2$, this gives what is called the solid angle.
The solid angle element $d\Omega$ is a measure of the amount of the field of view, from the origin, that the surface element covers. For the differential surface element shown in the figure we have the differential solid angle

\begin{equation} \label{eq: solid angle}
	\mathrm{d}\Omega = \frac{\mathrm{d}S}{r^2} = \sin\theta \,\mathrm{d}\theta \,\mathrm{d}\phi
\end{equation}

If we were to integrate this over the whole sphere $ \int_{0}^{2\pi} \int_{0}^{\pi} \, \sin \phi \, d\theta \, d\phi$, we would get $4\pi$, which is when the view from the origin is fully covered by the surface.
The fraction of the view from the origin that is covered by a solid angle $\Omega$ is therefore given by $\Omega/ 4\pi$.


% %███████████████████████████████████████████████████████████████████
% %███████████████████████████████████████████████████████████████████
% \section{Intensity of Light per surface area}\label{sect: Intensity of Light per surface area}

% If in a sources rest frame we have surface element $\mathrm{d}s = l_{p}^2 \sin\theta \,\mathrm{d}\theta \,\mathrm{d}\phi$ with an amount of light $a$ on this surface, then when we switch to another frame there is still the same amount of this light on this surface in the primed frame which is now given by $\mathrm{d}s' = l_{p}'^2 \sin\theta' \,\mathrm{d}\theta' \,\mathrm{d}\phi'$ *** hmm is it $l_p'$

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Density of Light in a Infintesmal Solid Angle from a Point Source}\label{sect: Intensity of Light per differential solid angle from a Point Source}

% *** flowrate,  radial/angular concentration/density
%we can also look at what is called flux, which is defined as ...
%Flux is a messure of how much of a quantity is passing through a given surface in a given time, in our case it is how much light is passing through each infintesmal surface that is perpedicular to the direction the light is propagating at that point per infintesmal unit of time.
%- Add more meaning to \hyperlink{def-flux}{flux} section
%-\hyperlink{def-flux}{flux} describes the rate at which a quantity flows across a surface (flowrate per unit area)
%%███████████████████████████████████████████████████████████████████
%\subsection{Flux of light Through Surface Element}\label{subsect: Flux Through Surface Element}
%... radial \hyperlink{def-flux}{flux} through surface element (search radial \hyperlink{def-flux}{flux})

If we have a source at rest emitting light out in all directions we can say at certain angles given as the spherical polar coordinates $\theta = \alpha$ and $\phi= \varphi$ we have have a quantity of light emitted in the solid angle

\begin{equation}
	d\Omega = \sin{\alpha} d\alpha d\varphi,
\end{equation}

this solid angle encompasses a certain amount of the wavefront $Q$, this is the same amount of the wavefront that is encompassed by the coinciding aberrated differential solid angle in the primed frame

\begin{equation}
	d\Omega{'} = \sin{\alpha'} d\alpha{'} d\varphi{'}.
\end{equation}

We can calculate this element by differentiating both sides of eq.
\eqref{eq: Cosine transform} with respect to $\alpha$ \cite{hogg1997special}, which after working out gives

\begin{equation}
	\sin{\alpha'} d\alpha{'} = \dfrac{1}{{\gamma}^2\left(1 + \dfrac{u'}{c}\cos{\alpha}\right)^2} \sin{\alpha} d\alpha
\end{equation}

now using this and ${d\varphi{'}} = {d\varphi}$ (as the angle ${\varphi}$ is always perpendicular to the motion of the particle and hence unaffected by \hyperlink{def-transform}{transformation}) we have the solid angle in the \hyperlink{def-Primed-Frame}{primed frame} given as

\begin{equation}
		d\Omega{'} = \dfrac{1}{{\gamma}^2\left(1 + \dfrac{u'}{c}\cos{\alpha}\right)^2} \sin{\alpha} d\alpha d\varphi.
\end{equation}

%The overall amount of wavefront is conserved, as can be seen when integrating over the corresponding solid angle in either frame, both of which give the same value of $4\pi$.
% proportional to the amount of the wavefront in the given proper differential element of the solid angle, and

If there is the same amount of light/quantity of light $Q$ in the solid angle element in both frames, then the density of light in the solid angle in each frames is $Q/d\Omega$ and $Q/d\Omega{'}$ respectively, giving the ratio of the density in the solid angle element in the primed frame relative to the rest frame as

\begin{equation}
	D_\Omega = \frac{d\Omega}{d\Omega'} = {\gamma}^2\left(1 + \dfrac{u'}{c}\cos{\alpha}\right)^2.
\end{equation}

by subsittuting equation \eqref{eq: cos alpha prime in terms of l} into equation \eqref{eq: Cosine transform inverse} we get $\cos\alpha=\frac{\gamma l_z'}{L}$, and this now gives

\begin{equation}
	D_\Omega = {\gamma}^2\left(1 + \dfrac{u'}{c}\frac{\gamma l_z'}{L}\right)^2.
\end{equation}

We can also write the equation in terms of the direction of the light from the z-axis in the primed frame, by substituting in equation \eqref{eq: Cosine transform inverse}, which gives

\begin{equation}
	\label{eq: aberrational wavefront weighting}
	D_\Omega = \frac{1}{{\gamma}^2\left(1 - \dfrac{u'}{c}\cos{\alpha'}\right)^2}.
\end{equation}

all three ways of writing this relative density look very similar, which can be confusing and easily mixed up, so be careful if using these.

% substituting in $\cos{\alpha'}$ from equation \eqref{eq: cos alpha prime}, we have

% \begin{equation}
% 	\label{eq: aberration density weighting}
% 	D_\Omega =  \frac{1}{{\gamma}^2\left(1 - \dfrac{u'}{c}\frac{\gamma \frac{z'}{ R} + \frac{u'}{c}}{ \frac{u'}{c} \gamma \frac{z'}{ R} + 1}\right)^2} = \gamma^2 \left( 1 +\frac{u'}{c} \gamma \frac{z'}{ R} \right)^2
% \end{equation}

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Scalar Density of Light}\label{sect: Field Scalar Density}

In the previous chapter of a single spherical pulse in the rest frame, the outward going pulse creates the shape of a surface of a sphere, growing bigger as it propagates outwards, with the surface area of the sphere equal to $4 \pi r^2$.
Since there is the same amount of light in this increasing pulse's sphere and the area of this sphere's surface increases relative to the square of its radius.
We have the surface area density on this sphere being proportional to the inverse square of the radius $1/r^2$. This we will call the angular density.

For the case of light being continuously emitted, the light is spherically symmetric and is emitted from the stationary source at a constant rate, and therefore has no change in density in the direction that is radially outwards, and only a difference in the direction perpendicular to this, i.e. the angular direction, which is parallel to the spherical surface each pulse creates, giving the total scalar density of light at any point $D$ as being proportional to the inverse square of the radius $1/r^2$,

\begin{equation}
	D = \frac{k}{r^2}
\end{equation}

where k is the proportionality constant

%█████████████
\subsubsection{General Equations for Moving Source}\label{subsubsect: General Equations for Moving Source 0}

Now, what if the source is moving, we will need to look at how this density is affected.
We have the Doppler effect from equation \eqref{eq: Doppler Effect}, which gives the change in light's density relative to the rest frame, in the direction of the light's propagation, as

\begin{equation}
	\label{eq: radial density}
	D_{r} = \frac{d\lambda}{d\lambda{'}} = \frac{1}{ {\gamma} \left(1-\dfrac{u{'}}{c} \cos\alpha{'} \right)} = {\gamma}\left(1 + \dfrac{u'}{c}\frac{\gamma l_z'}{L}\right)
\end{equation}

together with density in the angular direction from equation ... and the fact it has propagated a distance $L_p'$ from where it was emitted shown in equation \eqref{eq: propagation distance} to dissipate by a magnitude of

\begin{equation}
	\frac{1}{L_p'^2} = \frac{1}{\gamma^2 \left( 1 + \frac{u'}{c} \frac{\gamma l_z'}{L} \right)^2 L^2}
\end{equation}

giving the density to be

\begin{equation}
	\begin{aligned}
		D &= \frac{D_\Omega D_r}{L_p'^2} =  {\gamma}^2\left(1 + \dfrac{u'}{c}\frac{\gamma l_z'}{L}\right)^2 \cdot {\gamma}\left(1 + \dfrac{u'}{c}\frac{\gamma l_z'}{L}\right) \cdot \frac{1}{\gamma^2 \left( 1 + \frac{u'}{c} \frac{\gamma l_z'}{L} \right)^2 L^2} \\
		&= \frac{{\gamma}\left(1 + \dfrac{u'}{c}\frac{\gamma l_z'}{L}\right)}{L^2}
	\end{aligned}
\end{equation}

The density of light for a moving source at any point can be seen in the following diagram


%█████████████
\begin{figure}[H]
	\centering
	\begin{subfigure}{0.45\textwidth}
		\centering
		\includegraphics[width=\textwidth]{images/pdf/Density_of_Light_from_Rest_Source.pdf}
		\caption{Rest Frame}
		\label{subfig_1: Density of light emitted from a source}
	\end{subfigure}
	\begin{subfigure}{0.45\textwidth}
		\centering
		\includegraphics[width=\textwidth]{images/pdf/Density_of_Light_from_Moving_Source.pdf}
		\caption{Primed Frame}
		\label{subfig_2: Density of light emitted from a source}
	\end{subfigure}
	\caption{\textbf{Density of light emitted from a source}. This Figure shows the volume density of the emitted light from a source at any position, the density at the centre of each figure goes to infinity as we get closer to the source, so for us to be able to color the graph nicely we needed to remove the center, hence the black cirlce in the center.}
	\label{fig: Density of light emitted from a source}
\end{figure}
%███████████

%███████████████████████████████████████████████████████████████████
\section{Density of Light deconstructed into Vector}\label{sect: Field Vector Density}

This quantity/property that we are about to derive is not used in physics, this is instead just having some fun trying something different to see if there was anything interesting to get out of it.

We can deconstruct the scalar density into 3 parts one radially outwards in direction ($\hat{r}$) and two perpendicular to this in the angular directions ($\hat{\theta}$ and $\hat{\phi}$)

% instead of
% \begin{equation}
% 	\nabla = \frac{\partial}{\partial r} \mathbf{e}_r + \frac{1}{r} \frac{\partial}{\partial\theta} \mathbf{e}_\theta + \frac{1}{r \sin{\theta}} \frac{\partial}{\partial\phi} \mathbf{e}_\phi
% \end{equation}

\begin{equation}
	\mathbf{D} = k_r \hat{r} + \frac{k_\theta}{r} \hat{\theta} + \frac{k_\phi}{r} \hat{\phi}
\end{equation}

this density is in the Cartesian coordinate system

check for $\| \nabla  \mathbf{D} \|$ and $\| ( \nabla  \| \mathbf{D} \| ) \|$

%███████████████████████████████████████████████████████████████████
\subsection{Norm of the Density Gradient}\label{subsect: Norm of the Density Gradient}

We can find the magnitude of the density gradient using the Del operator

\begin{equation}
	\nabla = (\frac{\partial}{\partial x},\frac{\partial}{\partial y},\frac{\partial}{\partial z})
\end{equation}

giving

\begin{equation}
	\| \nabla \mathbf{D} \| = \frac{\sqrt{k_\theta^2 + k_\phi^2 }}{r^2} = \frac{k_{a}}{r^2}
\end{equation}

with $k_{a}=\sqrt{k_\theta^2 + k_\phi^2}$

This is the same equation as we had for the previous light density for a source at rest.

%█████████████
\subsubsection{General Equations for Moving Source}\label{subsubsect: General Equations for Moving Source 2}

in direction of propagation the density is proportional to the Doppler effect $ 1/ ( \gamma( 1 - u'/c \cos{\alpha'}) )$ from eq 5.4 and in each of the perpendicular directions the density is the square root of *** eq 5.12 *** which is  $ 1/ L$

giving, using equation \eqref{eq: radial density}

\begin{equation}
	\frac{D_\Omega}{L_p'^2} =  {\gamma}^2\left(1 + \dfrac{u'}{c}\frac{\gamma l_z'}{L}\right)^2 \cdot \frac{1}{\gamma^2 \left( 1 + \frac{u'}{c} \frac{\gamma l_z'}{L} \right)^2 L^2} = \frac{1}{L^2}
\end{equation}

\begin{equation}
	\mathbf{D} = \left( D_r k_r , \sqrt{\frac{D_\Omega}{L_p'^2}} k_\theta, \sqrt{\frac{D_\Omega}{L_p'^2}}k_\phi \right) = \left({\gamma}\left(1 + \dfrac{u'}{c}\frac{\gamma l_z'}{L}\right) k_r , \frac{k_\theta}{L}, \frac{k_\phi}{L} \right)
\end{equation}

Now subsittuting in $L$ and $\beta = - u'/c$ we can find the gradient of the density vector as

%█████████████████
\begin{derivation}

%%% checked with
% https://www.wolframalpha.com/input?i=gradient+of+%28+g+%281+-b+%28g+z%29%2F%28+sqrt%28x%5E2%2By%5E2%2B+g%5E2+z%5E2%29%29+%29+M%2C+J+%2F++sqrt%28x%5E2%2By%5E2%2B+g%5E2+z%5E2%29%2C+K+%2F++sqrt%28x%5E2%2By%5E2%2B+g%5E2+z%5E2%29+%29+

\begin{equation}
	\nabla \mathbf{D} = \frac{1}{L^3}
	\begin{pmatrix}
		k_r \gamma^2 \beta l_x'l_z' & k_r \gamma^2 \beta l_y'l_z' & - k_r \gamma^2 \beta (l_x'^2 +l_y'^2)  \\
		-k_\theta l_x' & -k_\theta l_y' & -k_\theta\gamma^2 l_z' \\
		-k_\phi l_x' & -k_\phi l_y' & -k_\phi\gamma^2 l_z'
	\end{pmatrix}
\end{equation}

%checked
\begin{equation}
	\| \nabla \mathbf{D} \| = \frac{1}{L^3} \sqrt{ k_{a}^2 L^2 + k_r^2 \gamma^4 \beta^2  (l_x'^2+l_y'^2)( l_x'^2 + l_y'^2 + l_z'^2 )}
\end{equation}

\end{derivation}
%███████████████

\begin{equation}
	\| \nabla \mathbf{D} \| = \frac{1}{L^2} \sqrt{ k_{a}^2 + k_r^2 \gamma^4 \beta^2 (l_x'^2+l_y'^2) \frac{\|\mathbf{l'}\|^2}{L^2} }
\end{equation}

if $k_r\approx 0$ then

\begin{equation}
	\| \nabla \mathbf{D} \| = \frac{k_{a}}{L^2}
\end{equation}

%█████████████
\begin{figure}[H]
	\centering
	\begin{subfigure}{0.45\textwidth}
		\centering
		\includegraphics[width=\textwidth]{images/pdf/Density_of_Light_from_Rest_Source.pdf}
		\caption{Rest Frame}
		\label{subfig_1: light emitted from a source's rate of change of vector density}
	\end{subfigure}
	\begin{subfigure}{0.45\textwidth}
		\centering
		\includegraphics[width=\textwidth]{images/pdf/Rate_of_Change_of_Vector_Density_of_Light_from_Moving_Source.pdf}
		\caption{Primed Frame}
		\label{subfig_2: light emitted from a source's rate of change of vector density}
	\end{subfigure}
	\caption{\textbf{Rate of change of vector density of light emitted from a source}. This Figure shows the rate of change of the vector density of the emitted light from a source at any position, the rate of change of the vector density at the centre of each figure goes to infinity as we get closer to the source, so for us to be able to color the graph nicely we needed to remove the center, hence the black cirlce in the center.}
	\label{fig: light emitted from a source's rate of change of vector density}
\end{figure}
%███████████




%███████████████████████████████████████████████████████████████████
\subsection{Norm of the Gradient of the Density Vector Magnitude}\label{subsect: Norm of the Gradient of the Density Vector Magnitude}

Now lets try this but in a different order, and taking the norm of the vector density first.

\begin{equation}
	\| \mathbf{D} \| = \sqrt{k_r^2 + \frac{k_{a}^2}{r^2} }
\end{equation}

\begin{equation}
	\Big\| \nabla \| \mathbf{D} \| \Big\| = \frac{k_{a}^2}{r^2\sqrt{r^2 k_r^2 + k_{a}^2}}
\end{equation}

This is obviously not the same as previous due to the extra $r^2 k_r$ term in the denominator, but if this is insignificant ($k_r\approx 0$ ) then we do get back the previous sections equation for the rest source:

\begin{equation}
	\Big\| \nabla \| \mathbf{D} \| \Big\| \approx  \frac{k_{a}}{r^2}
\end{equation}

checking in cartesian Coordinates:
\begin{equation}
	\mathbf{\hat{\text{${r}$}}} =
	\begin{pmatrix}
		\sin\theta \, \cos\phi \\
		\sin\theta \, \sin\phi \\
		\cos\theta            \\
	\end{pmatrix},
	\mathbf{\hat{\text{$\theta$}}} =
	\begin{pmatrix}
		\cos\theta \, \cos\phi \\
		\cos\theta \, \sin\phi \\
		-\sin\theta            \\
	\end{pmatrix},
	\mathbf{\hat{\text{$\phi$}}} =
	\begin{pmatrix}
		-\, \sin\phi             \\
		\hphantom{-} \, \cos\phi \\
		0                        \\
	\end{pmatrix}
\end{equation}
\begin{equation}
	\mathbf{\hat{\text{${D}$}}} = \frac{1}{r\rho}
	\begin{pmatrix}
		ax\rho +bxz - byr  \\
		ay\rho + byz + bxr \\
		az - b(x^2+y^2)
	\end{pmatrix}
\end{equation}
with $r=\sqrt{x^2+y^2+z^2}$ and $\rho=\sqrt{x^2+z^2}$

\subsubsection{General Equations for Moving Source}\label{subsubsect: General Equations for Moving Source 2}

now lets look at $\big\| \nabla \|\mathbf{D}\| \big\|$

%█████████████████
\begin{derivation}

\begin{equation}
	\|\mathbf{D}\| = \sqrt{ \frac{k_a^2}{L^2} + k_r^2 \gamma^2\left( 1-\beta \gamma \frac{l_z'}{L} \right)^2 }
\end{equation}

% https://www.wolframalpha.com/input?i=Grad%5Bsqrt%28+%28a%5E2%29%2F%28x%5E2%2By%5E2%2B+g%5E2+z%5E2%29+%2B+k%5E2+g%5E2+%28+1-b+g+%28z%29+%2F+sqrt%28x%5E2%2By%5E2%2B+g%5E2+z%5E2%29+%29%5E2+%29+%5D

\begin{equation}
	\nabla \|\mathbf{D}\| = \frac{1}{L^3 \sqrt{\frac{K_a^2}{L^2} + k_r^2\gamma^2(1-\gamma\beta\frac{l_z'}{L})^2}}
	\begin{pmatrix}
		-\frac{l_x'}{L} k_a^2 + k_r^2 \gamma^3 \beta (1-\gamma\beta \frac{l_z'}{L}) l_x'l_z' \\
		-\frac{l_y'}{L} k_a^2 + k_r^2 \gamma^3 \beta (1-\gamma\beta \frac{l_z'}{L}) l_y'l_z' \\
		-\gamma^2\frac{l_z'}{L} k_a^2 - k_r^2 \gamma^3 \beta (1-\gamma\beta \frac{l_z'}{L}) (l_x'^2 + l_y'^2)
	\end{pmatrix}
\end{equation}

$H=\beta \gamma^3 k_r^2 (1-\beta\frac{\gamma l_z'}{L})$

\end{derivation}
%███████████████


% \begin{equation}
% 	\Big\| \nabla \|\mathbf{D}\| \Big\| = \frac{1}{L^2\sqrt{k_a^2+ \gamma^2(1-\beta\gamma\frac{l_z'}{L})^2 L^2k_r^2}} \sqrt{ \frac{l_x'^2+l_y'^2+\gamma^4 l_z'^2}{L^2} k_a^4 + \frac{l_x'^2 + l_y'^2}{L^2} \left( \frac{\|\mathbf{l}'\|^2}{L^2} H^2 + 2 (\gamma^2-1)k_a^2 \frac{l_z'}{L} H \right) }
% \end{equation}

If we take the norm of this we get a very long equation, but if it happens to be that $k_r \approx 0$ then we would instead have the much shorter

\begin{equation}
	\Big\| \nabla \|\mathbf{D}\| \Big\| \approx \frac{k_a}{ L^2} \sqrt{ \frac{l_x'^2+l_y'^2+\gamma^4 l_z'^2}{l_x'^2+l_y'^2+\gamma^2 l_z'^2} }
\end{equation}

%█████████████
\begin{figure}[H]
	\centering
	\begin{subfigure}{0.45\textwidth}
		\centering
		\includegraphics[width=\textwidth]{images/pdf/Density_of_Light_from_Rest_Source.pdf}
		\caption{Rest Frame}
		\label{subfig_1: light emitted from a source's rate of change of vector density norm}
	\end{subfigure}
	\begin{subfigure}{0.45\textwidth}
		\centering
		\includegraphics[width=\textwidth]{images/pdf/Rate_of_Change_of_Vector_Density_norm_of_Light_from_Moving_Source.pdf}
		\caption{Primed Frame}
		\label{subfig_2: light emitted from a source's rate of change of vector density norm}
	\end{subfigure}
	\caption{\textbf{Rate of change of vector density norm of light emitted from a source}. This Figure shows the rate of change of the vector density norm of the emitted light from a source at any position, with the assumption $K_r\approx 0$, the rate of change of the vector density norm at the centre of each figure goes to infinity as we get closer to the source, so for us to be able to color the graph nicely we needed to remove the center, hence the black cirlce in the center.}
	\label{fig: light emitted from a source's rate of change of vector density norm}
\end{figure}
%███████████

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Rate of change of propagation direction}\label{sect: Rate of change of propagation direction}

If you have a stationary light source at the origin that is emitting light constantly in all directions shown in the first diagram of figure (\ref{fig: full field transformation}), then at any point $(l_x,l_y,l_z)=(x,y,z)$ we have that the light (which has came from the origin to that point) has the velocity unit vector of

\begin{equation}
	\mathbf{\hat{c}} = \frac{1}{R}
	\begin{pmatrix}
		x \\
		y \\
		z
	\end{pmatrix}
\end{equation}

at that point

% 1 / (g^2 \frac{u'}{c}z + g \sqrt{x^2 + y^2 + g^2 z^2})

with $R=\sqrt{x^2 + y^2 + z^2}$.

The rate of change of this unit velocity vector with respect to each of these coordinates are given as

The things in this yellow box here are just the velocity vector's partial derivative with respect to each coordinate (they are just given here to help with the velocity vector gradient matrix next)

% https://www.wolframalpha.com/input?i=d%2Fdx+%5B+%28x%2Cy%2Cz%29%2Fsqrt%28x%5E2%2By%5E2%2Bz%5E2%29%5D
% https://www.wolframalpha.com/input?i=d%2Fdy+%5B+%28x%2Cy%2Cz%29%2Fsqrt%28x%5E2%2By%5E2%2Bz%5E2%29%5D

\begin{equation}
		\begin{aligned}
			\frac{\partial \mathbf{\hat{c}}}{\partial x} & =
			\frac{1}{ R^3 }
			\begin{pmatrix}
				y^2 + z^2 \\
				- x y     \\
				- x z
			\end{pmatrix}                                                  \\
			\frac{\partial \mathbf{\hat{c}}}{\partial y} & =
			\frac{1}{ R^3 }
			\begin{pmatrix}
				- x y    \\
				x^2 + z^2 \\
				- y z
			\end{pmatrix}                                                  \\
			\frac{\partial \mathbf{\hat{c}}}{\partial z} & = \frac{1}{ R^3}
			\begin{pmatrix}
				-  x z  \\
				-  y z \\
				x^2 + y^2
			\end{pmatrix}                                                  \\
			\frac{\partial \mathbf{\hat{c}}}{\partial t} & =
			\begin{pmatrix}
				0 \\
				0 \\
				0
			\end{pmatrix}
		\end{aligned}
\end{equation}

%███
%█████████████
\begin{figure}[H]
	\centering
	\begin{subfigure}{0.32\textwidth}
		\centering
		\includegraphics[width=\textwidth]{images/pdf/Rate_of_change_of_lights_velocity_field_with_respect_to_x_u_is_0.pdf}
		\caption{$\|\frac{\partial \mathbf{\hat{c}}}{\partial x}\|$}
		\label{fig: Rate of change of lights velocity field of rest source subfig_1}
	\end{subfigure}
	\begin{subfigure}{0.32\textwidth}
		\centering
		\includegraphics[width=\textwidth]{images/pdf/Rate_of_change_of_lights_velocity_field_with_respect_to_y_u_is_0.pdf}
		\caption{$\|\frac{\partial \mathbf{\hat{c}}}{\partial y}\|$}
		\label{fig: Rate of change of lights velocity field of rest source subfig_2}
	\end{subfigure}
	\begin{subfigure}{0.32\textwidth}
		\centering
		\includegraphics[width=\textwidth]{images/pdf/Rate_of_change_of_lights_velocity_field_with_respect_to_z_u_is_0.pdf}
		\caption{$\|\frac{\partial \mathbf{\hat{c}}}{\partial z}\|$}
		\label{fig: Rate of change of lights velocity field of rest source subfig_3}
	\end{subfigure}
	\caption{\textbf{The rate of change of the velocity vector field of light from a source at rest}. main caption.}
	\label{fig: Rate of change of lights velocity field of rest source}
\end{figure}
%███████████

these diagrams show magnitude of the rate of rotation of the lights propagation direction with respect to each coordinate.

the velocity vector gradient matrix of lights velocity is

\begin{equation}
	\mathbf{J} =
	\begin{pmatrix}
		\frac{\partial c_1}{\partial x} & \frac{\partial c_1}{\partial y} & \frac{\partial c_1}{\partial z} \\
		\frac{\partial c_2}{\partial x} & \frac{\partial c_2}{\partial y} & \frac{\partial c_2}{\partial z}
		\\
		\frac{\partial c_3}{\partial x} & \frac{\partial c_3}{\partial y} & \frac{\partial c_3}{\partial z}
	\end{pmatrix}
	= \frac{1}{ R^3 }
	\begin{pmatrix}
		y^2 + z^2 & -xy       & -xz       \\
		-xy       & x^2 + z^2 & -yz       \\
		-xz       & -yz       & x^2 + y^2
	\end{pmatrix}
\end{equation}

the norm of this ends up giving

\begin{equation}
	\begin{aligned}
	\|\mathbf{J}\| &= \color{gray} \frac{1}{R^3} \sqrt{2(x^4 + y^4 + z^4) + 4 (x^2y^2 + x^2z^2 + y^2z^2)} \\
	& \color{gray} = \frac{\sqrt{2}}{R^3} \sqrt{(x^2 + y^2 + z^2)^2} \\
	 &= \frac{\sqrt{2}}{ R }
\end{aligned}
\end{equation}

The square of the jacobian would then be proportional to $1/R^2$ (this may seem like a bit of a cheat to get it)

\begin{equation}
	\|\mathbf{J}\|^2 = \frac{2}{R^2}
\end{equation}

or you could take the gradient of the jacobian and then take the norm of that to also get a value proportional to $1/R^2$

\begin{equation}
	\big\| \nabla \|\mathbf{J}\| \big\| = \frac{\sqrt{2}}{R^2}
\end{equation}

None of this is meant to be taken too seriously, I am just trying to find to get an $1/R^2$ relationship using as many different meathods as I can, in the hope something will be of use down the line.
I have however exhausted the different ways that I thought were reasonable avenues to check. apart from a property called the material derivative, given as

\begin{equation}
	\rho {\frac {\mathrm {D} \mathbf {u'} }{\mathrm {D} t}}=\rho \left({\frac {\partial \mathbf {u'} }{\partial t}}+(\mathbf {u'} \cdot \nabla )\mathbf {u'} \right)
\end{equation}

which when the normal is taken you get $1/R$, but I shall not got through this here as its a bit too much.
So lets look at this for a moving source.

%█████████████
\subsubsection{General Equations for moving source:}\label{subsubsect: General Equations for Moving Source 3}

Now if we have light continously being emitted evenly in all directions from a moving point source that is currently at the origin, as shown in figure (\ref{fig: full field transformation}) with the lights velocity described at each position $\mathbf{l'}=(l_x',l_y',l_z')$ by the equation \eqref{eq: direction of light from moving source}

If we want to find the rate of change of the direction of the light's propagation $\mathbf{\hat{c}}'$, at a point $\mathbf{l'}$ with respect to each coordinate we can take the partial differentiates of the unit vector for the lights propagation from equation \eqref{eq: direction of light from moving source} (which is the same, just without the magnitude $c$).
This give the rate of change of the lights propagation with respect to each coordinate as:

% https://www.wolframalpha.com/input?i=d%2Fdx+%28+%281%29%2F%28g%29+%28x%29%2F%28%5Csqrt%28x%5E2%2By%5E2%2Bg%5E2z%5E2%29%29+%2C+%281%29%2F%28g%29+%28y%29%2F%28%5Csqrt%28x%5E2%2By%5E2%2Bg%5E2z%5E2%29%29+%2C+g+%28z%29%2F%28%5Csqrt%28x%5E2%2By%5E2%2Bg%5E2z%5E2%29%29+-+b%09%29%2F%28+1+-+b+g+%28z%29%2F%28%5Csqrt%28x%5E2%2By%5E2%2Bg%5E2+z%5E2%29%29+%29
% https://www.wolframalpha.com/input?i=d%2Fdy+%28+%281%29%2F%28g%29+%28x%29%2F%28%5Csqrt%28x%5E2%2By%5E2%2Bg%5E2z%5E2%29%29+%2C+%281%29%2F%28g%29+%28y%29%2F%28%5Csqrt%28x%5E2%2By%5E2%2Bg%5E2z%5E2%29%29+%2C+g+%28z%29%2F%28%5Csqrt%28x%5E2%2By%5E2%2Bg%5E2z%5E2%29%29+-+b%09%29%2F%28+1+-+b+g+%28z%29%2F%28%5Csqrt%28x%5E2%2By%5E2%2Bg%5E2+z%5E2%29%29+%29
% https://www.wolframalpha.com/input?i=d%2Fdz+%28+%281%29%2F%28g%29+%28x%29%2F%28%5Csqrt%28x%5E2%2By%5E2%2Bg%5E2z%5E2%29%29+%2C+%281%29%2F%28g%29+%28y%29%2F%28%5Csqrt%28x%5E2%2By%5E2%2Bg%5E2z%5E2%29%29+%2C+g+%28z%29%2F%28%5Csqrt%28x%5E2%2By%5E2%2Bg%5E2z%5E2%29%29+-+b%09%29%2F%28+1+-+b+g+%28z%29%2F%28%5Csqrt%28x%5E2%2By%5E2%2Bg%5E2+z%5E2%29%29+%29
%
\begin{equation}
		\begin{aligned}
			&\frac{\partial \mathbf{\hat{c}}'}{\partial l_x'}  =
			\frac{1}{\gamma  L ( 1 + \frac{u'}{c} \frac{\gamma l_z'}{L} )^2}
			\begin{pmatrix}
				\frac{l_y'^2}{ L^2} + \frac{\gamma l_z'}{ L} \left(\frac{\gamma l_z'}{L}+\frac{u'}{c}\right) \\
				- \frac{l_x'}{L} \frac{l_y'}{L}                             \\
				- \frac{l_x'}{L} \frac{l_z'}{L}
			\end{pmatrix}                                                               \\
			&\frac{\partial \mathbf{\hat{c}}'}{\partial l_y'}  =
			\frac{1}{\gamma  L (1+ \frac{u'}{c} \frac{\gamma l_z'}{L} )^2}
			\begin{pmatrix}
				- \frac{l_y'}{L} \frac{l_x'}{L}                             \\
				\frac{l_x'^2}{ L^2} + \frac{\gamma l_z'}{ L} \left(\frac{\gamma l_z'}{L}+\frac{u'}{c}\right) \\
				- \frac{l_y'}{L} \frac{l_z'}{L}
			\end{pmatrix}                                                               \\
			&\frac{\partial \mathbf{\hat{c}}'}{\partial l_z'}  = \frac{1}{\gamma  L
				( 1 + \frac{u'}{c} \frac{\gamma l_z'}{L} )^2}
			\begin{pmatrix}
				\gamma ( - \frac{u'}{c}  - \frac{ \gamma l_z' }{L} ) \frac{l_x'}{L} \\
				\gamma ( - \frac{u'}{c}  - \frac{\gamma l_z' }{L} ) \frac{l_y'}{L}  \\
				\frac{ l_x'^2 + l_y'^2 }{ L^2}
			\end{pmatrix}                                            \\
			&\frac{\partial \mathbf{\hat{c}}'}{\partial t'}  = \frac{-u'}{\gamma  L ( 1 + \frac{u'}{c} \frac{\gamma l_z'}{L} )^2}
			\begin{pmatrix}
				\gamma ( - \frac{u'}{c}  - \frac{ \gamma l_z' }{L} ) \frac{l_x'}{L} \\
				\gamma ( - \frac{u'}{c}  - \frac{\gamma l_z' }{L} ) \frac{l_y'}{L}  \\
				\frac{ l_x'^2 + l_y'^2 }{ L^2}
			\end{pmatrix} \\
			&\text{with $ L=\sqrt{l_x'^2 + l_y'^2 + \gamma^2 l_z'^2}$ }
		\end{aligned}
\end{equation}

%███
%█████████████
\begin{figure}[H]
	\centering
	\begin{subfigure}{0.32\textwidth}
		\centering
		\includegraphics[width=\textwidth]{images/pdf/Rate_of_change_of_lights_velocity_field_with_respect_to_x.pdf}
		\caption{$\|\frac{\partial \mathbf{\hat{c}}'}{\partial x'}\|$}
		\label{fig: Rate of change of lights velocity field subfig_1}
	\end{subfigure}
	\begin{subfigure}{0.32\textwidth}
		\centering
		\includegraphics[width=\textwidth]{images/pdf/Rate_of_change_of_lights_velocity_field_with_respect_to_y.pdf}
		\caption{$\|\frac{\partial \mathbf{\hat{c}}'}{\partial y}\|$}
		\label{fig: Rate of change of lights velocity field subfig_2}
	\end{subfigure}
	\begin{subfigure}{0.32\textwidth}
		\centering
		\includegraphics[width=\textwidth]{images/pdf/Rate_of_change_of_lights_velocity_field_with_respect_to_z.pdf}
		\caption{$\|\frac{\partial \mathbf{\hat{c}}'}{\partial z}\|$}
		\label{fig: Rate of change of lights velocity field subfig_3}
	\end{subfigure}
	\caption{\textbf{The rate of change of the velocity vector field of light from a moving source}. main caption.}
	\label{fig: Rate of change of lights velocity field}
\end{figure}
%███████████

%███
%█████████████
\begin{figure}[H]
	\centering
	\begin{subfigure}{0.45\textwidth}
		\centering
		\includegraphics[width=\textwidth]{images/pdf/Rate_of_change_of_lights_velocity_field_with_respect_to_t_u_is_0.pdf}
		\caption{$\|\frac{\partial \mathbf{\hat{c}}}{\partial t}\|$ Source at Rest}
		\label{fig: Rate of change of lights velocity field with respect to time subfig_2}
	\end{subfigure}
	\begin{subfigure}{0.45\textwidth}
		\centering
		\includegraphics[width=\textwidth]{images/pdf/Rate_of_change_of_lights_velocity_field_with_respect_to_t.pdf}
		\caption{$\|\frac{\partial \mathbf{\hat{c}}'}{\partial t}\|$ Source Moving}
		\label{fig: Rate of change of lights velocity field with respect to time subfig_3}
	\end{subfigure}
	\caption{\textbf{The rate of change of the velocity vector field of continuously emitted light from source with respect to time}. main caption.}
	\label{fig: Rate of change of lights velocity field with respect to time}
\end{figure}
%███████████

% we can check do see if we take the dot product of the lights velocity with the rate of change that we get a value of zero, as the two vectors should be perpendicular, which we do:

% \begin{equation}
% 	\mathbf{\hat{c}}' \cdot \frac{\partial \mathbf{\hat{c}}'}{\partial x'} = l_x' (1 - \frac{l_x'^2}{ L^2} + \frac{u}{c}\frac{\gamma l_z'}{L}) + l_y' (- \frac{l_x'}{L} \frac{l_y'}{L}) + (\gamma^2 l_z' + \gamma \frac{u}{c}  L)(- \frac{l_x'}{L} \frac{l_z'}{L})=0
% \end{equation}

% \begin{equation}
% 	\mathbf{\hat{c}}' \cdot \frac{\partial \mathbf{\hat{c}}'}{\partial z'} = l_x' (( - \frac{u}{c}  - \frac{ \gamma l_z' }{L} ) \frac{l_x'}{L}) + l_y' (( - \frac{u}{c}  - \frac{\gamma l_z' }{L} ) \frac{l_y'}{L}) + (\gamma^2 l_z' + \gamma \frac{u}{c}  L)(\frac{1}{\gamma}\frac{ l_x'^2 + l_y'^2 }{ L^2})=0
% \end{equation}

The Magnitude of this jacobian is messy so I will not write it out here, as it would serve no purpose.
Also unsure wether to include the time derivate into the jacobian to make it a 4 by 4 tensor like below, using the velocity $( 0 , c_x' , c_y' , c_z' )$ (with the zero representing the derivatives of time), giving

\begin{equation}
	J =
	\begin{pmatrix}
		0                                 & 0                               & 0                               & 0                               \\
		\frac{\partial c_x'}{c \partial t} & \frac{\partial c_x'}{\partial l_x'} & \frac{\partial c_x'}{\partial l_y'} & \frac{\partial c_x'}{\partial l_z'} \\
		\frac{\partial c_y'}{c \partial t} & \frac{\partial c_y'}{\partial l_x'} & \frac{\partial c_y'}{\partial l_y'} & \frac{\partial c_y'}{\partial l_z'} \\
		\frac{\partial c_z'}{c \partial t} & \frac{\partial c_z'}{\partial l_x'} & \frac{\partial c_z'}{\partial l_y'} & \frac{\partial c_z'}{\partial l_z'} \\
	\end{pmatrix}
\end{equation}

But instead of going through this, I will end the madness of this chapter here and move on to looking at quantities that do not change when swaping frames, which will lead to the famous energy-mass and energy-momentum equations.



% gradient being $( \delta_t , \delta_x , \delta_y , \delta_z )$



%for norm should above have negative time parts? or make complex?


%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\input{Tex/Terms/Terms_ch5.tex}

%███████████████████████████████████████████████████████████████████
\printbibliography[segment=\therefsegment, heading=subbibliography]

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\chapter{Invariant Quantities} \label{ch: Invariant Quantities}

Quantities that are frame-independent (quantities that do not change when we transform between inertial reference frames) are called \hyperlink{def-lorentz-invariant}{Lorentz invariant}.

In this chapter, we will see the invariant quantity related to the space-time coordinates ($x,y,z,t$) and use this to find invariant properties associated with velocities, which will lead to the more abstract conservation relation between momentum, energy and mass.
We will find a new quantity with the units of energy that has a term which approximates to the kinetic energy of a particle at low velocities and another term that suggests particles another type of energy, that was not previously in classical physics, that depends on the mass of a particle (mass-energy equivalence), this will all lead to a new conservation law of energy.
The reason we care about the concept of energy is that it has this conservation relation that we will learn about, that can be used as a tool to help us make calculations and model more complex systems.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{The Space-Time Interval} \label{sect: Space-Time Interval}

We define a quantity called the space-time interval $\Delta S$ between two \hyperlink{def-event}{event}s in a generic inertial reference frame as:

\begin{equation}
	\mhl{
	\Delta S^2 = (c\Delta t)^2-{\Delta x}^2-{\Delta y}^2-{\Delta z}^2
	}
	\label{eq: space-time interval}
\end{equation}

All inertial frames of reference agree on this interval as it is invariant between frames, $\Delta S = \Delta S{'}$, which can be shown when we sub the coordinate transforms from equation \eqref{eq: interval of Coordinates} into the primed version of this last equation

\begin{equation}
	\begin{aligned}
		\Delta S{'}^2 & = (c{\Delta t{'}})^2-\Delta x{'}^2-{\Delta y{'}}^2-{\Delta z{'}}^2                                                                                          \\
		              & \color{gray} = {c}^2{\gamma} \bigg( \Delta t-\frac{v}{{c}^2} {\Delta z} \bigg)^2-{\Delta x}^2-{\Delta y}^2-\Delta ({\gamma} ( {\Delta z}- {v} \Delta t) )^2 \\
		              & \color{gray} = (c\Delta t)^2-{\Delta x}^2-{\Delta y}^2-{\Delta z}^2                                                                                         \\
		              & = \Delta S^2.
	\end{aligned}
\end{equation}

This relationship will come in useful for our next section.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Energy-Mass and Momentum Relation} \label{sect: Energy-Mass and Momentum Relation}

From here forward we will be making some jumps in logic and assertions, leading to claims of what we will call the total energy and rest mass energy, but I will try to give as much reasoning as I can for these choices in assertions.

We can see from the previous section that if a particle $p$, is moving in an inertial reference frame, we can define the space-time interval of its coordinates in this frame as

\begin{equation}
	\Delta S_p^2 = (c\Delta {t}_p)^2-\Delta x_p^2-{\Delta y_p}^2-{\Delta z_p}^2
\end{equation}

We will not used primed notation here ($'$), as we will not be changing between reference frames, so we will define this as our intial frame.

So now, if we divide by the square of the proper time that passes for the particle in this interval ${\Delta\tau}$ (the interval in time that passes in the particles rest frame), so that now taking the limit as the change in proper time in the interval goes to zero, we get a derivative that is an abstract invariant quantity that we will call the space-time velocity, which reduces to the following:

\begin{equation}
	\begin{aligned}
		\left(\frac{dS_p}{d\tau}\right)^2 & = \left(c\frac{{{dt}_{p}}}{d\tau}\right)^2-\left(c\frac{dx_p}{d\tau}\right)^2-\left(\frac{dy_p}{d\tau}\right)^2-\left(\frac{dz_p}{d\tau}\right)^2 \\
		                                  & = {c}^2\gamma^2 \left( 1-\frac{{{u}_{px}}^2 + {{u}_{py}}^2 + {{u}_{pz}}^2}{{c}^2} \right)\\
										  & = {c}^2\gamma^2 \left( 1-\frac{u_p^2}{{c}^2} \right) \\
		                                  & = {c}^2
	\end{aligned}
\end{equation}

It can be seen that this is still an invariant quantity as the speed of light is constant in all frames.
Now by multiplying both sides of the third line by ${m}^2{c}^2$ where $m$ is the rest mass of the particle, so we get

\begin{equation}
	\label{eq: energy-momentum derivation}
	\begin{aligned}
		m^2 {c}^2 \left(\frac{dS_p}{d\tau}\right)^2 & = m^2{c}^4\gamma^2 \left( 1-\frac{u_p^2}{{c}^2} \right)  \\
		({m}{c}^2)^2                                & = \gamma^2 m^2 c^4-\gamma^2 m^2 u_p^2 {c}^2
	\end{aligned}
\end{equation}

this is an invariant quantity with the units of energy squared, this quantity does not depend on the speed of a particle, it is an intrinsic energy that a particle of mass $m$ has, we could call this the rest mass energy of a particle:

\begin{equation}
	E_0=mc^2
\end{equation}

This could be taken as a new type of energy all masses have even when at rest, so say a particle at rest was to decay into photons, we would have the photons emitted from it, be equal to this energy.
I agree this does not seem like a very proper way to get this equation, or atleast looks like that we have took a shortcut, but we will look at what the other terms represent, to see if we get anything else that may convince us a little more that this is an okay interpretation of this invariant quantity of energy.
So lets rearrange the previous equation, to get

\begin{equation}
	\label{eq: total relativistic energy}
	\left( \gamma m {c}^2 \right)^2 = ({m}{c}^2)^2 + \left( \gamma {m}{u_p}{c}\right)^2
\end{equation}

we can use what is called the Taylor expansion to write out $\gamma$ in an infinite series that converges to a value the more you go along it, this techniques shows that $\gamma$ is equivalent to writing it out as this

\begin{equation}
	\gamma \equiv 1 + \frac{1}{2}\frac{u^2}{{c}^2} + \frac{3}{8}\frac{u^4}{c^4} + ...
\end{equation}

now multiplying this term by $mc^2$ we have this energy term given as

\begin{equation}
	\begin{aligned}
		\gamma {m}{c}^2 & = {m}{c}^2  \left(1 + \frac{1}{2}\frac{u^2}{{c}^2} + \frac{3}{8}\frac{u^4}{c^4} + ...
		\right)                                                                                                     \\
		                    & = {m}{c}^2 + \frac{1}{2}{m}{u}^2 + \frac{3}{8}m\frac{u^4}{{c}^2} + ...
	\end{aligned}
\end{equation}

This equation's first quantity is an energy that does not depend on the speed of the particle.
It is the invariant energy from before, the rest mass energy.
The second quantity is the classical kinetic energy formula, the rest may be seen as higher-order kinetic energy terms, that are not seen in classical physics because they are very small for ${u}<<{c}$, so this seems like it could be a formula for the total energy of a particle (in a vaccum, that is with no potential energy).
we will denote this total energy ${E}$, with the rest energy from before denoted as $E_0$ giving equation \eqref{eq: total relativistic energy} to be written as

\begin{equation}
	E^2 = E_0^2 + (\gamma{m}{u}{c})^2
\end{equation}

Now let us look at this second quantity along with the Taylor expansion of $\gamma$ which gives

\begin{equation}
	\begin{aligned}
		\gamma {c}{m}{u} & = {c}{m}{u} \left(1 + \frac{1}{2}\frac{u^2}{{c}^2} + \frac{3}{8}\frac{u^4}{c^4} + ...
		\right)                                                                                                       \\
		                     & ={c}\left( {m}{u} + \frac{1}{2}m \frac{u^3}{{c}^2} + \frac{3}{8}m\frac{u^5}{c^4} + ...
		\right)
	\end{aligned}
\end{equation}

which at small particle velocities is approximately $({m}{u}){c}$ with ${m}{u}$ being the classical momentum, we could assert that this whole energy $E_p$ is just momentum times speed of light, but in the relativistic context, that is we can not think of this as the relativistic momentum:

\begin{equation}
	p = \gamma {m}{u}
\end{equation}

as it has the same units and is approximately the classical momentum at small particle speeds.

If we are to believe all this then we would have the final equation relating the energy and momentum of a particle as

\begin{equation}
	\mhl{
		\begin{aligned}
		E^2 & = E_0^2 + (E_p)^2 \\
		    & = (mc^2)^2 + (pc)^2
		\end{aligned}
	}
\end{equation}

The reason we believe all this to be the correct interpretation of these equations is because they agree with experiments, so despite the strange way of getting to them, they seem to be correct, or atleast extremely good approximations.

%*** Momentum in special relativity is defined slightly differently, to ensure that the law of conservation of momentum holds true in all inertial frames, as required by the first postulate of relativity (it is still approximately unchanged at low velocities).

%*** comment that ${\gamma}$ is unitless and hence does not affect the units of energy or momentum

%███████████████████████████████████████████████████████████████████
\subsection{Energy-Mass Equivalence} \label{subsect: Energy-Mass Equivalence}

Lets go back for a moment to the invariant energy quantity from before that gives the relationship between mass and the energy of a particl at rest

\begin{equation}
	E_0 = mc^2
\end{equation}

So a particle with a mass $m$ has an energy due to that mass of $mc^2$, this means if it were to decay into light, that light's energy could be measured and it should equal to this.
Experiments do confirm that this assertion is true and that the energy-mass equivalence is correct.
You can give thanks to this for the ability to get energy from decaying radioactive elements in nuclear power plants, and maybe the future posibilty that we can get energy from nuclear fusion aswell.
Best to ignore the whole nuclear bombs part though.
That does give it the best reputation.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Energy-Momentum Relation For Photons} \label{sect: Energy-Momentum Relation For Photons}

*** First associate the energy of photon $E = h \nu$ then find its equivalence in mass, then sub this in, and then say momentum for the photon is then $hf/c$

For a Photon we have the mass equal to zero and the momentum as $p_{light} = \frac{hf}{c}$ which is taken from quantum mechanics and the energy-momentum relation as

\begin{equation}
	E ={c}p_{light} = h \nu
\end{equation}

where ${h}$ is Planks constant and ${\nu}$ is the frequency of the light.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\section{Momentum of Emmitted Light from Source}\label{sect: Momentum of Emmitted Light from Source}

say we have a point or spherical source, that in its rest frame emits light in all directions evenly and at with the same frequency, since this is evenly distributed the momentum kick that each bit of the light produces cancel out, so that the source is still at rest.
But in another primed frame we have that the light is aberrated in the direction of movement meaning there is more light in this direction.
The light is also subject to the Doppler effect that meaning that it has a higher frequency and therefore momentum in the direction of movement.

The source in this frame will continue at its constant velocity as it remains at rest in first frame.
Therefor we need it to be that each part of the light imparts a momentum that is in the direction that the light imparts in the sources rest frame, without a change in the momentum kick that depends on the angle its emitted.

We will have the ball's energy decrease by the amount of energy of the emitted light, meaning it will lose the equivalent of this energy in its mass.
We also have a kinectic energy of the ball to think about in the primed frame.
*** should the kinetic energy of the source be the relativistic kenetic energy from before.
*** lets calculate the momentum of source and light, and calculate the energies as well, and make sure they are conserved.

%███████████████████████████████████████████████████████████████████
%███████████████████████████████████████████████████████████████████
\input{Tex/Terms/Terms_ch5.tex}
